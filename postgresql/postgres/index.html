
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../tricks/">
      
      
        <link rel="next" href="../../docker/docker-compose/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.19">
    
    
      
        <title>Expert - Elibrary</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#advanced-postgresql-expert-level-best-practices-optimizations-and-latest-features" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Elibrary" class="md-header__button md-logo" aria-label="Elibrary" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Elibrary
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Expert
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Elibrary" class="md-nav__button md-logo" aria-label="Elibrary" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Elibrary
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Basics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Basics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/basics/data_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/basics/lists_tuples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lists & Tuples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/basics/dictionaries_sets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dictionaries & Sets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/basics/objects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Objects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/basics/functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/basics/modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modules
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/basics/builtins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Builtins
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/basics/io/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    IO
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/basics/structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Structure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/basics/collections/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Collections
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/basics/data_structures/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Structures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/basics/datetime/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Datetime
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/basics/decorators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decorators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/basics/performance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Performance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/basics/type_annotations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Type Annotations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/interesting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interesting
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/advanced/classes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Classes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/advanced/data_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/advanced/descriptors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Descriptors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/advanced/iterators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Iterators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/advanced/type_system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Type System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/advanced/threading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Threading
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/advanced/async/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Async Programming
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/advanced/decorators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decorators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/advanced/context_managers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Context Managers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/advanced/testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/advanced/pytest_fixtures/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pytest Fixtures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/advanced/solid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SOLID Principles
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/advanced/code_design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code Design
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/advanced/objects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Objects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/advanced/best_practices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Best Practices
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Classes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Classes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/classes/classes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/classes/data_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/classes/descriptors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Descriptors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/classes/iterators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Iterators
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/context_managers/context_managers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Context Managers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Data Types
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Data Types
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/data_types/data_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/data_types/dic_set/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dict & Set
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/data_types/list_tuple/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    List & Tuple
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/data_types/object/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Object
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/decorators/decorators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decorators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_9" >
        
          
          <label class="md-nav__link" for="__nav_2_9" id="__nav_2_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Modules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_9">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/modules/builtins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Builtins
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/modules/io/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    IO
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/modules/modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_10" >
        
          
          <label class="md-nav__link" for="__nav_2_10" id="__nav_2_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Structure
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_10">
            <span class="md-nav__icon md-icon"></span>
            Structure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/structure/code_design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code Design
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/structure/dessign_patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Design Patterns
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/structure/practices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Practices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/structure/solid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SOLID
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/structure/structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Structure
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_11" >
        
          
          <label class="md-nav__link" for="__nav_2_11" id="__nav_2_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Async
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_11">
            <span class="md-nav__icon md-icon"></span>
            Async
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/async/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    asyncio
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/threading/threading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Threading
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/talks/talks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    From Talks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/testing/test/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    FastAPI
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            FastAPI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fastapi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Basics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Basics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fastapi/basics/getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fastapi/basics/crud_operations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CRUD Operations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fastapi/basics/dependencies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dependencies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fastapi/basics/best_practices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Best Practices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fastapi/basics/troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fastapi/advanced/crud_patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CRUD Patterns
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Security
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fastapi/security/jwt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    JWT
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    PostgreSQL
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            PostgreSQL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Basics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Basics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basics/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basics/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/performance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Performance
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tricks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Performance Tricks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Expert
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Expert
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Table of Contents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-installation-and-initial-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      1. Installation and Initial Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Installation and Initial Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-choosing-the-right-version" class="md-nav__link">
    <span class="md-ellipsis">
      a. Choosing the Right Version
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-installing-postgresql" class="md-nav__link">
    <span class="md-ellipsis">
      b. Installing PostgreSQL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-basic-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      c. Basic Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-restarting-postgresql" class="md-nav__link">
    <span class="md-ellipsis">
      d. Restarting PostgreSQL
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-advanced-data-types-and-extensions" class="md-nav__link">
    <span class="md-ellipsis">
      2. Advanced Data Types and Extensions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Advanced Data Types and Extensions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-jsonb" class="md-nav__link">
    <span class="md-ellipsis">
      a. JSONB
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-array-types" class="md-nav__link">
    <span class="md-ellipsis">
      b. Array Types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-hstore" class="md-nav__link">
    <span class="md-ellipsis">
      c. HStore
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-postgis" class="md-nav__link">
    <span class="md-ellipsis">
      d. PostGIS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#e-enumerated-types" class="md-nav__link">
    <span class="md-ellipsis">
      e. Enumerated Types
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-indexing-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      3. Indexing Strategies
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Indexing Strategies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-b-tree-indexes" class="md-nav__link">
    <span class="md-ellipsis">
      a. B-tree Indexes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-gin-and-gist-indexes" class="md-nav__link">
    <span class="md-ellipsis">
      b. GIN and GiST Indexes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-partial-indexes" class="md-nav__link">
    <span class="md-ellipsis">
      c. Partial Indexes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-expression-indexes" class="md-nav__link">
    <span class="md-ellipsis">
      d. Expression Indexes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#e-brin-indexes" class="md-nav__link">
    <span class="md-ellipsis">
      e. BRIN Indexes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#f-covering-indexes" class="md-nav__link">
    <span class="md-ellipsis">
      f. Covering Indexes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#g-unique-indexes" class="md-nav__link">
    <span class="md-ellipsis">
      g. Unique Indexes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-query-optimization-and-performance-tuning" class="md-nav__link">
    <span class="md-ellipsis">
      4. Query Optimization and Performance Tuning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Query Optimization and Performance Tuning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-analyzing-query-performance" class="md-nav__link">
    <span class="md-ellipsis">
      a. Analyzing Query Performance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-optimizing-joins" class="md-nav__link">
    <span class="md-ellipsis">
      b. Optimizing Joins
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-reducing-query-complexity" class="md-nav__link">
    <span class="md-ellipsis">
      c. Reducing Query Complexity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-utilizing-vacuum-and-analyze" class="md-nav__link">
    <span class="md-ellipsis">
      d. Utilizing VACUUM and ANALYZE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#e-caching-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      e. Caching Strategies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#f-parallel-query-execution" class="md-nav__link">
    <span class="md-ellipsis">
      f. Parallel Query Execution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-partitioning-and-sharding" class="md-nav__link">
    <span class="md-ellipsis">
      5. Partitioning and Sharding
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Partitioning and Sharding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-table-partitioning" class="md-nav__link">
    <span class="md-ellipsis">
      a. Table Partitioning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-declarative-partitioning" class="md-nav__link">
    <span class="md-ellipsis">
      b. Declarative Partitioning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-sharding" class="md-nav__link">
    <span class="md-ellipsis">
      c. Sharding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-benefits-and-trade-offs" class="md-nav__link">
    <span class="md-ellipsis">
      d. Benefits and Trade-offs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-replication-and-high-availability" class="md-nav__link">
    <span class="md-ellipsis">
      6. Replication and High Availability
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Replication and High Availability">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-streaming-replication" class="md-nav__link">
    <span class="md-ellipsis">
      a. Streaming Replication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-logical-replication" class="md-nav__link">
    <span class="md-ellipsis">
      b. Logical Replication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-high-availability-tools" class="md-nav__link">
    <span class="md-ellipsis">
      c. High Availability Tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-benefits-of-replication" class="md-nav__link">
    <span class="md-ellipsis">
      d. Benefits of Replication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-backup-and-disaster-recovery" class="md-nav__link">
    <span class="md-ellipsis">
      7. Backup and Disaster Recovery
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7. Backup and Disaster Recovery">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-logical-backups" class="md-nav__link">
    <span class="md-ellipsis">
      a. Logical Backups
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-physical-backups" class="md-nav__link">
    <span class="md-ellipsis">
      b. Physical Backups
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-point-in-time-recovery-pitr" class="md-nav__link">
    <span class="md-ellipsis">
      c. Point-In-Time Recovery (PITR)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-automated-backup-solutions" class="md-nav__link">
    <span class="md-ellipsis">
      d. Automated Backup Solutions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#e-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      e. Best Practices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-security-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      8. Security Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="8. Security Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-authentication-and-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      a. Authentication and Authorization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-secure-connections" class="md-nav__link">
    <span class="md-ellipsis">
      b. Secure Connections
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-data-encryption" class="md-nav__link">
    <span class="md-ellipsis">
      c. Data Encryption
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-network-security" class="md-nav__link">
    <span class="md-ellipsis">
      d. Network Security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#e-regular-audits-and-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      e. Regular Audits and Monitoring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#f-protect-against-sql-injection" class="md-nav__link">
    <span class="md-ellipsis">
      f. Protect Against SQL Injection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#g-implement-role-separation" class="md-nav__link">
    <span class="md-ellipsis">
      g. Implement Role Separation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-monitoring-and-maintenance" class="md-nav__link">
    <span class="md-ellipsis">
      9. Monitoring and Maintenance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9. Monitoring and Maintenance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-monitoring-tools" class="md-nav__link">
    <span class="md-ellipsis">
      a. Monitoring Tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-automated-maintenance-tasks" class="md-nav__link">
    <span class="md-ellipsis">
      b. Automated Maintenance Tasks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-alerting" class="md-nav__link">
    <span class="md-ellipsis">
      c. Alerting
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-latest-features-in-postgresql-16" class="md-nav__link">
    <span class="md-ellipsis">
      10. Latest Features in PostgreSQL 16
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10. Latest Features in PostgreSQL 16">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-enhanced-json-and-jsonb-support" class="md-nav__link">
    <span class="md-ellipsis">
      a. Enhanced JSON and JSONB Support
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-improved-query-parallelism" class="md-nav__link">
    <span class="md-ellipsis">
      b. Improved Query Parallelism
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-native-merge-statement" class="md-nav__link">
    <span class="md-ellipsis">
      c. Native MERGE Statement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-stored-procedures-enhancements" class="md-nav__link">
    <span class="md-ellipsis">
      d. Stored Procedures Enhancements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#e-incremental-sorting" class="md-nav__link">
    <span class="md-ellipsis">
      e. Incremental Sorting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#f-improved-logical-replication" class="md-nav__link">
    <span class="md-ellipsis">
      f. Improved Logical Replication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#g-columnar-storage-improvements" class="md-nav__link">
    <span class="md-ellipsis">
      g. Columnar Storage Improvements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#h-security-enhancements" class="md-nav__link">
    <span class="md-ellipsis">
      h. Security Enhancements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#i-monitoring-and-diagnostics" class="md-nav__link">
    <span class="md-ellipsis">
      i. Monitoring and Diagnostics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-scaling-postgresql" class="md-nav__link">
    <span class="md-ellipsis">
      11. Scaling PostgreSQL
    </span>
  </a>
  
    <nav class="md-nav" aria-label="11. Scaling PostgreSQL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-vertical-scaling" class="md-nav__link">
    <span class="md-ellipsis">
      a. Vertical Scaling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-horizontal-scaling" class="md-nav__link">
    <span class="md-ellipsis">
      b. Horizontal Scaling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="b. Horizontal Scaling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#i-replication" class="md-nav__link">
    <span class="md-ellipsis">
      i. Replication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ii-sharding" class="md-nav__link">
    <span class="md-ellipsis">
      ii. Sharding
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-connection-pooling" class="md-nav__link">
    <span class="md-ellipsis">
      c. Connection Pooling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-load-balancing" class="md-nav__link">
    <span class="md-ellipsis">
      d. Load Balancing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-advanced-data-modeling" class="md-nav__link">
    <span class="md-ellipsis">
      12. Advanced Data Modeling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="12. Advanced Data Modeling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-normalization-vs-denormalization" class="md-nav__link">
    <span class="md-ellipsis">
      a. Normalization vs. Denormalization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-recursive-relationships" class="md-nav__link">
    <span class="md-ellipsis">
      b. Recursive Relationships
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-polymorphic-associations" class="md-nav__link">
    <span class="md-ellipsis">
      c. Polymorphic Associations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-inheritance-with-extensions" class="md-nav__link">
    <span class="md-ellipsis">
      d. Inheritance with Extensions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13-custom-functions-and-stored-procedures" class="md-nav__link">
    <span class="md-ellipsis">
      13. Custom Functions and Stored Procedures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13. Custom Functions and Stored Procedures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-creating-custom-functions" class="md-nav__link">
    <span class="md-ellipsis">
      a. Creating Custom Functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-stored-procedures-with-transaction-control" class="md-nav__link">
    <span class="md-ellipsis">
      b. Stored Procedures with Transaction Control
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-language-extensions" class="md-nav__link">
    <span class="md-ellipsis">
      c. Language Extensions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#14-best-practices-summary" class="md-nav__link">
    <span class="md-ellipsis">
      14. Best Practices Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Docker
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/docker-compose/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker Compose
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Git
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Git
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/flows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Workflows
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Angular
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Angular
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../angular/rxjs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rxjs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../angular/tips/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tips
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../angular/expert/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    General
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../angular/subjects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Subjects
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Setups
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Setups
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setups/install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gitlab
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Kubernetes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Kubernetes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/backup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Backup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/deployments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deployments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/image-security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Image Security
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/lifecycle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lifecycle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/maintanence.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maintenance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Monitoring
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/namespaces/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Namespaces
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/newtwork.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Network
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/pods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/replicasets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ReplicaSets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/roles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Roles
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Services
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/sheduler.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scheduler
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Programming
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Programming
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../programming/code_review/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code Review
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../programming/algorithms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Algorithms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../programming/ai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../programming/orm_sql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ORM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/graph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Graph
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../programming/questions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Questions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../programming/interview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    System Design
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            System Design
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system_design/design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Design Patterns
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system_design/prob/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Problems
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system_design/book/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Book
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Django
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Django
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../django/django/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tips
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Odoo
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            Odoo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../odoo/owl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OWL
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ansible/ansible/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ansible
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" >
        
          
          <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Other
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15">
            <span class="md-nav__icon md-icon"></span>
            Other
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/tmux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tmux
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/nvim/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neovim
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nvim/notes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neovim Notes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16" >
        
          
          <label class="md-nav__link" for="__nav_16" id="__nav_16_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cybersec
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_16">
            <span class="md-nav__icon md-icon"></span>
            Cybersec
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cybersecurity/softwaresecurity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Software Security
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_17" >
        
          
          <label class="md-nav__link" for="__nav_17" id="__nav_17_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Rust
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_17">
            <span class="md-nav__icon md-icon"></span>
            Rust
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rust/vars/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rust/generators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rust/object/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Objects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rust/memory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Memory
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_18" >
        
          
          <label class="md-nav__link" for="__nav_18" id="__nav_18_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Daily life
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_18">
            <span class="md-nav__icon md-icon"></span>
            Daily life
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../other/nutr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nutrition
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Table of Contents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-installation-and-initial-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      1. Installation and Initial Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Installation and Initial Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-choosing-the-right-version" class="md-nav__link">
    <span class="md-ellipsis">
      a. Choosing the Right Version
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-installing-postgresql" class="md-nav__link">
    <span class="md-ellipsis">
      b. Installing PostgreSQL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-basic-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      c. Basic Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-restarting-postgresql" class="md-nav__link">
    <span class="md-ellipsis">
      d. Restarting PostgreSQL
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-advanced-data-types-and-extensions" class="md-nav__link">
    <span class="md-ellipsis">
      2. Advanced Data Types and Extensions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Advanced Data Types and Extensions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-jsonb" class="md-nav__link">
    <span class="md-ellipsis">
      a. JSONB
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-array-types" class="md-nav__link">
    <span class="md-ellipsis">
      b. Array Types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-hstore" class="md-nav__link">
    <span class="md-ellipsis">
      c. HStore
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-postgis" class="md-nav__link">
    <span class="md-ellipsis">
      d. PostGIS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#e-enumerated-types" class="md-nav__link">
    <span class="md-ellipsis">
      e. Enumerated Types
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-indexing-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      3. Indexing Strategies
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Indexing Strategies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-b-tree-indexes" class="md-nav__link">
    <span class="md-ellipsis">
      a. B-tree Indexes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-gin-and-gist-indexes" class="md-nav__link">
    <span class="md-ellipsis">
      b. GIN and GiST Indexes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-partial-indexes" class="md-nav__link">
    <span class="md-ellipsis">
      c. Partial Indexes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-expression-indexes" class="md-nav__link">
    <span class="md-ellipsis">
      d. Expression Indexes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#e-brin-indexes" class="md-nav__link">
    <span class="md-ellipsis">
      e. BRIN Indexes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#f-covering-indexes" class="md-nav__link">
    <span class="md-ellipsis">
      f. Covering Indexes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#g-unique-indexes" class="md-nav__link">
    <span class="md-ellipsis">
      g. Unique Indexes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-query-optimization-and-performance-tuning" class="md-nav__link">
    <span class="md-ellipsis">
      4. Query Optimization and Performance Tuning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Query Optimization and Performance Tuning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-analyzing-query-performance" class="md-nav__link">
    <span class="md-ellipsis">
      a. Analyzing Query Performance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-optimizing-joins" class="md-nav__link">
    <span class="md-ellipsis">
      b. Optimizing Joins
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-reducing-query-complexity" class="md-nav__link">
    <span class="md-ellipsis">
      c. Reducing Query Complexity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-utilizing-vacuum-and-analyze" class="md-nav__link">
    <span class="md-ellipsis">
      d. Utilizing VACUUM and ANALYZE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#e-caching-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      e. Caching Strategies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#f-parallel-query-execution" class="md-nav__link">
    <span class="md-ellipsis">
      f. Parallel Query Execution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-partitioning-and-sharding" class="md-nav__link">
    <span class="md-ellipsis">
      5. Partitioning and Sharding
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Partitioning and Sharding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-table-partitioning" class="md-nav__link">
    <span class="md-ellipsis">
      a. Table Partitioning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-declarative-partitioning" class="md-nav__link">
    <span class="md-ellipsis">
      b. Declarative Partitioning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-sharding" class="md-nav__link">
    <span class="md-ellipsis">
      c. Sharding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-benefits-and-trade-offs" class="md-nav__link">
    <span class="md-ellipsis">
      d. Benefits and Trade-offs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-replication-and-high-availability" class="md-nav__link">
    <span class="md-ellipsis">
      6. Replication and High Availability
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Replication and High Availability">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-streaming-replication" class="md-nav__link">
    <span class="md-ellipsis">
      a. Streaming Replication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-logical-replication" class="md-nav__link">
    <span class="md-ellipsis">
      b. Logical Replication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-high-availability-tools" class="md-nav__link">
    <span class="md-ellipsis">
      c. High Availability Tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-benefits-of-replication" class="md-nav__link">
    <span class="md-ellipsis">
      d. Benefits of Replication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-backup-and-disaster-recovery" class="md-nav__link">
    <span class="md-ellipsis">
      7. Backup and Disaster Recovery
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7. Backup and Disaster Recovery">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-logical-backups" class="md-nav__link">
    <span class="md-ellipsis">
      a. Logical Backups
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-physical-backups" class="md-nav__link">
    <span class="md-ellipsis">
      b. Physical Backups
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-point-in-time-recovery-pitr" class="md-nav__link">
    <span class="md-ellipsis">
      c. Point-In-Time Recovery (PITR)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-automated-backup-solutions" class="md-nav__link">
    <span class="md-ellipsis">
      d. Automated Backup Solutions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#e-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      e. Best Practices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-security-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      8. Security Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="8. Security Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-authentication-and-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      a. Authentication and Authorization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-secure-connections" class="md-nav__link">
    <span class="md-ellipsis">
      b. Secure Connections
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-data-encryption" class="md-nav__link">
    <span class="md-ellipsis">
      c. Data Encryption
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-network-security" class="md-nav__link">
    <span class="md-ellipsis">
      d. Network Security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#e-regular-audits-and-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      e. Regular Audits and Monitoring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#f-protect-against-sql-injection" class="md-nav__link">
    <span class="md-ellipsis">
      f. Protect Against SQL Injection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#g-implement-role-separation" class="md-nav__link">
    <span class="md-ellipsis">
      g. Implement Role Separation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-monitoring-and-maintenance" class="md-nav__link">
    <span class="md-ellipsis">
      9. Monitoring and Maintenance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9. Monitoring and Maintenance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-monitoring-tools" class="md-nav__link">
    <span class="md-ellipsis">
      a. Monitoring Tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-automated-maintenance-tasks" class="md-nav__link">
    <span class="md-ellipsis">
      b. Automated Maintenance Tasks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-alerting" class="md-nav__link">
    <span class="md-ellipsis">
      c. Alerting
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-latest-features-in-postgresql-16" class="md-nav__link">
    <span class="md-ellipsis">
      10. Latest Features in PostgreSQL 16
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10. Latest Features in PostgreSQL 16">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-enhanced-json-and-jsonb-support" class="md-nav__link">
    <span class="md-ellipsis">
      a. Enhanced JSON and JSONB Support
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-improved-query-parallelism" class="md-nav__link">
    <span class="md-ellipsis">
      b. Improved Query Parallelism
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-native-merge-statement" class="md-nav__link">
    <span class="md-ellipsis">
      c. Native MERGE Statement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-stored-procedures-enhancements" class="md-nav__link">
    <span class="md-ellipsis">
      d. Stored Procedures Enhancements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#e-incremental-sorting" class="md-nav__link">
    <span class="md-ellipsis">
      e. Incremental Sorting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#f-improved-logical-replication" class="md-nav__link">
    <span class="md-ellipsis">
      f. Improved Logical Replication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#g-columnar-storage-improvements" class="md-nav__link">
    <span class="md-ellipsis">
      g. Columnar Storage Improvements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#h-security-enhancements" class="md-nav__link">
    <span class="md-ellipsis">
      h. Security Enhancements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#i-monitoring-and-diagnostics" class="md-nav__link">
    <span class="md-ellipsis">
      i. Monitoring and Diagnostics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-scaling-postgresql" class="md-nav__link">
    <span class="md-ellipsis">
      11. Scaling PostgreSQL
    </span>
  </a>
  
    <nav class="md-nav" aria-label="11. Scaling PostgreSQL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-vertical-scaling" class="md-nav__link">
    <span class="md-ellipsis">
      a. Vertical Scaling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-horizontal-scaling" class="md-nav__link">
    <span class="md-ellipsis">
      b. Horizontal Scaling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="b. Horizontal Scaling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#i-replication" class="md-nav__link">
    <span class="md-ellipsis">
      i. Replication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ii-sharding" class="md-nav__link">
    <span class="md-ellipsis">
      ii. Sharding
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-connection-pooling" class="md-nav__link">
    <span class="md-ellipsis">
      c. Connection Pooling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-load-balancing" class="md-nav__link">
    <span class="md-ellipsis">
      d. Load Balancing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-advanced-data-modeling" class="md-nav__link">
    <span class="md-ellipsis">
      12. Advanced Data Modeling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="12. Advanced Data Modeling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-normalization-vs-denormalization" class="md-nav__link">
    <span class="md-ellipsis">
      a. Normalization vs. Denormalization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-recursive-relationships" class="md-nav__link">
    <span class="md-ellipsis">
      b. Recursive Relationships
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-polymorphic-associations" class="md-nav__link">
    <span class="md-ellipsis">
      c. Polymorphic Associations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-inheritance-with-extensions" class="md-nav__link">
    <span class="md-ellipsis">
      d. Inheritance with Extensions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13-custom-functions-and-stored-procedures" class="md-nav__link">
    <span class="md-ellipsis">
      13. Custom Functions and Stored Procedures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13. Custom Functions and Stored Procedures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-creating-custom-functions" class="md-nav__link">
    <span class="md-ellipsis">
      a. Creating Custom Functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-stored-procedures-with-transaction-control" class="md-nav__link">
    <span class="md-ellipsis">
      b. Stored Procedures with Transaction Control
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-language-extensions" class="md-nav__link">
    <span class="md-ellipsis">
      c. Language Extensions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#14-best-practices-summary" class="md-nav__link">
    <span class="md-ellipsis">
      14. Best Practices Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="advanced-postgresql-expert-level-best-practices-optimizations-and-latest-features">Advanced PostgreSQL: Expert-Level Best Practices, Optimizations, and Latest Features</h1>
<p>PostgreSQL is a powerful, open-source relational database system celebrated for its robustness, extensibility, and compliance with SQL standards. This comprehensive guide delves into expert-level PostgreSQL practices, covering advanced configurations, performance optimizations, security measures, scalability strategies, and the latest features introduced up to PostgreSQL version 16. Whether you're a seasoned DBA or a developer seeking to harness PostgreSQL's full potential, this guide provides the insights necessary to build high-performance, secure, and scalable database systems.</p>
<hr />
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><a href="#1-installation-and-initial-configuration">Installation and Initial Configuration</a></li>
<li><a href="#2-advanced-data-types-and-extensions">Advanced Data Types and Extensions</a></li>
<li><a href="#3-indexing-strategies">Indexing Strategies</a></li>
<li><a href="#4-query-optimization-and-performance-tuning">Query Optimization and Performance Tuning</a></li>
<li><a href="#5-partitioning-and-sharding">Partitioning and Sharding</a></li>
<li><a href="#6-replication-and-high-availability">Replication and High Availability</a></li>
<li><a href="#7-backup-and-disaster-recovery">Backup and Disaster Recovery</a></li>
<li><a href="#8-security-best-practices">Security Best Practices</a></li>
<li><a href="#9-monitoring-and-maintenance">Monitoring and Maintenance</a></li>
<li><a href="#10-latest-features-in-postgresql-16">Latest Features in PostgreSQL 16</a></li>
<li><a href="#11-scaling-postgresql">Scaling PostgreSQL</a></li>
<li><a href="#12-advanced-data-modeling">Advanced Data Modeling</a></li>
<li><a href="#13-custom-functions-and-stored-procedures">Custom Functions and Stored Procedures</a></li>
<li><a href="#14-best-practices-summary">Best Practices Summary</a></li>
</ol>
<hr />
<h2 id="1-installation-and-initial-configuration">1. Installation and Initial Configuration</h2>
<h3 id="a-choosing-the-right-version">a. Choosing the Right Version</h3>
<ul>
<li><strong>Stability vs. Features:</strong> Opt for the latest stable release to benefit from recent features and performance improvements while ensuring reliability.</li>
<li><strong>Long-Term Support (LTS):</strong> Consider versions with extended support periods for enterprise environments.</li>
</ul>
<h3 id="b-installing-postgresql">b. Installing PostgreSQL</h3>
<p><strong>On Ubuntu:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>update
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>postgresql<span class="w"> </span>postgresql-contrib
</code></pre></div></td></tr></table></div></p>
<p><strong>On macOS using Homebrew:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a>brew<span class="w"> </span>update
<a id="__codelineno-1-2" name="__codelineno-1-2"></a>brew<span class="w"> </span>install<span class="w"> </span>postgresql
<a id="__codelineno-1-3" name="__codelineno-1-3"></a>brew<span class="w"> </span>services<span class="w"> </span>start<span class="w"> </span>postgresql
</code></pre></div></td></tr></table></div></p>
<p><strong>On Windows:</strong>
Download the installer from <a href="https://www.postgresql.org/download/windows/">PostgreSQL Downloads</a> and follow the installation wizard.</p>
<h3 id="c-basic-configuration">c. Basic Configuration</h3>
<p><strong>Editing <code>postgresql.conf</code>:</strong>
Located typically at <code>/etc/postgresql/&lt;version&gt;/main/postgresql.conf</code> or <code>/usr/local/var/postgres/postgresql.conf</code>.</p>
<ul>
<li>
<p><strong>Listen Addresses:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a>listen_addresses = &#39;localhost&#39;  # Restrict to local access
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Port:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a>port = 5432
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Max Connections:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a>max_connections = 200  # Adjust based on application needs
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Shared Buffers:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a>shared_buffers = 512MB  # Typically 25% of system RAM
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Work Memory:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a>work_mem = 64MB  # Per operation memory
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Maintenance Work Memory:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a>maintenance_work_mem = 1GB
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Effective Cache Size:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a>effective_cache_size = 4GB  # Roughly 75% of system RAM
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Logging:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span>
<span class="normal"><a href="#__codelineno-9-2">2</a></span>
<span class="normal"><a href="#__codelineno-9-3">3</a></span>
<span class="normal"><a href="#__codelineno-9-4">4</a></span>
<span class="normal"><a href="#__codelineno-9-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a>logging_collector = on
<a id="__codelineno-9-2" name="__codelineno-9-2"></a>log_directory = &#39;log&#39;
<a id="__codelineno-9-3" name="__codelineno-9-3"></a>log_filename = &#39;postgresql-%Y-%m-%d_%H%M%S.log&#39;
<a id="__codelineno-9-4" name="__codelineno-9-4"></a>log_min_duration_statement = 500  # Log queries longer than 500ms
<a id="__codelineno-9-5" name="__codelineno-9-5"></a>log_statement = &#39;none&#39;  # Adjust as needed
</code></pre></div></td></tr></table></div></p>
</li>
</ul>
<p><strong>Editing <code>pg_hba.conf</code>:</strong>
Located in the same directory as <code>postgresql.conf</code>.</p>
<ul>
<li>
<p><strong>Local Connections:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span>
<span class="normal"><a href="#__codelineno-10-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a># TYPE  DATABASE        USER            ADDRESS                 METHOD
<a id="__codelineno-10-2" name="__codelineno-10-2"></a>local   all             all                                     md5
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Host-Based Connections:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span>
<span class="normal"><a href="#__codelineno-11-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a>host    all             all             127.0.0.1/32            md5
<a id="__codelineno-11-2" name="__codelineno-11-2"></a>host    all             all             ::1/128                 md5
</code></pre></div></td></tr></table></div></p>
</li>
</ul>
<h3 id="d-restarting-postgresql">d. Restarting PostgreSQL</h3>
<p>After making configuration changes, restart PostgreSQL to apply them.</p>
<p><strong>On Ubuntu:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>postgresql
</code></pre></div></td></tr></table></div></p>
<p><strong>On macOS with Homebrew:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a>brew<span class="w"> </span>services<span class="w"> </span>restart<span class="w"> </span>postgresql
</code></pre></div></td></tr></table></div></p>
<hr />
<h2 id="2-advanced-data-types-and-extensions">2. Advanced Data Types and Extensions</h2>
<h3 id="a-jsonb">a. JSONB</h3>
<p><strong>Description:</strong> Efficient storage of JSON data with indexing capabilities.</p>
<p><strong>Usage:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span>
<span class="normal"><a href="#__codelineno-14-2">2</a></span>
<span class="normal"><a href="#__codelineno-14-3">3</a></span>
<span class="normal"><a href="#__codelineno-14-4">4</a></span>
<span class="normal"><a href="#__codelineno-14-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="w">    </span><span class="n">attributes</span><span class="w"> </span><span class="n">JSONB</span>
<a id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Indexing JSONB:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_products_attributes</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="n">GIN</span><span class="w"> </span><span class="p">(</span><span class="n">attributes</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="b-array-types">b. Array Types</h3>
<p><strong>Description:</strong> Store arrays of elements within a single table column.</p>
<p><strong>Usage:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1">1</a></span>
<span class="normal"><a href="#__codelineno-16-2">2</a></span>
<span class="normal"><a href="#__codelineno-16-3">3</a></span>
<span class="normal"><a href="#__codelineno-16-4">4</a></span>
<span class="normal"><a href="#__codelineno-16-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">surveys</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<a id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="w">    </span><span class="n">question</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<a id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="w">    </span><span class="n">choices</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">[]</span><span class="w">  </span><span class="c1">-- Array of text choices</span>
<a id="__codelineno-16-5" name="__codelineno-16-5"></a><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Querying Arrays:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">surveys</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="s1">&#39;Option A&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">ANY</span><span class="p">(</span><span class="n">choices</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="c-hstore">c. HStore</h3>
<p><strong>Description:</strong> Key-value store within PostgreSQL.</p>
<p><strong>Installation:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">EXTENSION</span><span class="w"> </span><span class="n">hstore</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Usage:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1">1</a></span>
<span class="normal"><a href="#__codelineno-19-2">2</a></span>
<span class="normal"><a href="#__codelineno-19-3">3</a></span>
<span class="normal"><a href="#__codelineno-19-4">4</a></span>
<span class="normal"><a href="#__codelineno-19-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">user_preferences</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<a id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="w">    </span><span class="n">user_id</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">users</span><span class="p">(</span><span class="n">id</span><span class="p">),</span>
<a id="__codelineno-19-4" name="__codelineno-19-4"></a><span class="w">    </span><span class="n">preferences</span><span class="w"> </span><span class="n">HSTORE</span>
<a id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Querying HStore:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">user_preferences</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">preferences</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s1">&#39;theme&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dark&#39;</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="d-postgis">d. PostGIS</h3>
<p><strong>Description:</strong> Spatial and geographic objects for location-based applications.</p>
<p><strong>Installation:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>postgis
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">EXTENSION</span><span class="w"> </span><span class="n">postgis</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Usage:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1">1</a></span>
<span class="normal"><a href="#__codelineno-23-2">2</a></span>
<span class="normal"><a href="#__codelineno-23-3">3</a></span>
<span class="normal"><a href="#__codelineno-23-4">4</a></span>
<span class="normal"><a href="#__codelineno-23-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">locations</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<a id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<a id="__codelineno-23-4" name="__codelineno-23-4"></a><span class="w">    </span><span class="n">geom</span><span class="w"> </span><span class="n">GEOGRAPHY</span><span class="p">(</span><span class="n">Point</span><span class="p">,</span><span class="w"> </span><span class="mi">4326</span><span class="p">)</span><span class="w">  </span><span class="c1">-- Geographic coordinate system</span>
<a id="__codelineno-23-5" name="__codelineno-23-5"></a><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Spatial Queries:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1">1</a></span>
<span class="normal"><a href="#__codelineno-24-2">2</a></span>
<span class="normal"><a href="#__codelineno-24-3">3</a></span>
<span class="normal"><a href="#__codelineno-24-4">4</a></span>
<span class="normal"><a href="#__codelineno-24-5">5</a></span>
<span class="normal"><a href="#__codelineno-24-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">locations</span>
<a id="__codelineno-24-2" name="__codelineno-24-2"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">ST_DWithin</span><span class="p">(</span>
<a id="__codelineno-24-3" name="__codelineno-24-3"></a><span class="w">    </span><span class="n">geom</span><span class="p">,</span>
<a id="__codelineno-24-4" name="__codelineno-24-4"></a><span class="w">    </span><span class="n">ST_GeographyFromText</span><span class="p">(</span><span class="s1">&#39;SRID=4326;POINT(-73.935242 40.730610)&#39;</span><span class="p">),</span>
<a id="__codelineno-24-5" name="__codelineno-24-5"></a><span class="w">    </span><span class="mi">1000</span><span class="w">  </span><span class="c1">-- Distance in meters</span>
<a id="__codelineno-24-6" name="__codelineno-24-6"></a><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="e-enumerated-types">e. Enumerated Types</h3>
<p><strong>Description:</strong> Define custom data types with a static set of values.</p>
<p><strong>Usage:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1">1</a></span>
<span class="normal"><a href="#__codelineno-25-2">2</a></span>
<span class="normal"><a href="#__codelineno-25-3">3</a></span>
<span class="normal"><a href="#__codelineno-25-4">4</a></span>
<span class="normal"><a href="#__codelineno-25-5">5</a></span>
<span class="normal"><a href="#__codelineno-25-6">6</a></span>
<span class="normal"><a href="#__codelineno-25-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TYPE</span><span class="w"> </span><span class="n">order_status</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ENUM</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;pending&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;shipped&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;delivered&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;canceled&#39;</span><span class="p">);</span>
<a id="__codelineno-25-2" name="__codelineno-25-2"></a>
<a id="__codelineno-25-3" name="__codelineno-25-3"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-25-4" name="__codelineno-25-4"></a><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<a id="__codelineno-25-5" name="__codelineno-25-5"></a><span class="w">    </span><span class="n">status</span><span class="w"> </span><span class="n">order_status</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">&#39;pending&#39;</span><span class="p">,</span>
<a id="__codelineno-25-6" name="__codelineno-25-6"></a><span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="k">TIME</span><span class="w"> </span><span class="k">ZONE</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="n">NOW</span><span class="p">()</span>
<a id="__codelineno-25-7" name="__codelineno-25-7"></a><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<hr />
<h2 id="3-indexing-strategies">3. Indexing Strategies</h2>
<p>Effective indexing is paramount for query performance. PostgreSQL offers various indexing methods beyond the default B-tree.</p>
<h3 id="a-b-tree-indexes">a. B-tree Indexes</h3>
<p><strong>Description:</strong> Default and versatile index type suitable for equality and range queries.</p>
<p><strong>Creating an Index:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_users_username</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="p">(</span><span class="n">username</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="b-gin-and-gist-indexes">b. GIN and GiST Indexes</h3>
<p><strong>Description:</strong> Suitable for full-text search, JSONB, array fields, and geometric data.</p>
<p><strong>Example for JSONB:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_products_attributes</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="n">GIN</span><span class="w"> </span><span class="p">(</span><span class="n">attributes</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Example for PostGIS:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_locations_geom</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">locations</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="n">GIST</span><span class="w"> </span><span class="p">(</span><span class="n">geom</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="c-partial-indexes">c. Partial Indexes</h3>
<p><strong>Description:</strong> Index a subset of table rows based on a condition, reducing index size and improving performance.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_active_users</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="p">(</span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">is_active</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">TRUE</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="d-expression-indexes">d. Expression Indexes</h3>
<p><strong>Description:</strong> Index based on the result of an expression, enabling efficient querying of computed values.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_lower_username</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="p">(</span><span class="k">LOWER</span><span class="p">(</span><span class="n">username</span><span class="p">));</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="e-brin-indexes">e. BRIN Indexes</h3>
<p><strong>Description:</strong> Block Range Indexes for very large tables with naturally ordered data, offering smaller size with approximate query performance.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_large_table_created_at</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">large_table</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="n">BRIN</span><span class="w"> </span><span class="p">(</span><span class="n">created_at</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="f-covering-indexes">f. Covering Indexes</h3>
<p><strong>Description:</strong> Include additional columns in an index to cover queries, reducing the need to access the table data.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_orders_status_created_at</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">created_at</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="g-unique-indexes">g. Unique Indexes</h3>
<p><strong>Description:</strong> Enforce uniqueness of column values, preventing duplicate entries.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_unique_email</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="p">(</span><span class="n">email</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<hr />
<h2 id="4-query-optimization-and-performance-tuning">4. Query Optimization and Performance Tuning</h2>
<p>Optimizing queries ensures efficient data retrieval and overall database performance.</p>
<h3 id="a-analyzing-query-performance">a. Analyzing Query Performance</h3>
<p><strong>Using <code>EXPLAIN</code> and <code>EXPLAIN ANALYZE</code>:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-34-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1"></a><span class="k">EXPLAIN</span><span class="w"> </span><span class="k">ANALYZE</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
</code></pre></div></td></tr></table></div>
- <strong><code>EXPLAIN</code>:</strong> Provides the query execution plan.
- <strong><code>EXPLAIN ANALYZE</code>:</strong> Executes the query and shows actual run times.</p>
<p><strong>Interpreting Results:</strong>
- <strong>Seq Scan vs. Index Scan:</strong> Prefer index scans for large tables to avoid full table scans.
- <strong>Cost Estimates:</strong> Lower costs indicate more efficient plans.
- <strong>Actual Time:</strong> Helps identify discrepancies between estimates and real performance.</p>
<h3 id="b-optimizing-joins">b. Optimizing Joins</h3>
<ul>
<li><strong>Use Proper Indexes:</strong> Ensure join columns are indexed.</li>
<li><strong>Join Order:</strong> PostgreSQL's planner generally handles this, but explicit ordering can sometimes help.</li>
<li><strong>Avoid Unnecessary Columns:</strong> Select only required columns to reduce data transfer.</li>
</ul>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1">1</a></span>
<span class="normal"><a href="#__codelineno-35-2">2</a></span>
<span class="normal"><a href="#__codelineno-35-3">3</a></span>
<span class="normal"><a href="#__codelineno-35-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">name</span>
<a id="__codelineno-35-2" name="__codelineno-35-2"></a><span class="k">FROM</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="n">u</span>
<a id="__codelineno-35-3" name="__codelineno-35-3"></a><span class="k">JOIN</span><span class="w"> </span><span class="n">posts</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">user_id</span>
<a id="__codelineno-35-4" name="__codelineno-35-4"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">active</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">TRUE</span><span class="p">;</span>
</code></pre></div></td></tr></table></div>
Ensure indexes on <code>users.id</code>, <code>users.active</code>, and <code>posts.user_id</code>.</p>
<h3 id="c-reducing-query-complexity">c. Reducing Query Complexity</h3>
<ul>
<li><strong>Avoid Subqueries:</strong> Use joins or Common Table Expressions (CTEs) instead.</li>
<li><strong>Use CTEs Wisely:</strong> Materialized CTEs can improve readability but may impact performance if not used appropriately.</li>
<li><strong>Leverage Window Functions:</strong> Perform calculations without multiple queries.</li>
</ul>
<p><strong>Example Using Window Functions:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-36-1">1</a></span>
<span class="normal"><a href="#__codelineno-36-2">2</a></span>
<span class="normal"><a href="#__codelineno-36-3">3</a></span>
<span class="normal"><a href="#__codelineno-36-4">4</a></span>
<span class="normal"><a href="#__codelineno-36-5">5</a></span>
<span class="normal"><a href="#__codelineno-36-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1"></a><span class="k">SELECT</span><span class="w"> </span>
<a id="__codelineno-36-2" name="__codelineno-36-2"></a><span class="w">    </span><span class="n">id</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-36-3" name="__codelineno-36-3"></a><span class="w">    </span><span class="n">name</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-36-4" name="__codelineno-36-4"></a><span class="w">    </span><span class="n">price</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-36-5" name="__codelineno-36-5"></a><span class="w">    </span><span class="k">AVG</span><span class="p">(</span><span class="n">price</span><span class="p">)</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">average_price</span>
<a id="__codelineno-36-6" name="__codelineno-36-6"></a><span class="k">FROM</span><span class="w"> </span><span class="n">products</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="d-utilizing-vacuum-and-analyze">d. Utilizing <code>VACUUM</code> and <code>ANALYZE</code></h3>
<ul>
<li><strong><code>VACUUM</code>:</strong> Reclaims storage occupied by dead tuples.</li>
<li><strong><code>ANALYZE</code>:</strong> Updates statistics used by the query planner.</li>
</ul>
<p><strong>Automated Maintenance:</strong>
Configure <code>autovacuum</code> settings in <code>postgresql.conf</code> for regular maintenance.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-37-1">1</a></span>
<span class="normal"><a href="#__codelineno-37-2">2</a></span>
<span class="normal"><a href="#__codelineno-37-3">3</a></span>
<span class="normal"><a href="#__codelineno-37-4">4</a></span>
<span class="normal"><a href="#__codelineno-37-5">5</a></span>
<span class="normal"><a href="#__codelineno-37-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1"></a>autovacuum = on
<a id="__codelineno-37-2" name="__codelineno-37-2"></a>autovacuum_naptime = 1min
<a id="__codelineno-37-3" name="__codelineno-37-3"></a>autovacuum_vacuum_threshold = 50
<a id="__codelineno-37-4" name="__codelineno-37-4"></a>autovacuum_analyze_threshold = 50
<a id="__codelineno-37-5" name="__codelineno-37-5"></a>autovacuum_vacuum_scale_factor = 0.2
<a id="__codelineno-37-6" name="__codelineno-37-6"></a>autovacuum_analyze_scale_factor = 0.1
</code></pre></div></td></tr></table></div>
<h3 id="e-caching-strategies">e. Caching Strategies</h3>
<ul>
<li><strong>Result Caching:</strong> Cache frequently executed queries using external caching systems like Redis or Memcached.</li>
<li><strong>Prepared Statements:</strong> Use prepared statements to reduce parsing and planning overhead.</li>
</ul>
<p><strong>Example Using Prepared Statements:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-38-1">1</a></span>
<span class="normal"><a href="#__codelineno-38-2">2</a></span>
<span class="normal"><a href="#__codelineno-38-3">3</a></span>
<span class="normal"><a href="#__codelineno-38-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1"></a><span class="k">PREPARE</span><span class="w"> </span><span class="n">expensive_query</span><span class="w"> </span><span class="k">AS</span>
<a id="__codelineno-38-2" name="__codelineno-38-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="err">$</span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-38-3" name="__codelineno-38-3"></a>
<a id="__codelineno-38-4" name="__codelineno-38-4"></a><span class="k">EXECUTE</span><span class="w"> </span><span class="n">expensive_query</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="f-parallel-query-execution">f. Parallel Query Execution</h3>
<p>Leverage PostgreSQL's ability to execute parts of a query in parallel.</p>
<p><strong>Configuration:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-39-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1"></a>max_parallel_workers_per_gather = 4
</code></pre></div></td></tr></table></div></p>
<p><strong>Usage:</strong>
Enable parallelism for suitable queries by ensuring:
- The table is large enough.
- Proper indexes exist.
- Queries are written to allow parallel execution.</p>
<hr />
<h2 id="5-partitioning-and-sharding">5. Partitioning and Sharding</h2>
<p>Handling large datasets efficiently requires partitioning or sharding the database.</p>
<h3 id="a-table-partitioning">a. Table Partitioning</h3>
<p><strong>Description:</strong> Divides a large table into smaller, more manageable pieces called partitions.</p>
<p><strong>Types of Partitioning:</strong>
- <strong>Range Partitioning:</strong> Based on ranges of values (e.g., dates).
- <strong>List Partitioning:</strong> Based on a list of values (e.g., categories).
- <strong>Hash Partitioning:</strong> Distributes rows across partitions using a hash function.</p>
<p><strong>Example: Range Partitioning by Date:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-40-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-40-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-40-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-40-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-40-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-40-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-40-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-40-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-40-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-40-10">10</a></span>
<span class="normal"><a href="#__codelineno-40-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-40-2" name="__codelineno-40-2"></a><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<a id="__codelineno-40-3" name="__codelineno-40-3"></a><span class="w">    </span><span class="n">order_date</span><span class="w"> </span><span class="nb">DATE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<a id="__codelineno-40-4" name="__codelineno-40-4"></a><span class="w">    </span><span class="n">amount</span><span class="w"> </span><span class="nb">DECIMAL</span>
<a id="__codelineno-40-5" name="__codelineno-40-5"></a><span class="p">)</span><span class="w"> </span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">RANGE</span><span class="w"> </span><span class="p">(</span><span class="n">order_date</span><span class="p">);</span>
<a id="__codelineno-40-6" name="__codelineno-40-6"></a>
<a id="__codelineno-40-7" name="__codelineno-40-7"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">orders_2023</span><span class="w"> </span><span class="n">PARTITION</span><span class="w"> </span><span class="k">OF</span><span class="w"> </span><span class="n">orders</span>
<a id="__codelineno-40-8" name="__codelineno-40-8"></a><span class="w">    </span><span class="k">FOR</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;2024-01-01&#39;</span><span class="p">);</span>
<a id="__codelineno-40-9" name="__codelineno-40-9"></a>
<a id="__codelineno-40-10" name="__codelineno-40-10"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">orders_2024</span><span class="w"> </span><span class="n">PARTITION</span><span class="w"> </span><span class="k">OF</span><span class="w"> </span><span class="n">orders</span>
<a id="__codelineno-40-11" name="__codelineno-40-11"></a><span class="w">    </span><span class="k">FOR</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;2024-01-01&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;2025-01-01&#39;</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="b-declarative-partitioning">b. Declarative Partitioning</h3>
<p><strong>Description:</strong> Introduced in PostgreSQL 10, allows easy management of partitions without extensive boilerplate.</p>
<p><strong>Benefits:</strong>
- Simplified syntax.
- Improved planner support.
- Enhanced performance for partitioned tables.</p>
<p><strong>Example:</strong>
As above in Range Partitioning.</p>
<h3 id="c-sharding">c. Sharding</h3>
<p><strong>Description:</strong> Distributes data across multiple database instances to achieve horizontal scalability.</p>
<p><strong>Implementation Strategies:</strong>
- <strong>Application-Level Sharding:</strong> The application directs queries to specific shards based on sharding keys.
- <strong>Citus Extension:</strong> Transforms PostgreSQL into a distributed database, handling sharding transparently.</p>
<p><strong>Example Using Citus:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-41-1">1</a></span>
<span class="normal"><a href="#__codelineno-41-2">2</a></span>
<span class="normal"><a href="#__codelineno-41-3">3</a></span>
<span class="normal"><a href="#__codelineno-41-4">4</a></span>
<span class="normal"><a href="#__codelineno-41-5">5</a></span>
<span class="normal"><a href="#__codelineno-41-6">6</a></span>
<span class="normal"><a href="#__codelineno-41-7">7</a></span>
<span class="normal"><a href="#__codelineno-41-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1"></a><span class="c1"># Install Citus</span>
<a id="__codelineno-41-2" name="__codelineno-41-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>postgresql-16-citus-12.3
<a id="__codelineno-41-3" name="__codelineno-41-3"></a>
<a id="__codelineno-41-4" name="__codelineno-41-4"></a><span class="c1"># Configure Citus in postgresql.conf</span>
<a id="__codelineno-41-5" name="__codelineno-41-5"></a><span class="nv">shared_preload_libraries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;citus&#39;</span>
<a id="__codelineno-41-6" name="__codelineno-41-6"></a>
<a id="__codelineno-41-7" name="__codelineno-41-7"></a><span class="c1"># Restart PostgreSQL</span>
<a id="__codelineno-41-8" name="__codelineno-41-8"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>postgresql
</code></pre></div></td></tr></table></div></p>
<p><strong>Creating a Distributed Table:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-42-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">create_distributed_table</span><span class="p">(</span><span class="s1">&#39;orders&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;order_id&#39;</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="d-benefits-and-trade-offs">d. Benefits and Trade-offs</h3>
<ul>
<li><strong>Benefits:</strong></li>
<li>Enhanced performance for large datasets.</li>
<li>
<p>Improved scalability.</p>
</li>
<li>
<p><strong>Trade-offs:</strong></p>
</li>
<li>Increased complexity in management.</li>
<li>Potential for data distribution skew.</li>
</ul>
<hr />
<h2 id="6-replication-and-high-availability">6. Replication and High Availability</h2>
<p>Ensuring data redundancy and minimizing downtime is critical for mission-critical applications.</p>
<h3 id="a-streaming-replication">a. Streaming Replication</h3>
<p><strong>Description:</strong> Real-time replication of data from a primary to one or more standby servers.</p>
<p><strong>Setup Steps:</strong></p>
<ol>
<li><strong>Primary Server Configuration:</strong>
   <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-43-1">1</a></span>
<span class="normal"><a href="#__codelineno-43-2">2</a></span>
<span class="normal"><a href="#__codelineno-43-3">3</a></span>
<span class="normal"><a href="#__codelineno-43-4">4</a></span>
<span class="normal"><a href="#__codelineno-43-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1"></a># postgresql.conf
<a id="__codelineno-43-2" name="__codelineno-43-2"></a>wal_level = replica
<a id="__codelineno-43-3" name="__codelineno-43-3"></a>max_wal_senders = 10
<a id="__codelineno-43-4" name="__codelineno-43-4"></a>wal_keep_segments = 64
<a id="__codelineno-43-5" name="__codelineno-43-5"></a>hot_standby = on
</code></pre></div></td></tr></table></div></li>
</ol>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-44-1">1</a></span>
<span class="normal"><a href="#__codelineno-44-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1"></a># pg_hba.conf
<a id="__codelineno-44-2" name="__codelineno-44-2"></a>host replication replicator 192.168.1.2/32 md5
</code></pre></div></td></tr></table></div>
<ol>
<li>
<p><strong>Create a Replication User:</strong>
   <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-45-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">ROLE</span><span class="w"> </span><span class="n">replicator</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">REPLICATION</span><span class="w"> </span><span class="n">LOGIN</span><span class="w"> </span><span class="n">PASSWORD</span><span class="w"> </span><span class="s1">&#39;replicatorpassword&#39;</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Secondary Server Setup:</strong></p>
</li>
<li>
<p><strong>Using <code>pg_basebackup</code>:</strong>
     <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-46-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1"></a>pg_basebackup<span class="w"> </span>-h<span class="w"> </span>primary_host<span class="w"> </span>-D<span class="w"> </span>/var/lib/postgresql/data<span class="w"> </span>-U<span class="w"> </span>replicator<span class="w"> </span>-P<span class="w"> </span>--wal-method<span class="o">=</span>stream
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Configure Recovery:</strong>
     For PostgreSQL 12+, use <code>standby.signal</code> and <code>postgresql.auto.conf</code>.
     <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-47-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1"></a>touch<span class="w"> </span>/var/lib/postgresql/data/standby.signal
</code></pre></div></td></tr></table></div>
     <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-48-1">1</a></span>
<span class="normal"><a href="#__codelineno-48-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1"></a># postgresql.auto.conf
<a id="__codelineno-48-2" name="__codelineno-48-2"></a>primary_conninfo = &#39;host=primary_host port=5432 user=replicator password=replicatorpassword&#39;
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Start PostgreSQL on the Standby:</strong>
   <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-49-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>postgresql
</code></pre></div></td></tr></table></div></p>
</li>
</ol>
<h3 id="b-logical-replication">b. Logical Replication</h3>
<p><strong>Description:</strong> Replicates specific tables or subsets of data, allowing for more granular control.</p>
<p><strong>Setup Steps:</strong></p>
<ol>
<li>
<p><strong>Primary Server Configuration:</strong>
   <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-50-1">1</a></span>
<span class="normal"><a href="#__codelineno-50-2">2</a></span>
<span class="normal"><a href="#__codelineno-50-3">3</a></span>
<span class="normal"><a href="#__codelineno-50-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1"></a># postgresql.conf
<a id="__codelineno-50-2" name="__codelineno-50-2"></a>wal_level = logical
<a id="__codelineno-50-3" name="__codelineno-50-3"></a>max_replication_slots = 4
<a id="__codelineno-50-4" name="__codelineno-50-4"></a>max_wal_senders = 10
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Create a Publication:</strong>
   <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-51-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">PUBLICATION</span><span class="w"> </span><span class="n">mypublication</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">products</span><span class="p">,</span><span class="w"> </span><span class="n">orders</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Secondary Server Setup:</strong></p>
</li>
<li><strong>Create a Subscription:</strong>
     <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-52-1">1</a></span>
<span class="normal"><a href="#__codelineno-52-2">2</a></span>
<span class="normal"><a href="#__codelineno-52-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">SUBSCRIPTION</span><span class="w"> </span><span class="n">mysubscription</span>
<a id="__codelineno-52-2" name="__codelineno-52-2"></a><span class="k">CONNECTION</span><span class="w"> </span><span class="s1">&#39;host=primary_host port=5432 dbname=mydb user=replicator password=replicatorpassword&#39;</span>
<a id="__codelineno-52-3" name="__codelineno-52-3"></a><span class="n">PUBLICATION</span><span class="w"> </span><span class="n">mypublication</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></li>
</ol>
<h3 id="c-high-availability-tools">c. High Availability Tools</h3>
<p><strong>i. Patroni</strong></p>
<p><strong>Description:</strong> Automates PostgreSQL failover and leader election using distributed configuration stores like Etcd or Consul.</p>
<p><strong>Installation:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-53-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1"></a>pip<span class="w"> </span>install<span class="w"> </span>patroni
</code></pre></div></td></tr></table></div></p>
<p><strong>Configuration:</strong>
Create a <code>patroni.yml</code> with cluster and node settings.</p>
<p><strong>Starting Patroni:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-54-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1"></a>patroni<span class="w"> </span>patroni.yml
</code></pre></div></td></tr></table></div></p>
<p><strong>ii. repmgr</strong></p>
<p><strong>Description:</strong> Manages replication and failover with additional monitoring capabilities.</p>
<p><strong>Installation:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-55-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>repmgr
</code></pre></div></td></tr></table></div></p>
<p><strong>Configuration:</strong>
Set up <code>repmgr.conf</code> on all nodes with cluster details.</p>
<p><strong>Commands:</strong>
- <strong>Register Nodes:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-56-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1"></a>repmgr<span class="w"> </span>-f<span class="w"> </span>/etc/repmgr.conf<span class="w"> </span>primary<span class="w"> </span>register
</code></pre></div></td></tr></table></div>
- <strong>Failover:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-57-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1"></a>repmgr<span class="w"> </span>-f<span class="w"> </span>/etc/repmgr.conf<span class="w"> </span>standby<span class="w"> </span>switchover
</code></pre></div></td></tr></table></div></p>
<h3 id="d-benefits-of-replication">d. Benefits of Replication</h3>
<ul>
<li><strong>Data Redundancy:</strong> Prevent data loss in case of primary server failure.</li>
<li><strong>Load Distribution:</strong> Offload read operations to standby servers.</li>
<li><strong>Disaster Recovery:</strong> Facilitate rapid recovery from catastrophic failures.</li>
</ul>
<hr />
<h2 id="7-backup-and-disaster-recovery">7. Backup and Disaster Recovery</h2>
<p>Implementing robust backup strategies ensures data integrity and availability.</p>
<h3 id="a-logical-backups">a. Logical Backups</h3>
<p><strong>Using <code>pg_dump</code>:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-58-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1"></a>pg_dump<span class="w"> </span>-U<span class="w"> </span>myuser<span class="w"> </span>-h<span class="w"> </span>localhost<span class="w"> </span>-F<span class="w"> </span>c<span class="w"> </span>mydatabase<span class="w"> </span>&gt;<span class="w"> </span>mydatabase.backup
</code></pre></div></td></tr></table></div></p>
<p><strong>Using <code>pg_restore</code>:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-59-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1"></a>pg_restore<span class="w"> </span>-U<span class="w"> </span>myuser<span class="w"> </span>-h<span class="w"> </span>localhost<span class="w"> </span>-d<span class="w"> </span>mydatabase<span class="w"> </span>-1<span class="w"> </span>mydatabase.backup
</code></pre></div></td></tr></table></div></p>
<p><strong>Pros:</strong>
- Flexible restoration of specific tables or schemas.
- Portable across different PostgreSQL versions.</p>
<p><strong>Cons:</strong>
- Slower for large databases.
- Requires downtime for consistent snapshots.</p>
<h3 id="b-physical-backups">b. Physical Backups</h3>
<p><strong>Using <code>pg_basebackup</code>:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-60-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1"></a>pg_basebackup<span class="w"> </span>-U<span class="w"> </span>replicator<span class="w"> </span>-h<span class="w"> </span>primary_host<span class="w"> </span>-D<span class="w"> </span>/var/lib/postgresql/backups/base<span class="w"> </span>-P<span class="w"> </span>-v
</code></pre></div></td></tr></table></div></p>
<p><strong>Pros:</strong>
- Fast and efficient for large databases.
- Can be used for replication setups.</p>
<p><strong>Cons:</strong>
- Tied to specific PostgreSQL versions.
- Less flexible in selective restoration.</p>
<h3 id="c-point-in-time-recovery-pitr">c. Point-In-Time Recovery (PITR)</h3>
<p><strong>Description:</strong> Allows restoring the database to a specific moment before a failure or corruption.</p>
<p><strong>Setup Steps:</strong></p>
<ol>
<li>
<p><strong>Configure WAL Archiving:</strong>
   <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-61-1">1</a></span>
<span class="normal"><a href="#__codelineno-61-2">2</a></span>
<span class="normal"><a href="#__codelineno-61-3">3</a></span>
<span class="normal"><a href="#__codelineno-61-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1"></a># postgresql.conf
<a id="__codelineno-61-2" name="__codelineno-61-2"></a>wal_level = replica
<a id="__codelineno-61-3" name="__codelineno-61-3"></a>archive_mode = on
<a id="__codelineno-61-4" name="__codelineno-61-4"></a>archive_command = &#39;cp %p /var/lib/postgresql/wal_archive/%f&#39;
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Perform a Base Backup:</strong>
   <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-62-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1"></a>pg_basebackup<span class="w"> </span>-U<span class="w"> </span>replicator<span class="w"> </span>-h<span class="w"> </span>primary_host<span class="w"> </span>-D<span class="w"> </span>/var/lib/postgresql/backups/base<span class="w"> </span>-P<span class="w"> </span>-v
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Recovery Procedure:</strong></p>
</li>
<li>
<p><strong>Restore Base Backup:</strong>
     <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-63-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1"></a>pg_restore<span class="w"> </span>-U<span class="w"> </span>myuser<span class="w"> </span>-h<span class="w"> </span>localhost<span class="w"> </span>-d<span class="w"> </span>mydatabase<span class="w"> </span>/backups/mydatabase.backup
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Configure Recovery:</strong>
     Create <code>recovery.signal</code> file and set <code>restore_command</code> in <code>postgresql.auto.conf</code>.
     <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-64-1">1</a></span>
<span class="normal"><a href="#__codelineno-64-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1"></a>restore_command = &#39;cp /var/lib/postgresql/wal_archive/%f %p&#39;
<a id="__codelineno-64-2" name="__codelineno-64-2"></a>recovery_target_time = &#39;2025-01-01 12:00:00&#39;
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Start PostgreSQL:</strong>
     <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-65-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-65-1" name="__codelineno-65-1"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>postgresql
</code></pre></div></td></tr></table></div></p>
</li>
</ol>
<h3 id="d-automated-backup-solutions">d. Automated Backup Solutions</h3>
<p><strong>i. Barman</strong></p>
<p><strong>Description:</strong> Backup and recovery manager for PostgreSQL.</p>
<p><strong>Installation:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-66-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-66-1" name="__codelineno-66-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>barman
</code></pre></div></td></tr></table></div></p>
<p><strong>Configuration:</strong>
Define the PostgreSQL server in <code>barman.conf</code> and set up backup schedules.</p>
<p><strong>Commands:</strong>
- <strong>Register Server:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-67-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-67-1" name="__codelineno-67-1"></a>barman<span class="w"> </span>register<span class="w"> </span>mydb
</code></pre></div></td></tr></table></div>
- <strong>Perform Backup:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-68-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-68-1" name="__codelineno-68-1"></a>barman<span class="w"> </span>backup<span class="w"> </span>mydb
</code></pre></div></td></tr></table></div>
- <strong>Restore Backup:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-69-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-69-1" name="__codelineno-69-1"></a>barman<span class="w"> </span>recover<span class="w"> </span>mydb<span class="w"> </span>latest<span class="w"> </span>/var/lib/postgresql/data
</code></pre></div></td></tr></table></div></p>
<p><strong>ii. pgBackRest</strong></p>
<p><strong>Description:</strong> Reliable backup and restore solution with support for parallel processing and compression.</p>
<p><strong>Installation:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-70-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-70-1" name="__codelineno-70-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>pgbackrest
</code></pre></div></td></tr></table></div></p>
<p><strong>Configuration:</strong>
Set up <code>pgbackrest.conf</code> with repository and stanza definitions.</p>
<p><strong>Commands:</strong>
- <strong>Initialize Stanza:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-71-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-71-1" name="__codelineno-71-1"></a>pgbackrest<span class="w"> </span>--stanza<span class="o">=</span>mydb<span class="w"> </span>--log-level-console<span class="o">=</span>info<span class="w"> </span>stanza-create
</code></pre></div></td></tr></table></div>
- <strong>Perform Backup:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-72-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-72-1" name="__codelineno-72-1"></a>pgbackrest<span class="w"> </span>--stanza<span class="o">=</span>mydb<span class="w"> </span>backup
</code></pre></div></td></tr></table></div>
- <strong>Restore Backup:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-73-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-73-1" name="__codelineno-73-1"></a>pgbackrest<span class="w"> </span>--stanza<span class="o">=</span>mydb<span class="w"> </span>restore
</code></pre></div></td></tr></table></div></p>
<h3 id="e-best-practices">e. Best Practices</h3>
<ul>
<li><strong>Regular Backups:</strong> Schedule frequent backups based on data volatility.</li>
<li><strong>Offsite Storage:</strong> Store backups in geographically separate locations.</li>
<li><strong>Test Restorations:</strong> Regularly verify backup integrity by performing test restores.</li>
<li><strong>Automate Backup Processes:</strong> Use scripts or backup tools to minimize human error.</li>
</ul>
<hr />
<h2 id="8-security-best-practices">8. Security Best Practices</h2>
<p>Ensuring the security of your PostgreSQL database is paramount to protect sensitive data and maintain system integrity.</p>
<h3 id="a-authentication-and-authorization">a. Authentication and Authorization</h3>
<p><strong>i. Role-Based Access Control (RBAC):</strong></p>
<ul>
<li>
<p><strong>Create Specific Roles:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-74-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-74-1" name="__codelineno-74-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">ROLE</span><span class="w"> </span><span class="n">app_user</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">LOGIN</span><span class="w"> </span><span class="n">PASSWORD</span><span class="w"> </span><span class="s1">&#39;securepassword&#39;</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Grant Necessary Privileges:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-75-1">1</a></span>
<span class="normal"><a href="#__codelineno-75-2">2</a></span>
<span class="normal"><a href="#__codelineno-75-3">3</a></span>
<span class="normal"><a href="#__codelineno-75-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-75-1" name="__codelineno-75-1"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">CONNECT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">mydatabase</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">app_user</span><span class="p">;</span>
<a id="__codelineno-75-2" name="__codelineno-75-2"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">USAGE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">app_user</span><span class="p">;</span>
<a id="__codelineno-75-3" name="__codelineno-75-3"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="p">,</span><span class="w"> </span><span class="k">INSERT</span><span class="p">,</span><span class="w"> </span><span class="k">UPDATE</span><span class="p">,</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="n">TABLES</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">app_user</span><span class="p">;</span>
<a id="__codelineno-75-4" name="__codelineno-75-4"></a><span class="k">ALTER</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">PRIVILEGES</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="p">,</span><span class="w"> </span><span class="k">INSERT</span><span class="p">,</span><span class="w"> </span><span class="k">UPDATE</span><span class="p">,</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">TABLES</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">app_user</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
</li>
</ul>
<p><strong>ii. Least Privilege Principle:</strong>
- Assign users only the permissions they require to perform their tasks.</p>
<h3 id="b-secure-connections">b. Secure Connections</h3>
<p><strong>i. Enable SSL/TLS:</strong></p>
<ul>
<li>
<p><strong>Generate SSL Certificates:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-76-1">1</a></span>
<span class="normal"><a href="#__codelineno-76-2">2</a></span>
<span class="normal"><a href="#__codelineno-76-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-76-1" name="__codelineno-76-1"></a>openssl<span class="w"> </span>req<span class="w"> </span>-new<span class="w"> </span>-text<span class="w"> </span>-passout<span class="w"> </span>pass:abcd<span class="w"> </span>-subj<span class="w"> </span>/CN<span class="o">=</span>yourdomain.com<span class="w"> </span>-keyout<span class="w"> </span>server.key<span class="w"> </span>-out<span class="w"> </span>server.req
<a id="__codelineno-76-2" name="__codelineno-76-2"></a>openssl<span class="w"> </span>rsa<span class="w"> </span>-in<span class="w"> </span>server.key<span class="w"> </span>-passin<span class="w"> </span>pass:abcd<span class="w"> </span>-out<span class="w"> </span>server.key
<a id="__codelineno-76-3" name="__codelineno-76-3"></a>openssl<span class="w"> </span>x509<span class="w"> </span>-req<span class="w"> </span>-in<span class="w"> </span>server.req<span class="w"> </span>-text<span class="w"> </span>-days<span class="w"> </span><span class="m">3650</span><span class="w"> </span>-extfile<span class="w"> </span>/etc/ssl/openssl.cnf<span class="w"> </span>-extensions<span class="w"> </span>v3_ca<span class="w"> </span>-signkey<span class="w"> </span>server.key<span class="w"> </span>-out<span class="w"> </span>server.crt
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Configure PostgreSQL to Use SSL:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-77-1">1</a></span>
<span class="normal"><a href="#__codelineno-77-2">2</a></span>
<span class="normal"><a href="#__codelineno-77-3">3</a></span>
<span class="normal"><a href="#__codelineno-77-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-77-1" name="__codelineno-77-1"></a># postgresql.conf
<a id="__codelineno-77-2" name="__codelineno-77-2"></a>ssl = on
<a id="__codelineno-77-3" name="__codelineno-77-3"></a>ssl_cert_file = &#39;server.crt&#39;
<a id="__codelineno-77-4" name="__codelineno-77-4"></a>ssl_key_file = &#39;server.key&#39;
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Update <code>pg_hba.conf</code> to Require SSL:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-78-1">1</a></span>
<span class="normal"><a href="#__codelineno-78-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-78-1" name="__codelineno-78-1"></a>hostssl all all 0.0.0.0/0 md5
<a id="__codelineno-78-2" name="__codelineno-78-2"></a>hostssl all all ::/0 md5
</code></pre></div></td></tr></table></div></p>
</li>
</ul>
<p><strong>ii. Enforce SSL Connections:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-79-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-79-1" name="__codelineno-79-1"></a><span class="k">ALTER</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">mydatabase</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">sslmode</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;require&#39;</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="c-data-encryption">c. Data Encryption</h3>
<p><strong>i. Encrypt Data at Rest:</strong>
- <strong>Filesystem-Level Encryption:</strong> Use tools like LUKS to encrypt the storage volume.</p>
<ul>
<li><strong>Transparent Data Encryption (TDE):</strong> PostgreSQL does not natively support TDE, but extensions like <code>pgcrypto</code> can be used for field-level encryption.</li>
</ul>
<p><strong>ii. Encrypt Sensitive Columns:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-80-1">1</a></span>
<span class="normal"><a href="#__codelineno-80-2">2</a></span>
<span class="normal"><a href="#__codelineno-80-3">3</a></span>
<span class="normal"><a href="#__codelineno-80-4">4</a></span>
<span class="normal"><a href="#__codelineno-80-5">5</a></span>
<span class="normal"><a href="#__codelineno-80-6">6</a></span>
<span class="normal"><a href="#__codelineno-80-7">7</a></span>
<span class="normal"><a href="#__codelineno-80-8">8</a></span>
<span class="normal"><a href="#__codelineno-80-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-80-1" name="__codelineno-80-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">EXTENSION</span><span class="w"> </span><span class="n">pgcrypto</span><span class="p">;</span>
<a id="__codelineno-80-2" name="__codelineno-80-2"></a>
<a id="__codelineno-80-3" name="__codelineno-80-3"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">secure_data</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-80-4" name="__codelineno-80-4"></a><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<a id="__codelineno-80-5" name="__codelineno-80-5"></a><span class="w">    </span><span class="n">sensitive_info</span><span class="w"> </span><span class="n">BYTEA</span>
<a id="__codelineno-80-6" name="__codelineno-80-6"></a><span class="p">);</span>
<a id="__codelineno-80-7" name="__codelineno-80-7"></a>
<a id="__codelineno-80-8" name="__codelineno-80-8"></a><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">secure_data</span><span class="w"> </span><span class="p">(</span><span class="n">sensitive_info</span><span class="p">)</span><span class="w"> </span>
<a id="__codelineno-80-9" name="__codelineno-80-9"></a><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="n">pgp_sym_encrypt</span><span class="p">(</span><span class="s1">&#39;Confidential Data&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;encryption_key&#39;</span><span class="p">));</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Decryption:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-81-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-81-1" name="__codelineno-81-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">pgp_sym_decrypt</span><span class="p">(</span><span class="n">sensitive_info</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;encryption_key&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">decrypted_info</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">secure_data</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="d-network-security">d. Network Security</h3>
<p><strong>i. Firewall Configuration:</strong>
- Restrict PostgreSQL access to trusted IP addresses.
- Use firewalls (e.g., <code>ufw</code>, <code>iptables</code>) to limit incoming connections on PostgreSQL's port.</p>
<p><strong>ii. Use VPNs or SSH Tunnels:</strong>
- Secure remote access by routing database connections through VPNs or SSH tunnels.</p>
<h3 id="e-regular-audits-and-monitoring">e. Regular Audits and Monitoring</h3>
<p><strong>i. Enable Detailed Logging:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-82-1">1</a></span>
<span class="normal"><a href="#__codelineno-82-2">2</a></span>
<span class="normal"><a href="#__codelineno-82-3">3</a></span>
<span class="normal"><a href="#__codelineno-82-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-82-1" name="__codelineno-82-1"></a># postgresql.conf
<a id="__codelineno-82-2" name="__codelineno-82-2"></a>log_statement = &#39;all&#39;  # Options: none, ddl, mod, all
<a id="__codelineno-82-3" name="__codelineno-82-3"></a>log_directory = &#39;log&#39;
<a id="__codelineno-82-4" name="__codelineno-82-4"></a>log_filename = &#39;postgresql-%Y-%m-%d_%H%M%S.log&#39;
</code></pre></div></td></tr></table></div></p>
<p><strong>ii. Use Audit Extensions:</strong>
- <strong>pgAudit:</strong> Provides detailed session and object audit logging.</p>
<p><strong>Installation:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-83-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-83-1" name="__codelineno-83-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">EXTENSION</span><span class="w"> </span><span class="n">pgaudit</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Configuration:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-84-1">1</a></span>
<span class="normal"><a href="#__codelineno-84-2">2</a></span>
<span class="normal"><a href="#__codelineno-84-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-84-1" name="__codelineno-84-1"></a># postgresql.conf
<a id="__codelineno-84-2" name="__codelineno-84-2"></a>shared_preload_libraries = &#39;pgaudit&#39;
<a id="__codelineno-84-3" name="__codelineno-84-3"></a>pgaudit.log = &#39;all&#39;
</code></pre></div></td></tr></table></div></p>
<p><strong>iii. Monitor with Tools:</strong>
- <strong>pgAdmin:</strong> Comprehensive management and monitoring tool.
- <strong>Prometheus &amp; Grafana:</strong> Set up exporters for PostgreSQL metrics.
- <strong>ELK Stack (Elasticsearch, Logstash, Kibana):</strong> Centralized logging and analysis.</p>
<h3 id="f-protect-against-sql-injection">f. Protect Against SQL Injection</h3>
<p><strong>Best Practices:</strong>
- <strong>Use Parameterized Queries:</strong> Avoid constructing queries with string concatenation.</p>
<p><strong>Example in psql:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-85-1">1</a></span>
<span class="normal"><a href="#__codelineno-85-2">2</a></span>
<span class="normal"><a href="#__codelineno-85-3">3</a></span>
<span class="normal"><a href="#__codelineno-85-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-85-1" name="__codelineno-85-1"></a><span class="k">PREPARE</span><span class="w"> </span><span class="n">stmt</span><span class="p">(</span><span class="nb">text</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span>
<a id="__codelineno-85-2" name="__codelineno-85-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">$</span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-85-3" name="__codelineno-85-3"></a>
<a id="__codelineno-85-4" name="__codelineno-85-4"></a><span class="k">EXECUTE</span><span class="w"> </span><span class="n">stmt</span><span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<ul>
<li><strong>Validate and Sanitize Inputs:</strong> Ensure all user inputs are validated before use.</li>
</ul>
<h3 id="g-implement-role-separation">g. Implement Role Separation</h3>
<p><strong>Description:</strong> Separate roles for different functionalities (e.g., read-only roles, admin roles).</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-86-1">1</a></span>
<span class="normal"><a href="#__codelineno-86-2">2</a></span>
<span class="normal"><a href="#__codelineno-86-3">3</a></span>
<span class="normal"><a href="#__codelineno-86-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-86-1" name="__codelineno-86-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">ROLE</span><span class="w"> </span><span class="n">readonly_user</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">LOGIN</span><span class="w"> </span><span class="n">PASSWORD</span><span class="w"> </span><span class="s1">&#39;readonlypassword&#39;</span><span class="p">;</span>
<a id="__codelineno-86-2" name="__codelineno-86-2"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">CONNECT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">mydatabase</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">readonly_user</span><span class="p">;</span>
<a id="__codelineno-86-3" name="__codelineno-86-3"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">USAGE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">readonly_user</span><span class="p">;</span>
<a id="__codelineno-86-4" name="__codelineno-86-4"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="n">TABLES</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">readonly_user</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<hr />
<h2 id="9-monitoring-and-maintenance">9. Monitoring and Maintenance</h2>
<p>Continuous monitoring and regular maintenance are essential for optimal PostgreSQL performance and reliability.</p>
<h3 id="a-monitoring-tools">a. Monitoring Tools</h3>
<p><strong>i. pg_stat_statements</strong></p>
<p><strong>Description:</strong> Tracks execution statistics of all SQL statements.</p>
<p><strong>Installation:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-87-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-87-1" name="__codelineno-87-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">EXTENSION</span><span class="w"> </span><span class="n">pg_stat_statements</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Configuration:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-88-1">1</a></span>
<span class="normal"><a href="#__codelineno-88-2">2</a></span>
<span class="normal"><a href="#__codelineno-88-3">3</a></span>
<span class="normal"><a href="#__codelineno-88-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-88-1" name="__codelineno-88-1"></a># postgresql.conf
<a id="__codelineno-88-2" name="__codelineno-88-2"></a>shared_preload_libraries = &#39;pg_stat_statements&#39;
<a id="__codelineno-88-3" name="__codelineno-88-3"></a>pg_stat_statements.max = 5000
<a id="__codelineno-88-4" name="__codelineno-88-4"></a>pg_stat_statements.track = all
</code></pre></div></td></tr></table></div></p>
<p><strong>Usage:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-89-1">1</a></span>
<span class="normal"><a href="#__codelineno-89-2">2</a></span>
<span class="normal"><a href="#__codelineno-89-3">3</a></span>
<span class="normal"><a href="#__codelineno-89-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-89-1" name="__codelineno-89-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">query</span><span class="p">,</span><span class="w"> </span><span class="n">calls</span><span class="p">,</span><span class="w"> </span><span class="n">total_time</span><span class="p">,</span><span class="w"> </span><span class="n">mean_time</span>
<a id="__codelineno-89-2" name="__codelineno-89-2"></a><span class="k">FROM</span><span class="w"> </span><span class="n">pg_stat_statements</span>
<a id="__codelineno-89-3" name="__codelineno-89-3"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">total_time</span><span class="w"> </span><span class="k">DESC</span>
<a id="__codelineno-89-4" name="__codelineno-89-4"></a><span class="k">LIMIT</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>ii. Prometheus and Grafana</strong></p>
<p><strong>Description:</strong> Use exporters like <code>postgres_exporter</code> to collect metrics.</p>
<p><strong>Installation:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-90-1">1</a></span>
<span class="normal"><a href="#__codelineno-90-2">2</a></span>
<span class="normal"><a href="#__codelineno-90-3">3</a></span>
<span class="normal"><a href="#__codelineno-90-4">4</a></span>
<span class="normal"><a href="#__codelineno-90-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-90-1" name="__codelineno-90-1"></a><span class="c1"># Clone and build</span>
<a id="__codelineno-90-2" name="__codelineno-90-2"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/prometheus-community/postgres_exporter.git
<a id="__codelineno-90-3" name="__codelineno-90-3"></a><span class="nb">cd</span><span class="w"> </span>postgres_exporter
<a id="__codelineno-90-4" name="__codelineno-90-4"></a>make
<a id="__codelineno-90-5" name="__codelineno-90-5"></a>sudo<span class="w"> </span>make<span class="w"> </span>install
</code></pre></div></td></tr></table></div></p>
<p><strong>Configuration:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-91-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-91-1" name="__codelineno-91-1"></a>postgres_exporter<span class="w"> </span>--extend.query-path<span class="o">=</span>/path/to/queries.yaml
</code></pre></div></td></tr></table></div></p>
<p><strong>Grafana Dashboard:</strong>
Import pre-built PostgreSQL dashboards for visualization.</p>
<p><strong>iii. pgBadger</strong></p>
<p><strong>Description:</strong> Log analyzer for PostgreSQL, generating detailed reports.</p>
<p><strong>Installation:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-92-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-92-1" name="__codelineno-92-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>pgbadger
</code></pre></div></td></tr></table></div></p>
<p><strong>Usage:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-93-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-93-1" name="__codelineno-93-1"></a>pgbadger<span class="w"> </span>/var/lib/postgresql/data/log/postgresql-*.log<span class="w"> </span>-o<span class="w"> </span>report.html
</code></pre></div></td></tr></table></div></p>
<h3 id="b-automated-maintenance-tasks">b. Automated Maintenance Tasks</h3>
<p><strong>i. Vacuuming</strong></p>
<ul>
<li><strong>Purpose:</strong> Reclaim storage and update table statistics.</li>
<li><strong>Commands:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-94-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-94-1" name="__codelineno-94-1"></a><span class="k">VACUUM</span><span class="w"> </span><span class="k">ANALYZE</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></li>
</ul>
<p><strong>ii. Reindexing</strong></p>
<ul>
<li><strong>Purpose:</strong> Rebuild corrupted or bloated indexes.</li>
<li><strong>Commands:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-95-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-95-1" name="__codelineno-95-1"></a><span class="k">REINDEX</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">mydatabase</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></li>
</ul>
<p><strong>iii. Analyzing</strong></p>
<ul>
<li><strong>Purpose:</strong> Update statistics for the query planner.</li>
<li><strong>Commands:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-96-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-96-1" name="__codelineno-96-1"></a><span class="k">ANALYZE</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></li>
</ul>
<p><strong>iv. Regular Updates</strong></p>
<ul>
<li><strong>Description:</strong> Keep PostgreSQL and its extensions up-to-date to benefit from security patches and performance improvements.</li>
<li><strong>Commands:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-97-1">1</a></span>
<span class="normal"><a href="#__codelineno-97-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-97-1" name="__codelineno-97-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>update
<a id="__codelineno-97-2" name="__codelineno-97-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>upgrade<span class="w"> </span>postgresql
</code></pre></div></td></tr></table></div></li>
</ul>
<h3 id="c-alerting">c. Alerting</h3>
<p><strong>i. Set Up Alerts for Critical Metrics:</strong>
- <strong>Examples:</strong>
  - High CPU or memory usage.
  - Replication lag exceeding thresholds.
  - Disk space running low.
  - Query performance degradation.</p>
<p><strong>ii. Using Prometheus Alertmanager:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-98-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-98-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-98-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-98-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-98-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-98-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-98-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-98-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-98-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-98-10">10</a></span>
<span class="normal"><a href="#__codelineno-98-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-98-1" name="__codelineno-98-1"></a><span class="nt">groups</span><span class="p">:</span>
<a id="__codelineno-98-2" name="__codelineno-98-2"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres_alerts</span>
<a id="__codelineno-98-3" name="__codelineno-98-3"></a><span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<a id="__codelineno-98-4" name="__codelineno-98-4"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">alert</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HighReplicationLag</span>
<a id="__codelineno-98-5" name="__codelineno-98-5"></a><span class="w">    </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pg_stat_replication_lag &gt; 1000</span>
<a id="__codelineno-98-6" name="__codelineno-98-6"></a><span class="w">    </span><span class="nt">for</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5m</span>
<a id="__codelineno-98-7" name="__codelineno-98-7"></a><span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-98-8" name="__codelineno-98-8"></a><span class="w">      </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">critical</span>
<a id="__codelineno-98-9" name="__codelineno-98-9"></a><span class="w">    </span><span class="nt">annotations</span><span class="p">:</span>
<a id="__codelineno-98-10" name="__codelineno-98-10"></a><span class="w">      </span><span class="nt">summary</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Replication</span><span class="nv"> </span><span class="s">lag</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">high&quot;</span>
<a id="__codelineno-98-11" name="__codelineno-98-11"></a><span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Replication</span><span class="nv"> </span><span class="s">lag</span><span class="nv"> </span><span class="s">has</span><span class="nv"> </span><span class="s">exceeded</span><span class="nv"> </span><span class="s">1000ms</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">more</span><span class="nv"> </span><span class="s">than</span><span class="nv"> </span><span class="s">5</span><span class="nv"> </span><span class="s">minutes.&quot;</span>
</code></pre></div></td></tr></table></div></p>
<hr />
<h2 id="10-latest-features-in-postgresql-16">10. Latest Features in PostgreSQL 16</h2>
<p>PostgreSQL 16 introduces several enhancements and new features aimed at improving performance, usability, and extensibility.</p>
<h3 id="a-enhanced-json-and-jsonb-support">a. Enhanced JSON and JSONB Support</h3>
<ul>
<li><strong>JSON Table Functions:</strong> Simplify the extraction and transformation of JSON data into tabular formats.</li>
</ul>
<p><strong>Example:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-99-1">1</a></span>
<span class="normal"><a href="#__codelineno-99-2">2</a></span>
<span class="normal"><a href="#__codelineno-99-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-99-1" name="__codelineno-99-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<a id="__codelineno-99-2" name="__codelineno-99-2"></a><span class="k">FROM</span><span class="w"> </span><span class="n">json_to_recordset</span><span class="p">(</span><span class="s1">&#39;[{&quot;a&quot;:1,&quot;b&quot;:&quot;x&quot;}, {&quot;a&quot;:2,&quot;b&quot;:&quot;y&quot;}]&#39;</span><span class="p">)</span><span class="w"> </span>
<a id="__codelineno-99-3" name="__codelineno-99-3"></a><span class="k">AS</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="nb">text</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="b-improved-query-parallelism">b. Improved Query Parallelism</h3>
<ul>
<li><strong>Enhanced Parallelism for More Operations:</strong> PostgreSQL 16 extends parallel query capabilities to include more functions and operations, reducing query execution time for complex tasks.</li>
</ul>
<h3 id="c-native-merge-statement">c. Native MERGE Statement</h3>
<ul>
<li><strong>Description:</strong> Introduces the SQL-standard <code>MERGE</code> statement, allowing conditional insert/update/delete operations in a single command.</li>
</ul>
<p><strong>Example:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-100-1">1</a></span>
<span class="normal"><a href="#__codelineno-100-2">2</a></span>
<span class="normal"><a href="#__codelineno-100-3">3</a></span>
<span class="normal"><a href="#__codelineno-100-4">4</a></span>
<span class="normal"><a href="#__codelineno-100-5">5</a></span>
<span class="normal"><a href="#__codelineno-100-6">6</a></span>
<span class="normal"><a href="#__codelineno-100-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-100-1" name="__codelineno-100-1"></a><span class="n">MERGE</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">employees</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">target</span>
<a id="__codelineno-100-2" name="__codelineno-100-2"></a><span class="k">USING</span><span class="w"> </span><span class="n">new_employees</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">source</span>
<a id="__codelineno-100-3" name="__codelineno-100-3"></a><span class="k">ON</span><span class="w"> </span><span class="n">target</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">source</span><span class="p">.</span><span class="n">id</span>
<a id="__codelineno-100-4" name="__codelineno-100-4"></a><span class="k">WHEN</span><span class="w"> </span><span class="n">MATCHED</span><span class="w"> </span><span class="k">THEN</span>
<a id="__codelineno-100-5" name="__codelineno-100-5"></a><span class="w">  </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">source</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">department</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">source</span><span class="p">.</span><span class="n">department</span>
<a id="__codelineno-100-6" name="__codelineno-100-6"></a><span class="k">WHEN</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="n">MATCHED</span><span class="w"> </span><span class="k">THEN</span>
<a id="__codelineno-100-7" name="__codelineno-100-7"></a><span class="w">  </span><span class="k">INSERT</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">department</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">source</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="k">source</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="k">source</span><span class="p">.</span><span class="n">department</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="d-stored-procedures-enhancements">d. Stored Procedures Enhancements</h3>
<ul>
<li><strong>Transaction Control within Procedures:</strong> Enhanced capabilities for managing transactions within stored procedures, allowing more granular control.</li>
</ul>
<h3 id="e-incremental-sorting">e. Incremental Sorting</h3>
<ul>
<li><strong>Description:</strong> Allows PostgreSQL to perform incremental sorts, improving performance for queries that require ordered results with partial ordering.</li>
</ul>
<h3 id="f-improved-logical-replication">f. Improved Logical Replication</h3>
<ul>
<li><strong>Row Filtering and Transformation:</strong> Offers more advanced options for filtering and transforming replicated data, enhancing flexibility in replication setups.</li>
</ul>
<h3 id="g-columnar-storage-improvements">g. Columnar Storage Improvements</h3>
<ul>
<li><strong>Performance Enhancements:</strong> Further optimizes columnar storage mechanisms, boosting performance for analytical workloads.</li>
</ul>
<h3 id="h-security-enhancements">h. Security Enhancements</h3>
<ul>
<li><strong>SCRAM Authentication Improvements:</strong> Enhancements to SCRAM (Salted Challenge Response Authentication Mechanism) for better security.</li>
<li><strong>Row-Level Security Enhancements:</strong> Expanded capabilities for implementing fine-grained access controls.</li>
</ul>
<h3 id="i-monitoring-and-diagnostics">i. Monitoring and Diagnostics</h3>
<ul>
<li><strong>New System Views and Functions:</strong> Additional tools for monitoring database performance and diagnosing issues.</li>
</ul>
<p><strong>Example:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-101-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-101-1" name="__codelineno-101-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">pg_stat_activity</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="k">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;active&#39;</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<hr />
<h2 id="11-scaling-postgresql">11. Scaling PostgreSQL</h2>
<p>Scaling PostgreSQL effectively involves both vertical and horizontal strategies to handle increased loads and data volumes.</p>
<h3 id="a-vertical-scaling">a. Vertical Scaling</h3>
<p><strong>Description:</strong> Enhancing the capabilities of a single PostgreSQL server by adding more CPU, memory, and storage resources.</p>
<p><strong>Pros:</strong>
- Simpler to implement.
- No changes to application architecture.</p>
<p><strong>Cons:</strong>
- Limited by hardware capabilities.
- Can be cost-prohibitive at scale.</p>
<h3 id="b-horizontal-scaling">b. Horizontal Scaling</h3>
<p><strong>Description:</strong> Distributing the database load across multiple servers.</p>
<h4 id="i-replication">i. Replication</h4>
<ul>
<li>
<p><strong>Streaming Replication:</strong> Real-time data replication from primary to standby servers.</p>
</li>
<li>
<p><strong>Logical Replication:</strong> Replicates specific tables or subsets of data, allowing for more flexibility.</p>
</li>
</ul>
<h4 id="ii-sharding">ii. Sharding</h4>
<ul>
<li>
<p><strong>Description:</strong> Divides the database into smaller, more manageable pieces called shards, each hosted on separate servers.</p>
</li>
<li>
<p><strong>Implementation Strategies:</strong></p>
</li>
<li><strong>Application-Level Sharding:</strong> The application directs queries to the appropriate shard based on a sharding key.</li>
<li><strong>Using Extensions like Citus:</strong> Transforms PostgreSQL into a distributed database, handling sharding transparently.</li>
</ul>
<p><strong>Example Using Citus:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-102-1">1</a></span>
<span class="normal"><a href="#__codelineno-102-2">2</a></span>
<span class="normal"><a href="#__codelineno-102-3">3</a></span>
<span class="normal"><a href="#__codelineno-102-4">4</a></span>
<span class="normal"><a href="#__codelineno-102-5">5</a></span>
<span class="normal"><a href="#__codelineno-102-6">6</a></span>
<span class="normal"><a href="#__codelineno-102-7">7</a></span>
<span class="normal"><a href="#__codelineno-102-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-102-1" name="__codelineno-102-1"></a><span class="c1"># Install Citus</span>
<a id="__codelineno-102-2" name="__codelineno-102-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>postgresql-16-citus-12.3
<a id="__codelineno-102-3" name="__codelineno-102-3"></a>
<a id="__codelineno-102-4" name="__codelineno-102-4"></a><span class="c1"># Configure Citus in postgresql.conf</span>
<a id="__codelineno-102-5" name="__codelineno-102-5"></a><span class="nv">shared_preload_libraries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;citus&#39;</span>
<a id="__codelineno-102-6" name="__codelineno-102-6"></a>
<a id="__codelineno-102-7" name="__codelineno-102-7"></a><span class="c1"># Restart PostgreSQL</span>
<a id="__codelineno-102-8" name="__codelineno-102-8"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>postgresql
</code></pre></div></td></tr></table></div></p>
<p><strong>Creating a Distributed Table:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-103-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-103-1" name="__codelineno-103-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">create_distributed_table</span><span class="p">(</span><span class="s1">&#39;orders&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;order_id&#39;</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="c-connection-pooling">c. Connection Pooling</h3>
<p><strong>Description:</strong> Manages database connections efficiently to handle high traffic and reduce overhead.</p>
<p><strong>Using PgBouncer:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-104-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-104-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-104-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-104-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-104-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-104-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-104-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-104-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-104-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-104-10">10</a></span>
<span class="normal"><a href="#__codelineno-104-11">11</a></span>
<span class="normal"><a href="#__codelineno-104-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-104-1" name="__codelineno-104-1"></a><span class="c1"># /etc/pgbouncer/pgbouncer.ini</span>
<a id="__codelineno-104-2" name="__codelineno-104-2"></a><span class="k">[databases]</span>
<a id="__codelineno-104-3" name="__codelineno-104-3"></a><span class="na">mydb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">host=localhost port=5432 dbname=mydb</span>
<a id="__codelineno-104-4" name="__codelineno-104-4"></a>
<a id="__codelineno-104-5" name="__codelineno-104-5"></a><span class="k">[pgbouncer]</span>
<a id="__codelineno-104-6" name="__codelineno-104-6"></a><span class="na">listen_addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">127.0.0.1</span>
<a id="__codelineno-104-7" name="__codelineno-104-7"></a><span class="na">listen_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">6432</span>
<a id="__codelineno-104-8" name="__codelineno-104-8"></a><span class="na">auth_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">md5</span>
<a id="__codelineno-104-9" name="__codelineno-104-9"></a><span class="na">auth_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/etc/pgbouncer/userlist.txt</span>
<a id="__codelineno-104-10" name="__codelineno-104-10"></a><span class="na">pool_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">transaction</span>
<a id="__codelineno-104-11" name="__codelineno-104-11"></a><span class="na">max_client_conn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">200</span>
<a id="__codelineno-104-12" name="__codelineno-104-12"></a><span class="na">default_pool_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">50</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Django Configuration:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-105-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-105-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-105-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-105-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-105-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-105-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-105-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-105-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-105-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-105-10">10</a></span>
<span class="normal"><a href="#__codelineno-105-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-105-1" name="__codelineno-105-1"></a># Adjust connection settings to point to PgBouncer
<a id="__codelineno-105-2" name="__codelineno-105-2"></a>DATABASES = {
<a id="__codelineno-105-3" name="__codelineno-105-3"></a>    &#39;default&#39;: {
<a id="__codelineno-105-4" name="__codelineno-105-4"></a>        &#39;ENGINE&#39;: &#39;django.db.backends.postgresql&#39;,
<a id="__codelineno-105-5" name="__codelineno-105-5"></a>        &#39;NAME&#39;: &#39;mydb&#39;,
<a id="__codelineno-105-6" name="__codelineno-105-6"></a>        &#39;USER&#39;: &#39;myuser&#39;,
<a id="__codelineno-105-7" name="__codelineno-105-7"></a>        &#39;PASSWORD&#39;: &#39;mypassword&#39;,
<a id="__codelineno-105-8" name="__codelineno-105-8"></a>        &#39;HOST&#39;: &#39;127.0.0.1&#39;,
<a id="__codelineno-105-9" name="__codelineno-105-9"></a>        &#39;PORT&#39;: &#39;6432&#39;,
<a id="__codelineno-105-10" name="__codelineno-105-10"></a>    }
<a id="__codelineno-105-11" name="__codelineno-105-11"></a>}
</code></pre></div></td></tr></table></div></p>
<h3 id="d-load-balancing">d. Load Balancing</h3>
<p><strong>Description:</strong> Distributes incoming database requests across multiple servers to optimize resource use and minimize response times.</p>
<p><strong>Tools and Techniques:</strong>
- <strong>Pgpool-II:</strong> Middleware that provides connection pooling, load balancing, and replication.</p>
<p><strong>Installation:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-106-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-106-1" name="__codelineno-106-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>pgpool2
</code></pre></div></td></tr></table></div></p>
<p><strong>Basic Configuration:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-107-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-107-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-107-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-107-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-107-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-107-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-107-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-107-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-107-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-107-10">10</a></span>
<span class="normal"><a href="#__codelineno-107-11">11</a></span>
<span class="normal"><a href="#__codelineno-107-12">12</a></span>
<span class="normal"><a href="#__codelineno-107-13">13</a></span>
<span class="normal"><a href="#__codelineno-107-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-107-1" name="__codelineno-107-1"></a># /etc/pgpool2/pgpool.conf
<a id="__codelineno-107-2" name="__codelineno-107-2"></a>listen_addresses = &#39;*&#39;
<a id="__codelineno-107-3" name="__codelineno-107-3"></a>port = 9999
<a id="__codelineno-107-4" name="__codelineno-107-4"></a>backend_hostname0 = &#39;primary_host&#39;
<a id="__codelineno-107-5" name="__codelineno-107-5"></a>backend_port0 = 5432
<a id="__codelineno-107-6" name="__codelineno-107-6"></a>backend_weight0 = 1
<a id="__codelineno-107-7" name="__codelineno-107-7"></a>backend_data_directory0 = &#39;/var/lib/postgresql/16/main&#39;
<a id="__codelineno-107-8" name="__codelineno-107-8"></a>
<a id="__codelineno-107-9" name="__codelineno-107-9"></a>backend_hostname1 = &#39;replica_host&#39;
<a id="__codelineno-107-10" name="__codelineno-107-10"></a>backend_port1 = 5432
<a id="__codelineno-107-11" name="__codelineno-107-11"></a>backend_weight1 = 1
<a id="__codelineno-107-12" name="__codelineno-107-12"></a>backend_data_directory1 = &#39;/var/lib/postgresql/16/main&#39;
<a id="__codelineno-107-13" name="__codelineno-107-13"></a>
<a id="__codelineno-107-14" name="__codelineno-107-14"></a>load_balance_mode = on
</code></pre></div></td></tr></table></div></p>
<ul>
<li><strong>HAProxy:</strong> General-purpose load balancer that can be configured to distribute PostgreSQL traffic.</li>
</ul>
<p><strong>Basic Configuration:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-108-1">1</a></span>
<span class="normal"><a href="#__codelineno-108-2">2</a></span>
<span class="normal"><a href="#__codelineno-108-3">3</a></span>
<span class="normal"><a href="#__codelineno-108-4">4</a></span>
<span class="normal"><a href="#__codelineno-108-5">5</a></span>
<span class="normal"><a href="#__codelineno-108-6">6</a></span>
<span class="normal"><a href="#__codelineno-108-7">7</a></span>
<span class="normal"><a href="#__codelineno-108-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-108-1" name="__codelineno-108-1"></a>frontend postgres_front
<a id="__codelineno-108-2" name="__codelineno-108-2"></a>    bind *:5432
<a id="__codelineno-108-3" name="__codelineno-108-3"></a>    default_backend postgres_back
<a id="__codelineno-108-4" name="__codelineno-108-4"></a>
<a id="__codelineno-108-5" name="__codelineno-108-5"></a>backend postgres_back
<a id="__codelineno-108-6" name="__codelineno-108-6"></a>    balance roundrobin
<a id="__codelineno-108-7" name="__codelineno-108-7"></a>    server primary primary_host:5432 check
<a id="__codelineno-108-8" name="__codelineno-108-8"></a>    server replica replica_host:5432 check backup
</code></pre></div></td></tr></table></div></p>
<hr />
<h2 id="12-advanced-data-modeling">12. Advanced Data Modeling</h2>
<p>Effective data modeling ensures data integrity, optimizes performance, and facilitates scalability.</p>
<h3 id="a-normalization-vs-denormalization">a. Normalization vs. Denormalization</h3>
<ul>
<li><strong>Normalization:</strong> Organize data to reduce redundancy and improve data integrity.</li>
</ul>
<p><strong>Pros:</strong>
  - Eliminates data anomalies.
  - Simplifies updates and maintenance.</p>
<p><strong>Cons:</strong>
  - Can lead to complex queries and joins.
  - Potential performance overhead.</p>
<ul>
<li><strong>Denormalization:</strong> Introduce redundancy to optimize read performance.</li>
</ul>
<p><strong>Pros:</strong>
  - Simplifies queries.
  - Enhances read performance.</p>
<p><strong>Cons:</strong>
  - Increases complexity in data maintenance.
  - Risk of data inconsistencies.</p>
<p><strong>Best Practice:</strong> Strike a balance based on application requirements, using normalization for data integrity and selective denormalization for performance-critical paths.</p>
<h3 id="b-recursive-relationships">b. Recursive Relationships</h3>
<p><strong>Description:</strong> Model hierarchical data structures like organizational charts or category trees.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-109-1">1</a></span>
<span class="normal"><a href="#__codelineno-109-2">2</a></span>
<span class="normal"><a href="#__codelineno-109-3">3</a></span>
<span class="normal"><a href="#__codelineno-109-4">4</a></span>
<span class="normal"><a href="#__codelineno-109-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-109-1" name="__codelineno-109-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">categories</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-109-2" name="__codelineno-109-2"></a><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<a id="__codelineno-109-3" name="__codelineno-109-3"></a><span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<a id="__codelineno-109-4" name="__codelineno-109-4"></a><span class="w">    </span><span class="n">parent_id</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">categories</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span>
<a id="__codelineno-109-5" name="__codelineno-109-5"></a><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Querying Hierarchical Data:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-110-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-110-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-110-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-110-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-110-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-110-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-110-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-110-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-110-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-110-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-110-1" name="__codelineno-110-1"></a><span class="k">WITH</span><span class="w"> </span><span class="k">RECURSIVE</span><span class="w"> </span><span class="n">category_tree</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-110-2" name="__codelineno-110-2"></a><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">parent_id</span>
<a id="__codelineno-110-3" name="__codelineno-110-3"></a><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">categories</span>
<a id="__codelineno-110-4" name="__codelineno-110-4"></a><span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">parent_id</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NULL</span>
<a id="__codelineno-110-5" name="__codelineno-110-5"></a><span class="w">    </span><span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span>
<a id="__codelineno-110-6" name="__codelineno-110-6"></a><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">parent_id</span>
<a id="__codelineno-110-7" name="__codelineno-110-7"></a><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">categories</span><span class="w"> </span><span class="k">c</span>
<a id="__codelineno-110-8" name="__codelineno-110-8"></a><span class="w">    </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">category_tree</span><span class="w"> </span><span class="n">ct</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">ct</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">parent_id</span>
<a id="__codelineno-110-9" name="__codelineno-110-9"></a><span class="p">)</span>
<a id="__codelineno-110-10" name="__codelineno-110-10"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">category_tree</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="c-polymorphic-associations">c. Polymorphic Associations</h3>
<p><strong>Description:</strong> Allow a table to reference multiple other tables using a single foreign key.</p>
<p><strong>Implementation Strategies:</strong>
- <strong>Single Table Inheritance:</strong> All related entities are stored in a single table with nullable columns.</p>
<ul>
<li>
<p><strong>Class Table Inheritance:</strong> Separate tables for each entity type with foreign keys pointing to a base table.</p>
</li>
<li>
<p><strong>Use of Foreign Data Wrappers (FDW):</strong> Reference external tables as needed.</p>
</li>
</ul>
<p><strong>Example Using Class Table Inheritance:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-111-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-111-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-111-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-111-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-111-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-111-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-111-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-111-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-111-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-111-10">10</a></span>
<span class="normal"><a href="#__codelineno-111-11">11</a></span>
<span class="normal"><a href="#__codelineno-111-12">12</a></span>
<span class="normal"><a href="#__codelineno-111-13">13</a></span>
<span class="normal"><a href="#__codelineno-111-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-111-1" name="__codelineno-111-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">media</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-111-2" name="__codelineno-111-2"></a><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<a id="__codelineno-111-3" name="__codelineno-111-3"></a><span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span>
<a id="__codelineno-111-4" name="__codelineno-111-4"></a><span class="p">);</span>
<a id="__codelineno-111-5" name="__codelineno-111-5"></a>
<a id="__codelineno-111-6" name="__codelineno-111-6"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">images</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-111-7" name="__codelineno-111-7"></a><span class="w">    </span><span class="n">media_id</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">media</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span><span class="p">,</span>
<a id="__codelineno-111-8" name="__codelineno-111-8"></a><span class="w">    </span><span class="n">resolution</span><span class="w"> </span><span class="nb">TEXT</span>
<a id="__codelineno-111-9" name="__codelineno-111-9"></a><span class="p">);</span>
<a id="__codelineno-111-10" name="__codelineno-111-10"></a>
<a id="__codelineno-111-11" name="__codelineno-111-11"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">videos</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-111-12" name="__codelineno-111-12"></a><span class="w">    </span><span class="n">media_id</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">media</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span><span class="p">,</span>
<a id="__codelineno-111-13" name="__codelineno-111-13"></a><span class="w">    </span><span class="n">duration</span><span class="w"> </span><span class="nb">INTEGER</span>
<a id="__codelineno-111-14" name="__codelineno-111-14"></a><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Querying Polymorphic Data:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-112-1">1</a></span>
<span class="normal"><a href="#__codelineno-112-2">2</a></span>
<span class="normal"><a href="#__codelineno-112-3">3</a></span>
<span class="normal"><a href="#__codelineno-112-4">4</a></span>
<span class="normal"><a href="#__codelineno-112-5">5</a></span>
<span class="normal"><a href="#__codelineno-112-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-112-1" name="__codelineno-112-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="k">type</span><span class="p">,</span>
<a id="__codelineno-112-2" name="__codelineno-112-2"></a><span class="w">       </span><span class="n">i</span><span class="p">.</span><span class="n">resolution</span><span class="p">,</span>
<a id="__codelineno-112-3" name="__codelineno-112-3"></a><span class="w">       </span><span class="n">v</span><span class="p">.</span><span class="n">duration</span>
<a id="__codelineno-112-4" name="__codelineno-112-4"></a><span class="k">FROM</span><span class="w"> </span><span class="n">media</span><span class="w"> </span><span class="n">m</span>
<a id="__codelineno-112-5" name="__codelineno-112-5"></a><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">images</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">.</span><span class="n">media_id</span>
<a id="__codelineno-112-6" name="__codelineno-112-6"></a><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">videos</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">media_id</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="d-inheritance-with-extensions">d. Inheritance with Extensions</h3>
<p><strong>Using <code>table inheritance</code></strong> can model complex relationships but may introduce challenges in query planning and maintenance. Use extensions like <code>pg_partman</code> for advanced partitioning needs.</p>
<hr />
<h2 id="13-custom-functions-and-stored-procedures">13. Custom Functions and Stored Procedures</h2>
<p>Enhance PostgreSQL's capabilities by creating custom functions and stored procedures.</p>
<h3 id="a-creating-custom-functions">a. Creating Custom Functions</h3>
<p><strong>Example: Calculating Discounted Price</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-113-1">1</a></span>
<span class="normal"><a href="#__codelineno-113-2">2</a></span>
<span class="normal"><a href="#__codelineno-113-3">3</a></span>
<span class="normal"><a href="#__codelineno-113-4">4</a></span>
<span class="normal"><a href="#__codelineno-113-5">5</a></span>
<span class="normal"><a href="#__codelineno-113-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-113-1" name="__codelineno-113-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">calculate_discount</span><span class="p">(</span><span class="n">price</span><span class="w"> </span><span class="nb">NUMERIC</span><span class="p">,</span><span class="w"> </span><span class="n">discount</span><span class="w"> </span><span class="nb">NUMERIC</span><span class="p">)</span>
<a id="__codelineno-113-2" name="__codelineno-113-2"></a><span class="k">RETURNS</span><span class="w"> </span><span class="nb">NUMERIC</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$$</span>
<a id="__codelineno-113-3" name="__codelineno-113-3"></a><span class="k">BEGIN</span>
<a id="__codelineno-113-4" name="__codelineno-113-4"></a><span class="w">    </span><span class="k">RETURN</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">discount</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">100</span><span class="p">);</span>
<a id="__codelineno-113-5" name="__codelineno-113-5"></a><span class="k">END</span><span class="p">;</span>
<a id="__codelineno-113-6" name="__codelineno-113-6"></a><span class="err">$$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Usage:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-114-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-114-1" name="__codelineno-114-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">calculate_discount</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">);</span><span class="w">  </span><span class="c1">-- Returns 85</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="b-stored-procedures-with-transaction-control">b. Stored Procedures with Transaction Control</h3>
<p><strong>Description:</strong> Introduced in PostgreSQL 11, stored procedures allow explicit transaction control using <code>CALL</code>.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-115-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-115-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-115-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-115-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-115-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-115-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-115-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-115-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-115-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-115-10">10</a></span>
<span class="normal"><a href="#__codelineno-115-11">11</a></span>
<span class="normal"><a href="#__codelineno-115-12">12</a></span>
<span class="normal"><a href="#__codelineno-115-13">13</a></span>
<span class="normal"><a href="#__codelineno-115-14">14</a></span>
<span class="normal"><a href="#__codelineno-115-15">15</a></span>
<span class="normal"><a href="#__codelineno-115-16">16</a></span>
<span class="normal"><a href="#__codelineno-115-17">17</a></span>
<span class="normal"><a href="#__codelineno-115-18">18</a></span>
<span class="normal"><a href="#__codelineno-115-19">19</a></span>
<span class="normal"><a href="#__codelineno-115-20">20</a></span>
<span class="normal"><a href="#__codelineno-115-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-115-1" name="__codelineno-115-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">PROCEDURE</span><span class="w"> </span><span class="n">transfer_funds</span><span class="p">(</span><span class="n">from_account</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="n">to_account</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="nb">NUMERIC</span><span class="p">)</span>
<a id="__codelineno-115-2" name="__codelineno-115-2"></a><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$$</span>
<a id="__codelineno-115-3" name="__codelineno-115-3"></a><span class="k">BEGIN</span>
<a id="__codelineno-115-4" name="__codelineno-115-4"></a><span class="w">    </span><span class="k">BEGIN</span>
<a id="__codelineno-115-5" name="__codelineno-115-5"></a><span class="w">        </span><span class="k">UPDATE</span><span class="w"> </span><span class="n">accounts</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">from_account</span><span class="p">;</span>
<a id="__codelineno-115-6" name="__codelineno-115-6"></a><span class="w">        </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">FOUND</span><span class="w"> </span><span class="k">THEN</span>
<a id="__codelineno-115-7" name="__codelineno-115-7"></a><span class="w">            </span><span class="n">RAISE</span><span class="w"> </span><span class="k">EXCEPTION</span><span class="w"> </span><span class="s1">&#39;From account not found&#39;</span><span class="p">;</span>
<a id="__codelineno-115-8" name="__codelineno-115-8"></a><span class="w">        </span><span class="k">END</span><span class="w"> </span><span class="k">IF</span><span class="p">;</span>
<a id="__codelineno-115-9" name="__codelineno-115-9"></a>
<a id="__codelineno-115-10" name="__codelineno-115-10"></a><span class="w">        </span><span class="k">UPDATE</span><span class="w"> </span><span class="n">accounts</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">to_account</span><span class="p">;</span>
<a id="__codelineno-115-11" name="__codelineno-115-11"></a><span class="w">        </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">FOUND</span><span class="w"> </span><span class="k">THEN</span>
<a id="__codelineno-115-12" name="__codelineno-115-12"></a><span class="w">            </span><span class="n">RAISE</span><span class="w"> </span><span class="k">EXCEPTION</span><span class="w"> </span><span class="s1">&#39;To account not found&#39;</span><span class="p">;</span>
<a id="__codelineno-115-13" name="__codelineno-115-13"></a><span class="w">        </span><span class="k">END</span><span class="w"> </span><span class="k">IF</span><span class="p">;</span>
<a id="__codelineno-115-14" name="__codelineno-115-14"></a>
<a id="__codelineno-115-15" name="__codelineno-115-15"></a><span class="w">        </span><span class="k">COMMIT</span><span class="p">;</span>
<a id="__codelineno-115-16" name="__codelineno-115-16"></a><span class="w">    </span><span class="k">EXCEPTION</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="n">OTHERS</span><span class="w"> </span><span class="k">THEN</span>
<a id="__codelineno-115-17" name="__codelineno-115-17"></a><span class="w">        </span><span class="k">ROLLBACK</span><span class="p">;</span>
<a id="__codelineno-115-18" name="__codelineno-115-18"></a><span class="w">        </span><span class="n">RAISE</span><span class="p">;</span>
<a id="__codelineno-115-19" name="__codelineno-115-19"></a><span class="w">    </span><span class="k">END</span><span class="p">;</span>
<a id="__codelineno-115-20" name="__codelineno-115-20"></a><span class="k">END</span><span class="p">;</span>
<a id="__codelineno-115-21" name="__codelineno-115-21"></a><span class="err">$$</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Usage:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-116-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-116-1" name="__codelineno-116-1"></a><span class="k">CALL</span><span class="w"> </span><span class="n">transfer_funds</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="c-language-extensions">c. Language Extensions</h3>
<p><strong>Support for Multiple Languages:</strong> PostgreSQL allows writing functions in various languages like PL/pgSQL, PL/Python, PL/Perl, and more.</p>
<p><strong>Example Using PL/Python:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-117-1">1</a></span>
<span class="normal"><a href="#__codelineno-117-2">2</a></span>
<span class="normal"><a href="#__codelineno-117-3">3</a></span>
<span class="normal"><a href="#__codelineno-117-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-117-1" name="__codelineno-117-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">py_sum</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">)</span>
<a id="__codelineno-117-2" name="__codelineno-117-2"></a><span class="k">RETURNS</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$$</span>
<a id="__codelineno-117-3" name="__codelineno-117-3"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span>
<a id="__codelineno-117-4" name="__codelineno-117-4"></a><span class="err">$$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpythonu</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Usage:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-118-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-118-1" name="__codelineno-118-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">py_sum</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span><span class="w">  </span><span class="c1">-- Returns 15</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Security Considerations:</strong> Ensure that untrusted languages (e.g., PL/Python) are used cautiously to prevent security vulnerabilities.</p>
<hr />
<h2 id="14-best-practices-summary">14. Best Practices Summary</h2>
<ul>
<li><strong>Secure Configuration:</strong> Regularly update PostgreSQL, enforce SSL, and implement robust authentication methods.</li>
<li><strong>Efficient Indexing:</strong> Utilize appropriate index types, maintain indexes, and avoid over-indexing to optimize query performance.</li>
<li><strong>Optimized Query Design:</strong> Write efficient queries, leverage advanced SQL features, and regularly analyze query performance.</li>
<li><strong>Scalable Architecture:</strong> Implement replication, partitioning, and sharding strategies to handle growth and ensure high availability.</li>
<li><strong>Robust Backup Strategies:</strong> Combine logical and physical backups with PITR to safeguard data integrity and enable quick recovery.</li>
<li><strong>Comprehensive Monitoring:</strong> Use specialized tools to continuously monitor database performance, health, and security.</li>
<li><strong>Leverage Extensions:</strong> Enhance PostgreSQL's functionality with extensions like PostGIS, pg_trgm, hstore, and more.</li>
<li><strong>Maintain Data Integrity:</strong> Utilize constraints, triggers, and proper data modeling to ensure consistent and reliable data.</li>
<li><strong>Automate Maintenance:</strong> Schedule regular maintenance tasks like vacuuming, reindexing, and backups to maintain optimal performance.</li>
<li><strong>Document and Test:</strong> Maintain thorough documentation and regularly test backup restorations, failovers, and performance optimizations.</li>
</ul>
<p><strong>Conclusion:</strong></p>
<p>Mastering PostgreSQL involves a deep understanding of its advanced features, performance tuning techniques, and best practices for security and scalability. By implementing the strategies outlined in this guide, database administrators and developers can harness PostgreSQL's full potential, ensuring their systems are robust, efficient, and capable of meeting complex data management requirements.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>