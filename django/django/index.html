
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../system_design/prob/">
      
      
        <link rel="next" href="../../odoo/owl/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>tips - Elibrary</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1-django-orm-optimization-and-query-performance" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Elibrary" class="md-header__button md-logo" aria-label="Elibrary" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Elibrary
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              tips
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Elibrary" class="md-nav__button md-logo" aria-label="Elibrary" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Elibrary
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Classes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Classes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/classes/classes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/classes/data_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/classes/descriptors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Descriptors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/classes/iterators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Iterators
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/context_managers/context_managers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Context Managers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Data Types
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Data Types
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/data_types/data_types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/data_types/dic_set/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dict & Set
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/data_types/list_tuple/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List & Tuple
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/data_types/object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Object
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/decorators/decorators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Decorators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Modules
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/modules/builtins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Builtins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/modules/io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IO
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/modules/modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Structure
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            Structure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/structure/code_design/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code Design
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/structure/dessign_patterns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Design Patterns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/structure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/structure/practices/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Practices
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/structure/solid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SOLID
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/structure/structure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Structure
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8" >
        
          
          <label class="md-nav__link" for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Async
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            Async
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/async/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    asyncio
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/threading/threading/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Threading
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/talks/talks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    From Talks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/testing/test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/type_annotations/type.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Typing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Docker
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Docker
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/docker-compose/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker Compose
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Postgres
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Postgres
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../postgresql/tricks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Perfomance tricks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../postgresql/postgres/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Expert
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Git
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Git
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workflows
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Angular
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Angular
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../angular/rxjs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rxjs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../angular/tips/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tips
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../angular/expert/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Setups
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Setups
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setups/install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gitlab
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Kubernetes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Kubernetes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/backup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/deployments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deployments
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/image-security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Image Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/lifecycle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lifecycle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/maintanence/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maintenance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/monitoring/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Monitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/namespaces/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Namespaces
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/newtwork/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/pods/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pods
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/replicasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ReplicaSets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/roles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Roles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Services
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/sheduler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scheduler
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Programming
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Programming
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../programming/code_review/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code Review
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../programming/algorithms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Algorithms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../programming/ai/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../programming/orm_sql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ORM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/graph/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Graph
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../programming/questions.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Questions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    System Design
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            System Design
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system_design/design/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Design Patterns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system_design/prob/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Problems
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" checked>
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Django
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Django
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    tips
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    tips
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-preventing-the-n1-query-problem" class="md-nav__link">
    <span class="md-ellipsis">
      1. Preventing the N+1 Query Problem
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-utilizing-select_related" class="md-nav__link">
    <span class="md-ellipsis">
      2. Utilizing select_related
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-utilizing-prefetch_related" class="md-nav__link">
    <span class="md-ellipsis">
      3. Utilizing prefetch_related
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-combining-select_related-and-prefetch_related" class="md-nav__link">
    <span class="md-ellipsis">
      4. Combining select_related and prefetch_related
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-advanced-techniques" class="md-nav__link">
    <span class="md-ellipsis">
      5. Advanced Techniques
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Advanced Techniques">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-annotate-and-aggregate" class="md-nav__link">
    <span class="md-ellipsis">
      a. Annotate and Aggregate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-raw-sql-and-rawqueryset" class="md-nav__link">
    <span class="md-ellipsis">
      b. Raw SQL and RawQuerySet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-database-indexing" class="md-nav__link">
    <span class="md-ellipsis">
      c. Database Indexing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-query-optimization-with-defer-and-only" class="md-nav__link">
    <span class="md-ellipsis">
      d. Query Optimization with defer and only
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#e-using-values-and-values_list" class="md-nav__link">
    <span class="md-ellipsis">
      e. Using values and values_list
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-caching-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      6. Caching Strategies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-profiling-and-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      7. Profiling and Monitoring
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      8. Best Practices
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Odoo
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Odoo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../odoo/owl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    owl
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ansible/ansible/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ansible
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
        
          
          <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Other
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            Other
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/tmux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tmux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/nvim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Neovim
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" >
        
          
          <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cybersec
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15">
            <span class="md-nav__icon md-icon"></span>
            Cybersec
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cybersecurity/softwaresecurity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sofware Security
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16" >
        
          
          <label class="md-nav__link" for="__nav_16" id="__nav_16_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Rust
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_16">
            <span class="md-nav__icon md-icon"></span>
            Rust
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rust/vars/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rust/generators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rust/object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Objects
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rust/memory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Memory
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_17" >
        
          
          <label class="md-nav__link" for="__nav_17" id="__nav_17_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Daily life
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_17">
            <span class="md-nav__icon md-icon"></span>
            Daily life
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../other/nutr.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nutrition
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-preventing-the-n1-query-problem" class="md-nav__link">
    <span class="md-ellipsis">
      1. Preventing the N+1 Query Problem
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-utilizing-select_related" class="md-nav__link">
    <span class="md-ellipsis">
      2. Utilizing select_related
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-utilizing-prefetch_related" class="md-nav__link">
    <span class="md-ellipsis">
      3. Utilizing prefetch_related
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-combining-select_related-and-prefetch_related" class="md-nav__link">
    <span class="md-ellipsis">
      4. Combining select_related and prefetch_related
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-advanced-techniques" class="md-nav__link">
    <span class="md-ellipsis">
      5. Advanced Techniques
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Advanced Techniques">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-annotate-and-aggregate" class="md-nav__link">
    <span class="md-ellipsis">
      a. Annotate and Aggregate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-raw-sql-and-rawqueryset" class="md-nav__link">
    <span class="md-ellipsis">
      b. Raw SQL and RawQuerySet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-database-indexing" class="md-nav__link">
    <span class="md-ellipsis">
      c. Database Indexing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-query-optimization-with-defer-and-only" class="md-nav__link">
    <span class="md-ellipsis">
      d. Query Optimization with defer and only
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#e-using-values-and-values_list" class="md-nav__link">
    <span class="md-ellipsis">
      e. Using values and values_list
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-caching-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      6. Caching Strategies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-profiling-and-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      7. Profiling and Monitoring
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      8. Best Practices
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="1-django-orm-optimization-and-query-performance">1. Django ORM Optimization and Query Performance</h1>
<p><strong>Question:</strong><br />
How can you optimize complex database queries in Django's ORM to enhance performance? Discuss techniques to prevent common issues such as the N+1 query problem and how to utilize <code>select_related</code> and <code>prefetch_related</code> effectively.</p>
<p><strong>Answer:</strong></p>
<p>Optimizing Django ORM queries is essential for maintaining high performance, especially in applications with complex data interactions. Advanced strategies beyond basic <code>select_related</code> and <code>prefetch_related</code> can further enhance efficiency and scalability.</p>
<h3 id="1-preventing-the-n1-query-problem">1. Preventing the N+1 Query Problem</h3>
<p>The N+1 query problem arises when an initial query retrieves N objects and then executes an additional query for each object's related data, resulting in N+1 total queries.</p>
<p><strong>Inefficient Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="n">users</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">users</span><span class="p">:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">bio</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
This executes 1 query for users and N queries for profiles.</p>
<h3 id="2-utilizing-select_related">2. Utilizing <code>select_related</code></h3>
<p><code>select_related</code> is optimal for single-valued relationships (<code>ForeignKey</code>, <code>OneToOneField</code>). It performs a SQL join to fetch related objects in a single query.</p>
<p><strong>Efficient Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="n">users</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">select_related</span><span class="p">(</span><span class="s1">&#39;profile&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">users</span><span class="p">:</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">bio</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Advanced Usage:</strong>
- <strong>Chaining Relationships:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="n">orders</span> <span class="o">=</span> <span class="n">Order</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">select_related</span><span class="p">(</span><span class="s1">&#39;customer__profile&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
  Fetches <code>Order</code>, <code>Customer</code>, and <code>Profile</code> in one query.</p>
<ul>
<li><strong>Specifying Multiple Fields:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="n">queryset</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">select_related</span><span class="p">(</span><span class="s1">&#39;profile&#39;</span><span class="p">,</span> <span class="s1">&#39;address&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</code></pre></div></td></tr></table></div></li>
</ul>
<h3 id="3-utilizing-prefetch_related">3. Utilizing <code>prefetch_related</code></h3>
<p><code>prefetch_related</code> is suitable for multi-valued relationships (<code>ManyToManyField</code>, reverse <code>ForeignKey</code>). It executes separate queries and efficiently joins them in Python.</p>
<p><strong>Efficient Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span>
<span class="normal"><a href="#__codelineno-4-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="n">authors</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">prefetch_related</span><span class="p">(</span><span class="s1">&#39;books&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="k">for</span> <span class="n">author</span> <span class="ow">in</span> <span class="n">authors</span><span class="p">:</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a>    <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">author</span><span class="o">.</span><span class="n">books</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">book</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Advanced Usage:</strong>
- <strong>Prefetching Across Relationships:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="n">authors</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">prefetch_related</span><span class="p">(</span><span class="s1">&#39;books__publisher&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</code></pre></div></td></tr></table></div></p>
<ul>
<li><strong>Custom Prefetch Objects:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span>
<span class="normal"><a href="#__codelineno-6-3">3</a></span>
<span class="normal"><a href="#__codelineno-6-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.db.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Prefetch</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="n">books_prefetch</span> <span class="o">=</span> <span class="n">Prefetch</span><span class="p">(</span><span class="s1">&#39;books&#39;</span><span class="p">,</span> <span class="n">queryset</span><span class="o">=</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">select_related</span><span class="p">(</span><span class="s1">&#39;publisher&#39;</span><span class="p">))</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="n">authors</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">prefetch_related</span><span class="p">(</span><span class="n">books_prefetch</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</code></pre></div></td></tr></table></div></li>
</ul>
<h3 id="4-combining-select_related-and-prefetch_related">4. Combining <code>select_related</code> and <code>prefetch_related</code></h3>
<p>For queries involving both single and multi-valued relationships, combining both methods optimizes performance.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span>
<span class="normal"><a href="#__codelineno-7-2">2</a></span>
<span class="normal"><a href="#__codelineno-7-3">3</a></span>
<span class="normal"><a href="#__codelineno-7-4">4</a></span>
<span class="normal"><a href="#__codelineno-7-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="n">books</span> <span class="o">=</span> <span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">select_related</span><span class="p">(</span><span class="s1">&#39;publisher&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">prefetch_related</span><span class="p">(</span><span class="s1">&#39;authors&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">books</span><span class="p">:</span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">book</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a>    <span class="k">for</span> <span class="n">author</span> <span class="ow">in</span> <span class="n">book</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">author</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="5-advanced-techniques">5. Advanced Techniques</h3>
<h4 id="a-annotate-and-aggregate">a. Annotate and Aggregate</h4>
<p>Perform calculations directly in the database to reduce data transfer and processing in Python.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span>
<span class="normal"><a href="#__codelineno-8-3">3</a></span>
<span class="normal"><a href="#__codelineno-8-4">4</a></span>
<span class="normal"><a href="#__codelineno-8-5">5</a></span>
<span class="normal"><a href="#__codelineno-8-6">6</a></span>
<span class="normal"><a href="#__codelineno-8-7">7</a></span>
<span class="normal"><a href="#__codelineno-8-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.db.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Count</span><span class="p">,</span> <span class="n">Avg</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="n">authors</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a>    <span class="n">book_count</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s1">&#39;books&#39;</span><span class="p">),</span>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a>    <span class="n">average_rating</span><span class="o">=</span><span class="n">Avg</span><span class="p">(</span><span class="s1">&#39;books__rating&#39;</span><span class="p">)</span>
<a id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="k">for</span> <span class="n">author</span> <span class="ow">in</span> <span class="n">authors</span><span class="p">:</span>
<a id="__codelineno-8-8" name="__codelineno-8-8"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">author</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> has </span><span class="si">{</span><span class="n">author</span><span class="o">.</span><span class="n">book_count</span><span class="si">}</span><span class="s2"> books with an average rating of </span><span class="si">{</span><span class="n">author</span><span class="o">.</span><span class="n">average_rating</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="b-raw-sql-and-rawqueryset">b. Raw SQL and <code>RawQuerySet</code></h4>
<p>For highly optimized queries not achievable via the ORM, use raw SQL while ensuring protection against SQL injection.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="n">users</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM auth_user WHERE last_login &gt; </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">cutoff_date</span><span class="p">])</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Caution:</strong> Ensure all parameters are properly escaped.</p>
<h4 id="c-database-indexing">c. Database Indexing</h4>
<p>Beyond simple indexing, consider composite indexes and using <code>db_index=True</code> strategically.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span>
<span class="normal"><a href="#__codelineno-10-2">2</a></span>
<span class="normal"><a href="#__codelineno-10-3">3</a></span>
<span class="normal"><a href="#__codelineno-10-4">4</a></span>
<span class="normal"><a href="#__codelineno-10-5">5</a></span>
<span class="normal"><a href="#__codelineno-10-6">6</a></span>
<span class="normal"><a href="#__codelineno-10-7">7</a></span>
<span class="normal"><a href="#__codelineno-10-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Order</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a>    <span class="n">customer</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Customer</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a>    <span class="n">order_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">db_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a>
<a id="__codelineno-10-5" name="__codelineno-10-5"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
<a id="__codelineno-10-6" name="__codelineno-10-6"></a>        <span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-10-7" name="__codelineno-10-7"></a>            <span class="n">models</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;customer&#39;</span><span class="p">,</span> <span class="s1">&#39;order_date&#39;</span><span class="p">]),</span>
<a id="__codelineno-10-8" name="__codelineno-10-8"></a>        <span class="p">]</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="d-query-optimization-with-defer-and-only">d. Query Optimization with <code>defer</code> and <code>only</code></h4>
<p>Load only necessary fields to reduce query size.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="n">users</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">only</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;username&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="e-using-values-and-values_list">e. Using <code>values</code> and <code>values_list</code></h4>
<p>Retrieve dictionaries or tuples of specific fields for further processing.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="n">user_data</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;username&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="6-caching-strategies">6. Caching Strategies</h3>
<p>Implement caching to store frequently accessed query results.</p>
<p><strong>Example Using Django Cache Framework:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span>
<span class="normal"><a href="#__codelineno-13-2">2</a></span>
<span class="normal"><a href="#__codelineno-13-3">3</a></span>
<span class="normal"><a href="#__codelineno-13-4">4</a></span>
<span class="normal"><a href="#__codelineno-13-5">5</a></span>
<span class="normal"><a href="#__codelineno-13-6">6</a></span>
<span class="normal"><a href="#__codelineno-13-7">7</a></span>
<span class="normal"><a href="#__codelineno-13-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.core.cache</span><span class="w"> </span><span class="kn">import</span> <span class="n">cache</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_expensive_data</span><span class="p">():</span>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;expensive_data&#39;</span><span class="p">)</span>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-13-6" name="__codelineno-13-6"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">perform_expensive_operation</span><span class="p">()</span>
<a id="__codelineno-13-7" name="__codelineno-13-7"></a>        <span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;expensive_data&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<a id="__codelineno-13-8" name="__codelineno-13-8"></a>    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Advanced Caching:</strong>
- <strong>Cache Invalidation:</strong> Ensure cache is updated when underlying data changes.
- <strong>Cache Versioning:</strong> Manage different versions of cached data.</p>
<h3 id="7-profiling-and-monitoring">7. Profiling and Monitoring</h3>
<p>Use tools like Django Debug Toolbar, Silk, or New Relic to monitor query performance and identify bottlenecks.</p>
<p><strong>Example Setup with Django Debug Toolbar:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a>pip<span class="w"> </span>install<span class="w"> </span>django-debug-toolbar
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-15-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-15-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-15-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-15-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-15-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-15-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-15-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-15-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-15-10">10</a></span>
<span class="normal"><a href="#__codelineno-15-11">11</a></span>
<span class="normal"><a href="#__codelineno-15-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a>    <span class="c1"># ... other apps ...</span>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a>    <span class="s1">&#39;debug_toolbar&#39;</span><span class="p">,</span>
<a id="__codelineno-15-5" name="__codelineno-15-5"></a><span class="p">]</span>
<a id="__codelineno-15-6" name="__codelineno-15-6"></a>
<a id="__codelineno-15-7" name="__codelineno-15-7"></a><span class="n">MIDDLEWARE</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-15-8" name="__codelineno-15-8"></a>    <span class="s1">&#39;debug_toolbar.middleware.DebugToolbarMiddleware&#39;</span><span class="p">,</span>
<a id="__codelineno-15-9" name="__codelineno-15-9"></a>    <span class="c1"># ... other middleware ...</span>
<a id="__codelineno-15-10" name="__codelineno-15-10"></a><span class="p">]</span>
<a id="__codelineno-15-11" name="__codelineno-15-11"></a>
<a id="__codelineno-15-12" name="__codelineno-15-12"></a><span class="n">INTERNAL_IPS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-16-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-16-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-16-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-16-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-16-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-16-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-16-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-16-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-16-10">10</a></span>
<span class="normal"><a href="#__codelineno-16-11">11</a></span>
<span class="normal"><a href="#__codelineno-16-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="x">&lt;!-- templates/base.html --&gt;</span>
<a id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="cp">{%</span> <span class="k">load</span> <span class="nv">debug_toolbar</span> <span class="cp">%}</span>
<a id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="x">&lt;!DOCTYPE html&gt;</span>
<a id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="x">&lt;html&gt;</span>
<a id="__codelineno-16-5" name="__codelineno-16-5"></a><span class="x">&lt;head&gt;</span>
<a id="__codelineno-16-6" name="__codelineno-16-6"></a><span class="x">    &lt;title&gt;My Site&lt;/title&gt;</span>
<a id="__codelineno-16-7" name="__codelineno-16-7"></a><span class="x">&lt;/head&gt;</span>
<a id="__codelineno-16-8" name="__codelineno-16-8"></a><span class="x">&lt;body&gt;</span>
<a id="__codelineno-16-9" name="__codelineno-16-9"></a><span class="x">    </span><span class="cp">{%</span> <span class="k">debug_toolbar</span> <span class="cp">%}</span>
<a id="__codelineno-16-10" name="__codelineno-16-10"></a><span class="x">    &lt;!-- Content --&gt;</span>
<a id="__codelineno-16-11" name="__codelineno-16-11"></a><span class="x">&lt;/body&gt;</span>
<a id="__codelineno-16-12" name="__codelineno-16-12"></a><span class="x">&lt;/html&gt;</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="8-best-practices">8. Best Practices</h3>
<ul>
<li><strong>Avoid <code>select_related</code> on Many-to-Many:</strong> It’s ineffective; use <code>prefetch_related</code> instead.</li>
<li><strong>Batch Processing:</strong> Use bulk operations to minimize queries.
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1">1</a></span>
<span class="normal"><a href="#__codelineno-17-2">2</a></span>
<span class="normal"><a href="#__codelineno-17-3">3</a></span>
<span class="normal"><a href="#__codelineno-17-4">4</a></span>
<span class="normal"><a href="#__codelineno-17-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">bulk_create</span><span class="p">([</span>
<a id="__codelineno-17-2" name="__codelineno-17-2"></a>    <span class="n">User</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;user1&#39;</span><span class="p">),</span>
<a id="__codelineno-17-3" name="__codelineno-17-3"></a>    <span class="n">User</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;user2&#39;</span><span class="p">),</span>
<a id="__codelineno-17-4" name="__codelineno-17-4"></a>    <span class="c1"># ...</span>
<a id="__codelineno-17-5" name="__codelineno-17-5"></a><span class="p">])</span>
</code></pre></div></td></tr></table></div></li>
<li><strong>Monitor Database Performance:</strong> Regularly analyze query performance using database-specific tools like PostgreSQL's <code>EXPLAIN ANALYZE</code>.</li>
</ul>
<p><strong>Conclusion:</strong><br />
Optimizing Django ORM queries involves a combination of using <code>select_related</code>, <code>prefetch_related</code>, advanced querying techniques, strategic indexing, effective caching, and continuous profiling. Mastery of these strategies ensures efficient database interactions and high application performance.</p>
<hr />
<h1 id="2-custom-middleware-development">2. Custom Middleware Development</h1>
<p><strong>Question:</strong><br />
Describe the process of creating and integrating custom middleware in a Django application. Provide an example where middleware is used to modify the request and response objects, such as adding custom headers or logging request data.</p>
<p><strong>Answer:</strong></p>
<p>Middleware in Django allows for processing requests and responses globally. Advanced middleware can handle tasks like performance monitoring, authentication, and custom header management.</p>
<h3 id="1-middleware-structure">1. Middleware Structure</h3>
<p>In Django 1.10+, middleware is defined as a class with <code>__init__</code> and <code>__call__</code> methods.</p>
<p><strong>Basic Structure:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-18-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-18-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-18-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-18-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-18-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-18-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-18-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-18-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-18-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">CustomMiddleware</span><span class="p">:</span>
<a id="__codelineno-18-2" name="__codelineno-18-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_response</span><span class="p">):</span>
<a id="__codelineno-18-3" name="__codelineno-18-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_response</span> <span class="o">=</span> <span class="n">get_response</span>
<a id="__codelineno-18-4" name="__codelineno-18-4"></a>        <span class="c1"># One-time setup</span>
<a id="__codelineno-18-5" name="__codelineno-18-5"></a>
<a id="__codelineno-18-6" name="__codelineno-18-6"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
<a id="__codelineno-18-7" name="__codelineno-18-7"></a>        <span class="c1"># Pre-processing</span>
<a id="__codelineno-18-8" name="__codelineno-18-8"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_response</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<a id="__codelineno-18-9" name="__codelineno-18-9"></a>        <span class="c1"># Post-processing</span>
<a id="__codelineno-18-10" name="__codelineno-18-10"></a>        <span class="k">return</span> <span class="n">response</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="2-creating-custom-middleware">2. Creating Custom Middleware</h3>
<p><strong>Example:</strong> Logging request details and adding a custom response header.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-19-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-19-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-19-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-19-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-19-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-19-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-19-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-19-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-19-10">10</a></span>
<span class="normal"><a href="#__codelineno-19-11">11</a></span>
<span class="normal"><a href="#__codelineno-19-12">12</a></span>
<span class="normal"><a href="#__codelineno-19-13">13</a></span>
<span class="normal"><a href="#__codelineno-19-14">14</a></span>
<span class="normal"><a href="#__codelineno-19-15">15</a></span>
<span class="normal"><a href="#__codelineno-19-16">16</a></span>
<span class="normal"><a href="#__codelineno-19-17">17</a></span>
<span class="normal"><a href="#__codelineno-19-18">18</a></span>
<span class="normal"><a href="#__codelineno-19-19">19</a></span>
<span class="normal"><a href="#__codelineno-19-20">20</a></span>
<span class="normal"><a href="#__codelineno-19-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="c1"># myapp/middleware.py</span>
<a id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<a id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">time</span><span class="w"> </span><span class="kn">import</span> <span class="n">time</span>
<a id="__codelineno-19-4" name="__codelineno-19-4"></a>
<a id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<a id="__codelineno-19-6" name="__codelineno-19-6"></a>
<a id="__codelineno-19-7" name="__codelineno-19-7"></a><span class="k">class</span><span class="w"> </span><span class="nc">RequestLoggingMiddleware</span><span class="p">:</span>
<a id="__codelineno-19-8" name="__codelineno-19-8"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_response</span><span class="p">):</span>
<a id="__codelineno-19-9" name="__codelineno-19-9"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_response</span> <span class="o">=</span> <span class="n">get_response</span>
<a id="__codelineno-19-10" name="__codelineno-19-10"></a>
<a id="__codelineno-19-11" name="__codelineno-19-11"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
<a id="__codelineno-19-12" name="__codelineno-19-12"></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<a id="__codelineno-19-13" name="__codelineno-19-13"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Request Method: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s2">, Path: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-19-14" name="__codelineno-19-14"></a>
<a id="__codelineno-19-15" name="__codelineno-19-15"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_response</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<a id="__codelineno-19-16" name="__codelineno-19-16"></a>
<a id="__codelineno-19-17" name="__codelineno-19-17"></a>        <span class="n">duration</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
<a id="__codelineno-19-18" name="__codelineno-19-18"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Response Status: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">, Duration: </span><span class="si">{</span><span class="n">duration</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
<a id="__codelineno-19-19" name="__codelineno-19-19"></a>        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;X-Request-Duration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">duration</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span>
<a id="__codelineno-19-20" name="__codelineno-19-20"></a>
<a id="__codelineno-19-21" name="__codelineno-19-21"></a>        <span class="k">return</span> <span class="n">response</span>
</code></pre></div></td></tr></table></div>
<h3 id="3-integrating-middleware">3. Integrating Middleware</h3>
<p>Add the middleware to <code>settings.py</code> in the <code>MIDDLEWARE</code> list.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1">1</a></span>
<span class="normal"><a href="#__codelineno-20-2">2</a></span>
<span class="normal"><a href="#__codelineno-20-3">3</a></span>
<span class="normal"><a href="#__codelineno-20-4">4</a></span>
<span class="normal"><a href="#__codelineno-20-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="n">MIDDLEWARE</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-20-3" name="__codelineno-20-3"></a>    <span class="c1"># ... existing middleware ...</span>
<a id="__codelineno-20-4" name="__codelineno-20-4"></a>    <span class="s1">&#39;myapp.middleware.RequestLoggingMiddleware&#39;</span><span class="p">,</span>
<a id="__codelineno-20-5" name="__codelineno-20-5"></a><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<h3 id="4-configuring-logging">4. Configuring Logging</h3>
<p>Ensure logging is configured to capture middleware logs.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-21-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-21-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-21-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-21-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-21-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-21-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-21-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-21-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-21-10">10</a></span>
<span class="normal"><a href="#__codelineno-21-11">11</a></span>
<span class="normal"><a href="#__codelineno-21-12">12</a></span>
<span class="normal"><a href="#__codelineno-21-13">13</a></span>
<span class="normal"><a href="#__codelineno-21-14">14</a></span>
<span class="normal"><a href="#__codelineno-21-15">15</a></span>
<span class="normal"><a href="#__codelineno-21-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="n">LOGGING</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-21-3" name="__codelineno-21-3"></a>    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-21-4" name="__codelineno-21-4"></a>    <span class="s1">&#39;disable_existing_loggers&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-21-5" name="__codelineno-21-5"></a>    <span class="s1">&#39;handlers&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-21-6" name="__codelineno-21-6"></a>        <span class="s1">&#39;console&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-21-7" name="__codelineno-21-7"></a>            <span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;logging.StreamHandler&#39;</span><span class="p">,</span>
<a id="__codelineno-21-8" name="__codelineno-21-8"></a>        <span class="p">},</span>
<a id="__codelineno-21-9" name="__codelineno-21-9"></a>    <span class="p">},</span>
<a id="__codelineno-21-10" name="__codelineno-21-10"></a>    <span class="s1">&#39;loggers&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-21-11" name="__codelineno-21-11"></a>        <span class="s1">&#39;myapp.middleware&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-21-12" name="__codelineno-21-12"></a>            <span class="s1">&#39;handlers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;console&#39;</span><span class="p">],</span>
<a id="__codelineno-21-13" name="__codelineno-21-13"></a>            <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="s1">&#39;INFO&#39;</span><span class="p">,</span>
<a id="__codelineno-21-14" name="__codelineno-21-14"></a>        <span class="p">},</span>
<a id="__codelineno-21-15" name="__codelineno-21-15"></a>    <span class="p">},</span>
<a id="__codelineno-21-16" name="__codelineno-21-16"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="5-advanced-middleware-features">5. Advanced Middleware Features</h3>
<h4 id="a-modifying-request-objects">a. Modifying Request Objects</h4>
<p>Attach additional attributes to <code>request</code> for use in views.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span>
<span class="normal"><a href="#__codelineno-22-2">2</a></span>
<span class="normal"><a href="#__codelineno-22-3">3</a></span>
<span class="normal"><a href="#__codelineno-22-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
<a id="__codelineno-22-2" name="__codelineno-22-2"></a>    <span class="n">request</span><span class="o">.</span><span class="n">custom_attribute</span> <span class="o">=</span> <span class="s1">&#39;CustomValue&#39;</span>
<a id="__codelineno-22-3" name="__codelineno-22-3"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_response</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<a id="__codelineno-22-4" name="__codelineno-22-4"></a>    <span class="k">return</span> <span class="n">response</span>
</code></pre></div></td></tr></table></div>
<h4 id="b-handling-exceptions">b. Handling Exceptions</h4>
<p>Catch and handle exceptions to implement custom error handling.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1">1</a></span>
<span class="normal"><a href="#__codelineno-23-2">2</a></span>
<span class="normal"><a href="#__codelineno-23-3">3</a></span>
<span class="normal"><a href="#__codelineno-23-4">4</a></span>
<span class="normal"><a href="#__codelineno-23-5">5</a></span>
<span class="normal"><a href="#__codelineno-23-6">6</a></span>
<span class="normal"><a href="#__codelineno-23-7">7</a></span>
<span class="normal"><a href="#__codelineno-23-8">8</a></span>
<span class="normal"><a href="#__codelineno-23-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">HttpResponse</span>
<a id="__codelineno-23-2" name="__codelineno-23-2"></a>
<a id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
<a id="__codelineno-23-4" name="__codelineno-23-4"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-23-5" name="__codelineno-23-5"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_response</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<a id="__codelineno-23-6" name="__codelineno-23-6"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-23-7" name="__codelineno-23-7"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-23-8" name="__codelineno-23-8"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s2">&quot;Internal Server Error&quot;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<a id="__codelineno-23-9" name="__codelineno-23-9"></a>    <span class="k">return</span> <span class="n">response</span>
</code></pre></div></td></tr></table></div>
<h4 id="c-asynchronous-middleware">c. Asynchronous Middleware</h4>
<p>For ASGI support, define <code>async __call__</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1">1</a></span>
<span class="normal"><a href="#__codelineno-24-2">2</a></span>
<span class="normal"><a href="#__codelineno-24-3">3</a></span>
<span class="normal"><a href="#__codelineno-24-4">4</a></span>
<span class="normal"><a href="#__codelineno-24-5">5</a></span>
<span class="normal"><a href="#__codelineno-24-6">6</a></span>
<span class="normal"><a href="#__codelineno-24-7">7</a></span>
<span class="normal"><a href="#__codelineno-24-8">8</a></span>
<span class="normal"><a href="#__codelineno-24-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">AsyncMiddleware</span><span class="p">:</span>
<a id="__codelineno-24-2" name="__codelineno-24-2"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_response</span><span class="p">):</span>
<a id="__codelineno-24-3" name="__codelineno-24-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_response</span> <span class="o">=</span> <span class="n">get_response</span>
<a id="__codelineno-24-4" name="__codelineno-24-4"></a>
<a id="__codelineno-24-5" name="__codelineno-24-5"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
<a id="__codelineno-24-6" name="__codelineno-24-6"></a>        <span class="c1"># Async pre-processing</span>
<a id="__codelineno-24-7" name="__codelineno-24-7"></a>        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_response</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<a id="__codelineno-24-8" name="__codelineno-24-8"></a>        <span class="c1"># Async post-processing</span>
<a id="__codelineno-24-9" name="__codelineno-24-9"></a>        <span class="k">return</span> <span class="n">response</span>
</code></pre></div></td></tr></table></div>
<h3 id="6-best-practices">6. Best Practices</h3>
<ul>
<li><strong>Keep Middleware Lightweight:</strong> Minimize processing to reduce request latency.</li>
<li><strong>Avoid Business Logic:</strong> Implement cross-cutting concerns like logging, authentication.</li>
<li><strong>Thread Safety:</strong> Ensure middleware is thread-safe, especially when modifying shared resources.</li>
<li><strong>Order Matters:</strong> Place middleware appropriately in the <code>MIDDLEWARE</code> list to ensure correct processing order.</li>
</ul>
<h3 id="7-testing-middleware">7. Testing Middleware</h3>
<p><strong>Example Test Case:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-25-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-25-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-25-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-25-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-25-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-25-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-25-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-25-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-25-10">10</a></span>
<span class="normal"><a href="#__codelineno-25-11">11</a></span>
<span class="normal"><a href="#__codelineno-25-12">12</a></span>
<span class="normal"><a href="#__codelineno-25-13">13</a></span>
<span class="normal"><a href="#__codelineno-25-14">14</a></span>
<span class="normal"><a href="#__codelineno-25-15">15</a></span>
<span class="normal"><a href="#__codelineno-25-16">16</a></span>
<span class="normal"><a href="#__codelineno-25-17">17</a></span>
<span class="normal"><a href="#__codelineno-25-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="c1"># myapp/tests/test_middleware.py</span>
<a id="__codelineno-25-2" name="__codelineno-25-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.test</span><span class="w"> </span><span class="kn">import</span> <span class="n">TestCase</span><span class="p">,</span> <span class="n">RequestFactory</span>
<a id="__codelineno-25-3" name="__codelineno-25-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">myapp.middleware</span><span class="w"> </span><span class="kn">import</span> <span class="n">RequestLoggingMiddleware</span>
<a id="__codelineno-25-4" name="__codelineno-25-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">HttpResponse</span>
<a id="__codelineno-25-5" name="__codelineno-25-5"></a>
<a id="__codelineno-25-6" name="__codelineno-25-6"></a><span class="k">class</span><span class="w"> </span><span class="nc">MiddlewareTest</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
<a id="__codelineno-25-7" name="__codelineno-25-7"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-25-8" name="__codelineno-25-8"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">factory</span> <span class="o">=</span> <span class="n">RequestFactory</span><span class="p">()</span>
<a id="__codelineno-25-9" name="__codelineno-25-9"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">middleware</span> <span class="o">=</span> <span class="n">RequestLoggingMiddleware</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_response</span><span class="p">)</span>
<a id="__codelineno-25-10" name="__codelineno-25-10"></a>
<a id="__codelineno-25-11" name="__codelineno-25-11"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
<a id="__codelineno-25-12" name="__codelineno-25-12"></a>        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">)</span>
<a id="__codelineno-25-13" name="__codelineno-25-13"></a>
<a id="__codelineno-25-14" name="__codelineno-25-14"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_middleware_logging</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-25-15" name="__codelineno-25-15"></a>        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/test-path/&#39;</span><span class="p">)</span>
<a id="__codelineno-25-16" name="__codelineno-25-16"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">middleware</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<a id="__codelineno-25-17" name="__codelineno-25-17"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<a id="__codelineno-25-18" name="__codelineno-25-18"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s1">&#39;X-Request-Duration&#39;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Conclusion:</strong><br />
Custom middleware enhances Django applications by handling global request/response processing tasks. By adhering to best practices and leveraging advanced features, middleware can efficiently manage cross-cutting concerns without impacting application performance.</p>
<hr />
<h1 id="3-advanced-template-rendering-and-context-processors">3. Advanced Template Rendering and Context Processors</h1>
<p><strong>Question:</strong><br />
Explain how Django's template system can be extended using custom template tags and filters. Additionally, discuss how to create and use custom context processors to inject common data into templates.</p>
<p><strong>Answer:</strong></p>
<p>Django's templating system is extensible, allowing developers to create custom tags, filters, and context processors for enhanced functionality and reusable components.</p>
<h3 id="1-custom-template-tags-and-filters">1. Custom Template Tags and Filters</h3>
<h4 id="a-creating-custom-template-tags">a. Creating Custom Template Tags</h4>
<p><strong>Step-by-Step:</strong></p>
<ol>
<li>
<p><strong>Create <code>templatetags</code> Directory:</strong>
   <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">1</a></span>
<span class="normal"><a href="#__codelineno-26-2">2</a></span>
<span class="normal"><a href="#__codelineno-26-3">3</a></span>
<span class="normal"><a href="#__codelineno-26-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a>myapp/
<a id="__codelineno-26-2" name="__codelineno-26-2"></a>├── templatetags/
<a id="__codelineno-26-3" name="__codelineno-26-3"></a>│   ├── __init__.py
<a id="__codelineno-26-4" name="__codelineno-26-4"></a>│   └── custom_tags.py
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Define Custom Tags:</strong>
   <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-27-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-27-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-27-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-27-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-27-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-27-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-27-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-27-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-27-10">10</a></span>
<span class="normal"><a href="#__codelineno-27-11">11</a></span>
<span class="normal"><a href="#__codelineno-27-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="c1"># myapp/templatetags/custom_tags.py</span>
<a id="__codelineno-27-2" name="__codelineno-27-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django</span><span class="w"> </span><span class="kn">import</span> <span class="n">template</span>
<a id="__codelineno-27-3" name="__codelineno-27-3"></a>
<a id="__codelineno-27-4" name="__codelineno-27-4"></a><span class="n">register</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">Library</span><span class="p">()</span>
<a id="__codelineno-27-5" name="__codelineno-27-5"></a>
<a id="__codelineno-27-6" name="__codelineno-27-6"></a><span class="nd">@register</span><span class="o">.</span><span class="n">simple_tag</span>
<a id="__codelineno-27-7" name="__codelineno-27-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">multiply</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<a id="__codelineno-27-8" name="__codelineno-27-8"></a>    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
<a id="__codelineno-27-9" name="__codelineno-27-9"></a>
<a id="__codelineno-27-10" name="__codelineno-27-10"></a><span class="nd">@register</span><span class="o">.</span><span class="n">inclusion_tag</span><span class="p">(</span><span class="s1">&#39;myapp/display_product.html&#39;</span><span class="p">)</span>
<a id="__codelineno-27-11" name="__codelineno-27-11"></a><span class="k">def</span><span class="w"> </span><span class="nf">show_product</span><span class="p">(</span><span class="n">product</span><span class="p">):</span>
<a id="__codelineno-27-12" name="__codelineno-27-12"></a>    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;product&#39;</span><span class="p">:</span> <span class="n">product</span><span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Use in Templates:</strong>
   <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1">1</a></span>
<span class="normal"><a href="#__codelineno-28-2">2</a></span>
<span class="normal"><a href="#__codelineno-28-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="cp">{%</span> <span class="k">load</span> <span class="nv">custom_tags</span> <span class="cp">%}</span>
<a id="__codelineno-28-2" name="__codelineno-28-2"></a><span class="cp">{%</span> <span class="k">multiply</span> <span class="m">3</span> <span class="m">5</span> <span class="cp">%}</span><span class="x"> &lt;!-- Outputs: 15 --&gt;</span>
<a id="__codelineno-28-3" name="__codelineno-28-3"></a><span class="cp">{%</span> <span class="k">show_product</span> <span class="nv">product</span> <span class="cp">%}</span>
</code></pre></div></td></tr></table></div></p>
</li>
</ol>
<p><strong>Advanced Example: Custom Inclusion Tag with Context</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1">1</a></span>
<span class="normal"><a href="#__codelineno-29-2">2</a></span>
<span class="normal"><a href="#__codelineno-29-3">3</a></span>
<span class="normal"><a href="#__codelineno-29-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="nd">@register</span><span class="o">.</span><span class="n">inclusion_tag</span><span class="p">(</span><span class="s1">&#39;myapp/recent_posts.html&#39;</span><span class="p">)</span>
<a id="__codelineno-29-2" name="__codelineno-29-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">recent_posts</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<a id="__codelineno-29-3" name="__codelineno-29-3"></a>    <span class="n">posts</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;-published_date&#39;</span><span class="p">)[:</span><span class="n">count</span><span class="p">]</span>
<a id="__codelineno-29-4" name="__codelineno-29-4"></a>    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;recent_posts&#39;</span><span class="p">:</span> <span class="n">posts</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h4 id="b-creating-custom-template-filters">b. Creating Custom Template Filters</h4>
<p><strong>Example: Truncate Words</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-30-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-30-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-30-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-30-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-30-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-30-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-30-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-30-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-30-10">10</a></span>
<span class="normal"><a href="#__codelineno-30-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="c1"># myapp/templatetags/custom_filters.py</span>
<a id="__codelineno-30-2" name="__codelineno-30-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django</span><span class="w"> </span><span class="kn">import</span> <span class="n">template</span>
<a id="__codelineno-30-3" name="__codelineno-30-3"></a>
<a id="__codelineno-30-4" name="__codelineno-30-4"></a><span class="n">register</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">Library</span><span class="p">()</span>
<a id="__codelineno-30-5" name="__codelineno-30-5"></a>
<a id="__codelineno-30-6" name="__codelineno-30-6"></a><span class="nd">@register</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;truncate_words&#39;</span><span class="p">)</span>
<a id="__codelineno-30-7" name="__codelineno-30-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">truncate_words</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
<a id="__codelineno-30-8" name="__codelineno-30-8"></a>    <span class="n">words</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<a id="__codelineno-30-9" name="__codelineno-30-9"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">num</span><span class="p">:</span>
<a id="__codelineno-30-10" name="__codelineno-30-10"></a>        <span class="k">return</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">words</span><span class="p">[:</span><span class="n">num</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;...&#39;</span>
<a id="__codelineno-30-11" name="__codelineno-30-11"></a>    <span class="k">return</span> <span class="n">value</span>
</code></pre></div></td></tr></table></div>
<p><strong>Usage in Template:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1">1</a></span>
<span class="normal"><a href="#__codelineno-31-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="cp">{%</span> <span class="k">load</span> <span class="nv">custom_filters</span> <span class="cp">%}</span>
<a id="__codelineno-31-2" name="__codelineno-31-2"></a><span class="cp">{{</span> <span class="nv">article.content</span><span class="o">|</span><span class="nf">truncate_words</span><span class="o">:</span><span class="m">30</span> <span class="cp">}}</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Advanced Example: Safe JSON Filter</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1">1</a></span>
<span class="normal"><a href="#__codelineno-32-2">2</a></span>
<span class="normal"><a href="#__codelineno-32-3">3</a></span>
<span class="normal"><a href="#__codelineno-32-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1"></a><span class="nd">@register</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;to_json&#39;</span><span class="p">)</span>
<a id="__codelineno-32-2" name="__codelineno-32-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
<a id="__codelineno-32-3" name="__codelineno-32-3"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<a id="__codelineno-32-4" name="__codelineno-32-4"></a>    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p><strong>Usage:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1">1</a></span>
<span class="normal"><a href="#__codelineno-33-2">2</a></span>
<span class="normal"><a href="#__codelineno-33-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1"></a><span class="x">&lt;script&gt;</span>
<a id="__codelineno-33-2" name="__codelineno-33-2"></a><span class="x">    var data = </span><span class="cp">{{</span> <span class="nv">data</span><span class="o">|</span><span class="nf">to_json</span><span class="o">|</span><span class="nf">safe</span> <span class="cp">}}</span><span class="x">;</span>
<a id="__codelineno-33-3" name="__codelineno-33-3"></a><span class="x">&lt;/script&gt;</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="2-custom-context-processors">2. Custom Context Processors</h3>
<p><strong>Purpose:</strong> Inject common data into all templates, such as site-wide settings or user-specific information.</p>
<h4 id="a-creating-a-context-processor">a. Creating a Context Processor</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-34-1">1</a></span>
<span class="normal"><a href="#__codelineno-34-2">2</a></span>
<span class="normal"><a href="#__codelineno-34-3">3</a></span>
<span class="normal"><a href="#__codelineno-34-4">4</a></span>
<span class="normal"><a href="#__codelineno-34-5">5</a></span>
<span class="normal"><a href="#__codelineno-34-6">6</a></span>
<span class="normal"><a href="#__codelineno-34-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1"></a><span class="c1"># myapp/context_processors.py</span>
<a id="__codelineno-34-2" name="__codelineno-34-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">site_info</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-34-3" name="__codelineno-34-3"></a>    <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-34-4" name="__codelineno-34-4"></a>        <span class="s1">&#39;site_name&#39;</span><span class="p">:</span> <span class="s1">&#39;My Awesome Site&#39;</span><span class="p">,</span>
<a id="__codelineno-34-5" name="__codelineno-34-5"></a>        <span class="s1">&#39;contact_email&#39;</span><span class="p">:</span> <span class="s1">&#39;contact@myawesomesite.com&#39;</span><span class="p">,</span>
<a id="__codelineno-34-6" name="__codelineno-34-6"></a>        <span class="s1">&#39;current_year&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
<a id="__codelineno-34-7" name="__codelineno-34-7"></a>    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h4 id="b-registering-the-context-processor">b. Registering the Context Processor</h4>
<p>Add to <code>TEMPLATES</code> in <code>settings.py</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-35-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-35-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-35-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-35-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-35-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-35-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-35-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-35-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-35-10">10</a></span>
<span class="normal"><a href="#__codelineno-35-11">11</a></span>
<span class="normal"><a href="#__codelineno-35-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-35-2" name="__codelineno-35-2"></a><span class="n">TEMPLATES</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-35-3" name="__codelineno-35-3"></a>    <span class="p">{</span>
<a id="__codelineno-35-4" name="__codelineno-35-4"></a>        <span class="c1"># ... other settings ...</span>
<a id="__codelineno-35-5" name="__codelineno-35-5"></a>        <span class="s1">&#39;OPTIONS&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-35-6" name="__codelineno-35-6"></a>            <span class="s1">&#39;context_processors&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-35-7" name="__codelineno-35-7"></a>                <span class="c1"># ... default context processors ...</span>
<a id="__codelineno-35-8" name="__codelineno-35-8"></a>                <span class="s1">&#39;myapp.context_processors.site_info&#39;</span><span class="p">,</span>
<a id="__codelineno-35-9" name="__codelineno-35-9"></a>            <span class="p">],</span>
<a id="__codelineno-35-10" name="__codelineno-35-10"></a>        <span class="p">},</span>
<a id="__codelineno-35-11" name="__codelineno-35-11"></a>    <span class="p">},</span>
<a id="__codelineno-35-12" name="__codelineno-35-12"></a><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<h4 id="c-using-in-templates">c. Using in Templates</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-36-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-36-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-36-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-36-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-36-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-36-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-36-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-36-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-36-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-36-10">10</a></span>
<span class="normal"><a href="#__codelineno-36-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1"></a><span class="x">&lt;!DOCTYPE html&gt;</span>
<a id="__codelineno-36-2" name="__codelineno-36-2"></a><span class="x">&lt;html&gt;</span>
<a id="__codelineno-36-3" name="__codelineno-36-3"></a><span class="x">&lt;head&gt;</span>
<a id="__codelineno-36-4" name="__codelineno-36-4"></a><span class="x">    &lt;title&gt;</span><span class="cp">{{</span> <span class="nv">site_name</span> <span class="cp">}}</span><span class="x">&lt;/title&gt;</span>
<a id="__codelineno-36-5" name="__codelineno-36-5"></a><span class="x">&lt;/head&gt;</span>
<a id="__codelineno-36-6" name="__codelineno-36-6"></a><span class="x">&lt;body&gt;</span>
<a id="__codelineno-36-7" name="__codelineno-36-7"></a><span class="x">    &lt;footer&gt;</span>
<a id="__codelineno-36-8" name="__codelineno-36-8"></a><span class="x">        &amp;copy; </span><span class="cp">{{</span> <span class="nv">current_year</span> <span class="cp">}}</span><span class="x"> </span><span class="cp">{{</span> <span class="nv">site_name</span> <span class="cp">}}</span><span class="x"> | Contact: </span><span class="cp">{{</span> <span class="nv">contact_email</span> <span class="cp">}}</span>
<a id="__codelineno-36-9" name="__codelineno-36-9"></a><span class="x">    &lt;/footer&gt;</span>
<a id="__codelineno-36-10" name="__codelineno-36-10"></a><span class="x">&lt;/body&gt;</span>
<a id="__codelineno-36-11" name="__codelineno-36-11"></a><span class="x">&lt;/html&gt;</span>
</code></pre></div></td></tr></table></div>
<p><strong>Advanced Example: User-Specific Context Processor</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-37-1">1</a></span>
<span class="normal"><a href="#__codelineno-37-2">2</a></span>
<span class="normal"><a href="#__codelineno-37-3">3</a></span>
<span class="normal"><a href="#__codelineno-37-4">4</a></span>
<span class="normal"><a href="#__codelineno-37-5">5</a></span>
<span class="normal"><a href="#__codelineno-37-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1"></a><span class="c1"># myapp/context_processors.py</span>
<a id="__codelineno-37-2" name="__codelineno-37-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">user_notifications</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-37-3" name="__codelineno-37-3"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">:</span>
<a id="__codelineno-37-4" name="__codelineno-37-4"></a>        <span class="n">notifications</span> <span class="o">=</span> <span class="n">Notification</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">read</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-37-5" name="__codelineno-37-5"></a>        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;unread_notifications&#39;</span><span class="p">:</span> <span class="n">notifications</span><span class="p">}</span>
<a id="__codelineno-37-6" name="__codelineno-37-6"></a>    <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
<p><strong>Usage in Template:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-38-1">1</a></span>
<span class="normal"><a href="#__codelineno-38-2">2</a></span>
<span class="normal"><a href="#__codelineno-38-3">3</a></span>
<span class="normal"><a href="#__codelineno-38-4">4</a></span>
<span class="normal"><a href="#__codelineno-38-5">5</a></span>
<span class="normal"><a href="#__codelineno-38-6">6</a></span>
<span class="normal"><a href="#__codelineno-38-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1"></a><span class="cp">{%</span> <span class="k">if</span> <span class="nv">unread_notifications</span> <span class="cp">%}</span>
<a id="__codelineno-38-2" name="__codelineno-38-2"></a><span class="x">    &lt;ul&gt;</span>
<a id="__codelineno-38-3" name="__codelineno-38-3"></a><span class="x">        </span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">notification</span> <span class="k">in</span> <span class="nv">unread_notifications</span> <span class="cp">%}</span>
<a id="__codelineno-38-4" name="__codelineno-38-4"></a><span class="x">            &lt;li&gt;</span><span class="cp">{{</span> <span class="nv">notification.message</span> <span class="cp">}}</span><span class="x">&lt;/li&gt;</span>
<a id="__codelineno-38-5" name="__codelineno-38-5"></a><span class="x">        </span><span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<a id="__codelineno-38-6" name="__codelineno-38-6"></a><span class="x">    &lt;/ul&gt;</span>
<a id="__codelineno-38-7" name="__codelineno-38-7"></a><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="3-advanced-template-tags-and-filters">3. Advanced Template Tags and Filters</h3>
<h4 id="a-custom-assignment-tag">a. Custom Assignment Tag</h4>
<p>Allows assigning a value to a variable within a template.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-39-1">1</a></span>
<span class="normal"><a href="#__codelineno-39-2">2</a></span>
<span class="normal"><a href="#__codelineno-39-3">3</a></span>
<span class="normal"><a href="#__codelineno-39-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1"></a><span class="nd">@register</span><span class="o">.</span><span class="n">simple_tag</span>
<a id="__codelineno-39-2" name="__codelineno-39-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_latest_articles</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<a id="__codelineno-39-3" name="__codelineno-39-3"></a>    <span class="n">articles</span> <span class="o">=</span> <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;-published_date&#39;</span><span class="p">)[:</span><span class="n">count</span><span class="p">]</span>
<a id="__codelineno-39-4" name="__codelineno-39-4"></a>    <span class="k">return</span> <span class="n">articles</span>
</code></pre></div></td></tr></table></div>
<p><strong>Usage:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-40-1">1</a></span>
<span class="normal"><a href="#__codelineno-40-2">2</a></span>
<span class="normal"><a href="#__codelineno-40-3">3</a></span>
<span class="normal"><a href="#__codelineno-40-4">4</a></span>
<span class="normal"><a href="#__codelineno-40-5">5</a></span>
<span class="normal"><a href="#__codelineno-40-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1"></a><span class="cp">{%</span> <span class="k">get_latest_articles</span> <span class="k">as</span> <span class="nv">latest_articles</span> <span class="cp">%}</span>
<a id="__codelineno-40-2" name="__codelineno-40-2"></a><span class="x">&lt;ul&gt;</span>
<a id="__codelineno-40-3" name="__codelineno-40-3"></a><span class="x">    </span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">article</span> <span class="k">in</span> <span class="nv">latest_articles</span> <span class="cp">%}</span>
<a id="__codelineno-40-4" name="__codelineno-40-4"></a><span class="x">        &lt;li&gt;</span><span class="cp">{{</span> <span class="nv">article.title</span> <span class="cp">}}</span><span class="x">&lt;/li&gt;</span>
<a id="__codelineno-40-5" name="__codelineno-40-5"></a><span class="x">    </span><span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<a id="__codelineno-40-6" name="__codelineno-40-6"></a><span class="x">&lt;/ul&gt;</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="b-inclusion-tags-with-complex-context">b. Inclusion Tags with Complex Context</h4>
<p>Render complex components with multiple context variables.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-41-1">1</a></span>
<span class="normal"><a href="#__codelineno-41-2">2</a></span>
<span class="normal"><a href="#__codelineno-41-3">3</a></span>
<span class="normal"><a href="#__codelineno-41-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1"></a><span class="nd">@register</span><span class="o">.</span><span class="n">inclusion_tag</span><span class="p">(</span><span class="s1">&#39;myapp/sidebar.html&#39;</span><span class="p">)</span>
<a id="__codelineno-41-2" name="__codelineno-41-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">render_sidebar</span><span class="p">(</span><span class="n">user</span><span class="p">):</span>
<a id="__codelineno-41-3" name="__codelineno-41-3"></a>    <span class="n">recent_posts</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">author</span><span class="o">=</span><span class="n">user</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;-published_date&#39;</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
<a id="__codelineno-41-4" name="__codelineno-41-4"></a>    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="n">user</span><span class="p">,</span> <span class="s1">&#39;recent_posts&#39;</span><span class="p">:</span> <span class="n">recent_posts</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p><strong>Usage:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-42-1">1</a></span>
<span class="normal"><a href="#__codelineno-42-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1"></a><span class="cp">{%</span> <span class="k">load</span> <span class="nv">custom_tags</span> <span class="cp">%}</span>
<a id="__codelineno-42-2" name="__codelineno-42-2"></a><span class="cp">{%</span> <span class="k">render_sidebar</span> <span class="nv">request.user</span> <span class="cp">%}</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="4-best-practices">4. Best Practices</h3>
<ul>
<li><strong>Organize Tags and Filters:</strong> Group related functionalities into separate modules for clarity.</li>
<li><strong>Minimal Logic in Templates:</strong> Encapsulate complex logic within tags, filters, or context processors to keep templates clean.</li>
<li><strong>Secure Handling:</strong> Sanitize inputs in custom tags and filters to prevent security vulnerabilities like XSS.</li>
<li><strong>Documentation:</strong> Clearly document custom tags, filters, and context processors for maintainability.</li>
<li><strong>Performance Optimization:</strong> Avoid heavy database queries within template tags; prefer prefetching data in views or context processors.</li>
</ul>
<h3 id="5-example-comprehensive-implementation">5. Example: Comprehensive Implementation</h3>
<h4 id="a-custom-template-tag-to-display-users-full-name">a. Custom Template Tag to Display User's Full Name</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-43-1">1</a></span>
<span class="normal"><a href="#__codelineno-43-2">2</a></span>
<span class="normal"><a href="#__codelineno-43-3">3</a></span>
<span class="normal"><a href="#__codelineno-43-4">4</a></span>
<span class="normal"><a href="#__codelineno-43-5">5</a></span>
<span class="normal"><a href="#__codelineno-43-6">6</a></span>
<span class="normal"><a href="#__codelineno-43-7">7</a></span>
<span class="normal"><a href="#__codelineno-43-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1"></a><span class="c1"># myapp/templatetags/user_tags.py</span>
<a id="__codelineno-43-2" name="__codelineno-43-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django</span><span class="w"> </span><span class="kn">import</span> <span class="n">template</span>
<a id="__codelineno-43-3" name="__codelineno-43-3"></a>
<a id="__codelineno-43-4" name="__codelineno-43-4"></a><span class="n">register</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">Library</span><span class="p">()</span>
<a id="__codelineno-43-5" name="__codelineno-43-5"></a>
<a id="__codelineno-43-6" name="__codelineno-43-6"></a><span class="nd">@register</span><span class="o">.</span><span class="n">simple_tag</span>
<a id="__codelineno-43-7" name="__codelineno-43-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">full_name</span><span class="p">(</span><span class="n">user</span><span class="p">):</span>
<a id="__codelineno-43-8" name="__codelineno-43-8"></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">first_name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">last_name</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
<p><strong>Usage in Template:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-44-1">1</a></span>
<span class="normal"><a href="#__codelineno-44-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1"></a><span class="cp">{%</span> <span class="k">load</span> <span class="nv">user_tags</span> <span class="cp">%}</span>
<a id="__codelineno-44-2" name="__codelineno-44-2"></a><span class="x">&lt;h1&gt;Welcome, </span><span class="cp">{%</span> <span class="k">full_name</span> <span class="nv">user</span> <span class="cp">%}</span><span class="x">!&lt;/h1&gt;</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="b-custom-context-processor-to-include-current-year">b. Custom Context Processor to Include Current Year</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-45-1">1</a></span>
<span class="normal"><a href="#__codelineno-45-2">2</a></span>
<span class="normal"><a href="#__codelineno-45-3">3</a></span>
<span class="normal"><a href="#__codelineno-45-4">4</a></span>
<span class="normal"><a href="#__codelineno-45-5">5</a></span>
<span class="normal"><a href="#__codelineno-45-6">6</a></span>
<span class="normal"><a href="#__codelineno-45-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1"></a><span class="c1"># myapp/context_processors.py</span>
<a id="__codelineno-45-2" name="__codelineno-45-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
<a id="__codelineno-45-3" name="__codelineno-45-3"></a>
<a id="__codelineno-45-4" name="__codelineno-45-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">current_year</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-45-5" name="__codelineno-45-5"></a>    <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-45-6" name="__codelineno-45-6"></a>        <span class="s1">&#39;current_year&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
<a id="__codelineno-45-7" name="__codelineno-45-7"></a>    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p><strong>Register in Settings:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-46-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-46-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-46-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-46-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-46-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-46-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-46-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-46-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-46-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-46-10">10</a></span>
<span class="normal"><a href="#__codelineno-46-11">11</a></span>
<span class="normal"><a href="#__codelineno-46-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-46-2" name="__codelineno-46-2"></a><span class="n">TEMPLATES</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-46-3" name="__codelineno-46-3"></a>    <span class="p">{</span>
<a id="__codelineno-46-4" name="__codelineno-46-4"></a>        <span class="c1"># ... other settings ...</span>
<a id="__codelineno-46-5" name="__codelineno-46-5"></a>        <span class="s1">&#39;OPTIONS&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-46-6" name="__codelineno-46-6"></a>            <span class="s1">&#39;context_processors&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-46-7" name="__codelineno-46-7"></a>                <span class="c1"># ... default context processors ...</span>
<a id="__codelineno-46-8" name="__codelineno-46-8"></a>                <span class="s1">&#39;myapp.context_processors.current_year&#39;</span><span class="p">,</span>
<a id="__codelineno-46-9" name="__codelineno-46-9"></a>            <span class="p">],</span>
<a id="__codelineno-46-10" name="__codelineno-46-10"></a>        <span class="p">},</span>
<a id="__codelineno-46-11" name="__codelineno-46-11"></a>    <span class="p">},</span>
<a id="__codelineno-46-12" name="__codelineno-46-12"></a><span class="p">]</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Usage in Template:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-47-1">1</a></span>
<span class="normal"><a href="#__codelineno-47-2">2</a></span>
<span class="normal"><a href="#__codelineno-47-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1"></a><span class="x">&lt;footer&gt;</span>
<a id="__codelineno-47-2" name="__codelineno-47-2"></a><span class="x">    &amp;copy; </span><span class="cp">{{</span> <span class="nv">current_year</span> <span class="cp">}}</span><span class="x"> My Awesome Site</span>
<a id="__codelineno-47-3" name="__codelineno-47-3"></a><span class="x">&lt;/footer&gt;</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="6-advanced-context-processors">6. Advanced Context Processors</h3>
<p><strong>Example: Injecting Global Settings</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-48-1">1</a></span>
<span class="normal"><a href="#__codelineno-48-2">2</a></span>
<span class="normal"><a href="#__codelineno-48-3">3</a></span>
<span class="normal"><a href="#__codelineno-48-4">4</a></span>
<span class="normal"><a href="#__codelineno-48-5">5</a></span>
<span class="normal"><a href="#__codelineno-48-6">6</a></span>
<span class="normal"><a href="#__codelineno-48-7">7</a></span>
<span class="normal"><a href="#__codelineno-48-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1"></a><span class="c1"># myapp/context_processors.py</span>
<a id="__codelineno-48-2" name="__codelineno-48-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.conf</span><span class="w"> </span><span class="kn">import</span> <span class="n">settings</span>
<a id="__codelineno-48-3" name="__codelineno-48-3"></a>
<a id="__codelineno-48-4" name="__codelineno-48-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">global_settings</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-48-5" name="__codelineno-48-5"></a>    <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-48-6" name="__codelineno-48-6"></a>        <span class="s1">&#39;SITE_NAME&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">SITE_NAME</span><span class="p">,</span>
<a id="__codelineno-48-7" name="__codelineno-48-7"></a>        <span class="s1">&#39;MAINTENANCE_MODE&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">MAINTENANCE_MODE</span><span class="p">,</span>
<a id="__codelineno-48-8" name="__codelineno-48-8"></a>    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p><strong>Usage in Template:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-49-1">1</a></span>
<span class="normal"><a href="#__codelineno-49-2">2</a></span>
<span class="normal"><a href="#__codelineno-49-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1"></a><span class="cp">{%</span> <span class="k">if</span> <span class="nv">MAINTENANCE_MODE</span> <span class="cp">%}</span>
<a id="__codelineno-49-2" name="__codelineno-49-2"></a><span class="x">    &lt;div class=&quot;alert&quot;&gt;Site is under maintenance.&lt;/div&gt;</span>
<a id="__codelineno-49-3" name="__codelineno-49-3"></a><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Conclusion:</strong><br />
Extending Django's template system with custom tags, filters, and context processors allows for more dynamic, reusable, and maintainable templates. By following best practices and leveraging advanced features, developers can create powerful templating solutions tailored to their application's needs.</p>
<hr />
<h1 id="4-django-signals-and-their-applications">4. Django Signals and Their Applications</h1>
<p><strong>Question:</strong><br />
What are Django signals, and how can they be used to decouple components within a Django application? Provide an example of using signals to perform actions such as sending a welcome email after a new user registers.</p>
<p><strong>Answer:</strong></p>
<p>Django Signals facilitate decoupled communication between components, allowing certain senders to notify receivers when specific actions occur. This promotes a modular architecture, enabling components to react to events without direct dependencies.</p>
<h3 id="1-understanding-django-signals">1. Understanding Django Signals</h3>
<ul>
<li><strong>Senders:</strong> Emit signals (e.g., Django models like <code>User</code>).</li>
<li><strong>Receivers:</strong> Functions that respond to signals.</li>
<li><strong>Common Signals:</strong></li>
<li><code>pre_save</code> / <code>post_save</code>: Before/after a model's <code>save()</code> method.</li>
<li><code>pre_delete</code> / <code>post_delete</code>: Before/after a model's <code>delete()</code> method.</li>
<li><code>m2m_changed</code>: When a <code>ManyToManyField</code> is altered.</li>
</ul>
<h3 id="2-benefits-of-using-signals">2. Benefits of Using Signals</h3>
<ul>
<li><strong>Decoupling:</strong> Components can interact without direct references.</li>
<li><strong>Reusability:</strong> Receivers can be reused across different parts of the application.</li>
<li><strong>Maintainability:</strong> Separates concerns, making the codebase cleaner.</li>
</ul>
<h3 id="3-example-scenario-sending-a-welcome-email-after-user-registration">3. Example Scenario: Sending a Welcome Email After User Registration</h3>
<h4 id="a-define-the-receiver-function">a. Define the Receiver Function</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-50-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-50-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-50-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-50-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-50-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-50-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-50-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-50-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-50-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-50-10">10</a></span>
<span class="normal"><a href="#__codelineno-50-11">11</a></span>
<span class="normal"><a href="#__codelineno-50-12">12</a></span>
<span class="normal"><a href="#__codelineno-50-13">13</a></span>
<span class="normal"><a href="#__codelineno-50-14">14</a></span>
<span class="normal"><a href="#__codelineno-50-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1"></a><span class="c1"># myapp/signals.py</span>
<a id="__codelineno-50-2" name="__codelineno-50-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.db.models.signals</span><span class="w"> </span><span class="kn">import</span> <span class="n">post_save</span>
<a id="__codelineno-50-3" name="__codelineno-50-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.dispatch</span><span class="w"> </span><span class="kn">import</span> <span class="n">receiver</span>
<a id="__codelineno-50-4" name="__codelineno-50-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">User</span>
<a id="__codelineno-50-5" name="__codelineno-50-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.core.mail</span><span class="w"> </span><span class="kn">import</span> <span class="n">send_mail</span>
<a id="__codelineno-50-6" name="__codelineno-50-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.conf</span><span class="w"> </span><span class="kn">import</span> <span class="n">settings</span>
<a id="__codelineno-50-7" name="__codelineno-50-7"></a>
<a id="__codelineno-50-8" name="__codelineno-50-8"></a><span class="nd">@receiver</span><span class="p">(</span><span class="n">post_save</span><span class="p">,</span> <span class="n">sender</span><span class="o">=</span><span class="n">User</span><span class="p">)</span>
<a id="__codelineno-50-9" name="__codelineno-50-9"></a><span class="k">def</span><span class="w"> </span><span class="nf">send_welcome_email</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">created</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-50-10" name="__codelineno-50-10"></a>    <span class="k">if</span> <span class="n">created</span><span class="p">:</span>
<a id="__codelineno-50-11" name="__codelineno-50-11"></a>        <span class="n">subject</span> <span class="o">=</span> <span class="s1">&#39;Welcome to My Awesome Site!&#39;</span>
<a id="__codelineno-50-12" name="__codelineno-50-12"></a>        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Hi </span><span class="si">{</span><span class="n">instance</span><span class="o">.</span><span class="n">username</span><span class="si">}</span><span class="s1">, thank you for registering at our site.&#39;</span>
<a id="__codelineno-50-13" name="__codelineno-50-13"></a>        <span class="n">from_email</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">DEFAULT_FROM_EMAIL</span>
<a id="__codelineno-50-14" name="__codelineno-50-14"></a>        <span class="n">recipient_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">instance</span><span class="o">.</span><span class="n">email</span><span class="p">]</span>
<a id="__codelineno-50-15" name="__codelineno-50-15"></a>        <span class="n">send_mail</span><span class="p">(</span><span class="n">subject</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">from_email</span><span class="p">,</span> <span class="n">recipient_list</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h4 id="b-register-the-signals">b. Register the Signals</h4>
<p>Ensure the signal receivers are connected when the application starts by importing <code>signals.py</code> in <code>apps.py</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-51-1">1</a></span>
<span class="normal"><a href="#__codelineno-51-2">2</a></span>
<span class="normal"><a href="#__codelineno-51-3">3</a></span>
<span class="normal"><a href="#__codelineno-51-4">4</a></span>
<span class="normal"><a href="#__codelineno-51-5">5</a></span>
<span class="normal"><a href="#__codelineno-51-6">6</a></span>
<span class="normal"><a href="#__codelineno-51-7">7</a></span>
<span class="normal"><a href="#__codelineno-51-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1"></a><span class="c1"># myapp/apps.py</span>
<a id="__codelineno-51-2" name="__codelineno-51-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.apps</span><span class="w"> </span><span class="kn">import</span> <span class="n">AppConfig</span>
<a id="__codelineno-51-3" name="__codelineno-51-3"></a>
<a id="__codelineno-51-4" name="__codelineno-51-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyappConfig</span><span class="p">(</span><span class="n">AppConfig</span><span class="p">):</span>
<a id="__codelineno-51-5" name="__codelineno-51-5"></a>    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;myapp&#39;</span>
<a id="__codelineno-51-6" name="__codelineno-51-6"></a>
<a id="__codelineno-51-7" name="__codelineno-51-7"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-51-8" name="__codelineno-51-8"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">myapp.signals</span>
</code></pre></div></td></tr></table></div>
<p>Update <code>__init__.py</code> to specify the app config.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-52-1">1</a></span>
<span class="normal"><a href="#__codelineno-52-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1"></a><span class="c1"># myapp/__init__.py</span>
<a id="__codelineno-52-2" name="__codelineno-52-2"></a><span class="n">default_app_config</span> <span class="o">=</span> <span class="s1">&#39;myapp.apps.MyappConfig&#39;</span>
</code></pre></div></td></tr></table></div>
<h4 id="c-configure-email-settings">c. Configure Email Settings</h4>
<p>Ensure email settings are properly configured in <code>settings.py</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-53-1">1</a></span>
<span class="normal"><a href="#__codelineno-53-2">2</a></span>
<span class="normal"><a href="#__codelineno-53-3">3</a></span>
<span class="normal"><a href="#__codelineno-53-4">4</a></span>
<span class="normal"><a href="#__codelineno-53-5">5</a></span>
<span class="normal"><a href="#__codelineno-53-6">6</a></span>
<span class="normal"><a href="#__codelineno-53-7">7</a></span>
<span class="normal"><a href="#__codelineno-53-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-53-2" name="__codelineno-53-2"></a><span class="n">EMAIL_BACKEND</span> <span class="o">=</span> <span class="s1">&#39;django.core.mail.backends.smtp.EmailBackend&#39;</span>
<a id="__codelineno-53-3" name="__codelineno-53-3"></a><span class="n">EMAIL_HOST</span> <span class="o">=</span> <span class="s1">&#39;smtp.example.com&#39;</span>
<a id="__codelineno-53-4" name="__codelineno-53-4"></a><span class="n">EMAIL_PORT</span> <span class="o">=</span> <span class="mi">587</span>
<a id="__codelineno-53-5" name="__codelineno-53-5"></a><span class="n">EMAIL_HOST_USER</span> <span class="o">=</span> <span class="s1">&#39;your-email@example.com&#39;</span>
<a id="__codelineno-53-6" name="__codelineno-53-6"></a><span class="n">EMAIL_HOST_PASSWORD</span> <span class="o">=</span> <span class="s1">&#39;your-email-password&#39;</span>
<a id="__codelineno-53-7" name="__codelineno-53-7"></a><span class="n">EMAIL_USE_TLS</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-53-8" name="__codelineno-53-8"></a><span class="n">DEFAULT_FROM_EMAIL</span> <span class="o">=</span> <span class="s1">&#39;Your Site &lt;noreply@mysite.com&gt;&#39;</span>
</code></pre></div></td></tr></table></div>
<h3 id="4-advanced-use-cases-for-signals">4. Advanced Use Cases for Signals</h3>
<h4 id="a-logging-model-changes">a. Logging Model Changes</h4>
<p>Automatically log changes when models are created, updated, or deleted.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-54-1">1</a></span>
<span class="normal"><a href="#__codelineno-54-2">2</a></span>
<span class="normal"><a href="#__codelineno-54-3">3</a></span>
<span class="normal"><a href="#__codelineno-54-4">4</a></span>
<span class="normal"><a href="#__codelineno-54-5">5</a></span>
<span class="normal"><a href="#__codelineno-54-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1"></a><span class="nd">@receiver</span><span class="p">(</span><span class="n">post_save</span><span class="p">,</span> <span class="n">sender</span><span class="o">=</span><span class="n">Product</span><span class="p">)</span>
<a id="__codelineno-54-2" name="__codelineno-54-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">log_product_save</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">created</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-54-3" name="__codelineno-54-3"></a>    <span class="k">if</span> <span class="n">created</span><span class="p">:</span>
<a id="__codelineno-54-4" name="__codelineno-54-4"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Product created: </span><span class="si">{</span><span class="n">instance</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-54-5" name="__codelineno-54-5"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-54-6" name="__codelineno-54-6"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Product updated: </span><span class="si">{</span><span class="n">instance</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h4 id="b-cache-invalidation">b. Cache Invalidation</h4>
<p>Clear or update cache when certain models change to ensure data consistency.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-55-1">1</a></span>
<span class="normal"><a href="#__codelineno-55-2">2</a></span>
<span class="normal"><a href="#__codelineno-55-3">3</a></span>
<span class="normal"><a href="#__codelineno-55-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1"></a><span class="nd">@receiver</span><span class="p">(</span><span class="n">post_save</span><span class="p">,</span> <span class="n">sender</span><span class="o">=</span><span class="n">Article</span><span class="p">)</span>
<a id="__codelineno-55-2" name="__codelineno-55-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">invalidate_article_cache</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-55-3" name="__codelineno-55-3"></a>    <span class="n">cache_key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;article_</span><span class="si">{</span><span class="n">instance</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-55-4" name="__codelineno-55-4"></a>    <span class="n">cache</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h4 id="c-third-party-integrations">c. Third-Party Integrations</h4>
<p>Notify external services when specific actions occur.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-56-1">1</a></span>
<span class="normal"><a href="#__codelineno-56-2">2</a></span>
<span class="normal"><a href="#__codelineno-56-3">3</a></span>
<span class="normal"><a href="#__codelineno-56-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1"></a><span class="nd">@receiver</span><span class="p">(</span><span class="n">post_save</span><span class="p">,</span> <span class="n">sender</span><span class="o">=</span><span class="n">Order</span><span class="p">)</span>
<a id="__codelineno-56-2" name="__codelineno-56-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">notify_third_party</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">created</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-56-3" name="__codelineno-56-3"></a>    <span class="k">if</span> <span class="n">created</span><span class="p">:</span>
<a id="__codelineno-56-4" name="__codelineno-56-4"></a>        <span class="n">send_order_to_third_party</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="5-best-practices">5. Best Practices</h3>
<ul>
<li><strong>Avoid Complex Logic in Receivers:</strong> Keep receivers simple to prevent performance issues.</li>
<li><strong>Use Signals Judiciously:</strong> Overusing signals can lead to a tangled codebase; prefer explicit method calls when appropriate.</li>
<li><strong>Handle Exceptions Gracefully:</strong> Ensure receivers handle exceptions to avoid disrupting the main application flow.</li>
<li><strong>Document Signal Usage:</strong> Clearly document the purpose and functionality of each signal handler for maintainability.</li>
<li><strong>Prevent Duplicate Signal Registrations:</strong> Ensure signals are registered once, typically in <code>apps.py</code>, to avoid multiple executions.</li>
</ul>
<h3 id="6-potential-pitfalls">6. Potential Pitfalls</h3>
<ul>
<li><strong>Hidden Dependencies:</strong> Signals can introduce implicit dependencies, making the code harder to trace.</li>
<li><strong>Performance Overhead:</strong> Excessive signal handling can impact performance.</li>
<li><strong>Testing Challenges:</strong> Signals may require additional setup in tests to ensure they are triggered appropriately.</li>
</ul>
<h3 id="7-example-advanced-signal-handling-with-asynchronous-tasks">7. Example: Advanced Signal Handling with Asynchronous Tasks</h3>
<p>Integrate with Celery to handle time-consuming tasks asynchronously.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-57-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-57-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-57-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-57-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-57-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-57-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-57-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-57-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-57-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-57-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1"></a><span class="c1"># myapp/signals.py</span>
<a id="__codelineno-57-2" name="__codelineno-57-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.db.models.signals</span><span class="w"> </span><span class="kn">import</span> <span class="n">post_save</span>
<a id="__codelineno-57-3" name="__codelineno-57-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.dispatch</span><span class="w"> </span><span class="kn">import</span> <span class="n">receiver</span>
<a id="__codelineno-57-4" name="__codelineno-57-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">User</span>
<a id="__codelineno-57-5" name="__codelineno-57-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">send_welcome_email_task</span>
<a id="__codelineno-57-6" name="__codelineno-57-6"></a>
<a id="__codelineno-57-7" name="__codelineno-57-7"></a><span class="nd">@receiver</span><span class="p">(</span><span class="n">post_save</span><span class="p">,</span> <span class="n">sender</span><span class="o">=</span><span class="n">User</span><span class="p">)</span>
<a id="__codelineno-57-8" name="__codelineno-57-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">send_welcome_email</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">created</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-57-9" name="__codelineno-57-9"></a>    <span class="k">if</span> <span class="n">created</span><span class="p">:</span>
<a id="__codelineno-57-10" name="__codelineno-57-10"></a>        <span class="n">send_welcome_email_task</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-58-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-58-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-58-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-58-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-58-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-58-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-58-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-58-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-58-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-58-10">10</a></span>
<span class="normal"><a href="#__codelineno-58-11">11</a></span>
<span class="normal"><a href="#__codelineno-58-12">12</a></span>
<span class="normal"><a href="#__codelineno-58-13">13</a></span>
<span class="normal"><a href="#__codelineno-58-14">14</a></span>
<span class="normal"><a href="#__codelineno-58-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1"></a><span class="c1"># myapp/tasks.py</span>
<a id="__codelineno-58-2" name="__codelineno-58-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">shared_task</span>
<a id="__codelineno-58-3" name="__codelineno-58-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">User</span>
<a id="__codelineno-58-4" name="__codelineno-58-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.core.mail</span><span class="w"> </span><span class="kn">import</span> <span class="n">send_mail</span>
<a id="__codelineno-58-5" name="__codelineno-58-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.conf</span><span class="w"> </span><span class="kn">import</span> <span class="n">settings</span>
<a id="__codelineno-58-6" name="__codelineno-58-6"></a>
<a id="__codelineno-58-7" name="__codelineno-58-7"></a><span class="nd">@shared_task</span>
<a id="__codelineno-58-8" name="__codelineno-58-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">send_welcome_email_task</span><span class="p">(</span><span class="n">user_id</span><span class="p">):</span>
<a id="__codelineno-58-9" name="__codelineno-58-9"></a>    <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">user_id</span><span class="p">)</span>
<a id="__codelineno-58-10" name="__codelineno-58-10"></a>    <span class="n">send_mail</span><span class="p">(</span>
<a id="__codelineno-58-11" name="__codelineno-58-11"></a>        <span class="s1">&#39;Welcome!&#39;</span><span class="p">,</span>
<a id="__codelineno-58-12" name="__codelineno-58-12"></a>        <span class="sa">f</span><span class="s1">&#39;Hi </span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="si">}</span><span class="s1">, welcome to our platform!&#39;</span><span class="p">,</span>
<a id="__codelineno-58-13" name="__codelineno-58-13"></a>        <span class="n">settings</span><span class="o">.</span><span class="n">DEFAULT_FROM_EMAIL</span><span class="p">,</span>
<a id="__codelineno-58-14" name="__codelineno-58-14"></a>        <span class="p">[</span><span class="n">user</span><span class="o">.</span><span class="n">email</span><span class="p">],</span>
<a id="__codelineno-58-15" name="__codelineno-58-15"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p><strong>Conclusion:</strong><br />
Django Signals provide a powerful mechanism for decoupled component interaction, enabling actions like sending emails, logging, and cache management without tight coupling. By following best practices and being aware of potential pitfalls, developers can effectively leverage signals to build modular and maintainable applications.</p>
<hr />
<h1 id="5-asynchronous-support-in-django">5. Asynchronous Support in Django</h1>
<p><strong>Question:</strong><br />
With the introduction of asynchronous views in Django 3.1+, how can you leverage async features to improve the performance of your Django applications? Discuss best practices and potential challenges when integrating async code with traditional synchronous Django components.</p>
<p><strong>Answer:</strong></p>
<p>Asynchronous (Async) support in Django allows handling I/O-bound tasks more efficiently by enabling non-blocking operations. This improves performance and scalability, particularly for applications with high concurrency or real-time features.</p>
<h3 id="1-understanding-async-in-django">1. Understanding Async in Django</h3>
<ul>
<li><strong>Async Views:</strong> Defined with <code>async def</code>, allowing the use of <code>await</code> for asynchronous operations.</li>
<li><strong>ASGI Support:</strong> Django's ASGI interface enables handling of asynchronous protocols like WebSockets.</li>
<li><strong>Compatibility:</strong> Middleware, ORM operations, and third-party packages have varying levels of async support.</li>
</ul>
<h3 id="2-leveraging-async-features">2. Leveraging Async Features</h3>
<h4 id="a-writing-async-views">a. Writing Async Views</h4>
<p>Async views can handle concurrent requests more efficiently, especially during I/O operations.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-59-1">1</a></span>
<span class="normal"><a href="#__codelineno-59-2">2</a></span>
<span class="normal"><a href="#__codelineno-59-3">3</a></span>
<span class="normal"><a href="#__codelineno-59-4">4</a></span>
<span class="normal"><a href="#__codelineno-59-5">5</a></span>
<span class="normal"><a href="#__codelineno-59-6">6</a></span>
<span class="normal"><a href="#__codelineno-59-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1"></a><span class="c1"># myapp/views.py</span>
<a id="__codelineno-59-2" name="__codelineno-59-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">JsonResponse</span>
<a id="__codelineno-59-3" name="__codelineno-59-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<a id="__codelineno-59-4" name="__codelineno-59-4"></a>
<a id="__codelineno-59-5" name="__codelineno-59-5"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">async_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-59-6" name="__codelineno-59-6"></a>    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Simulate async I/O operation</span>
<a id="__codelineno-59-7" name="__codelineno-59-7"></a>    <span class="k">return</span> <span class="n">JsonResponse</span><span class="p">({</span><span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;This is an async view&#39;</span><span class="p">})</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="b-asynchronous-middleware">b. Asynchronous Middleware</h4>
<p>Define middleware with <code>async def</code> to handle asynchronous request/response processing.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-60-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-60-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-60-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-60-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-60-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-60-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-60-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-60-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-60-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-60-10">10</a></span>
<span class="normal"><a href="#__codelineno-60-11">11</a></span>
<span class="normal"><a href="#__codelineno-60-12">12</a></span>
<span class="normal"><a href="#__codelineno-60-13">13</a></span>
<span class="normal"><a href="#__codelineno-60-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1"></a><span class="c1"># myapp/middleware.py</span>
<a id="__codelineno-60-2" name="__codelineno-60-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<a id="__codelineno-60-3" name="__codelineno-60-3"></a>
<a id="__codelineno-60-4" name="__codelineno-60-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">AsyncLoggingMiddleware</span><span class="p">:</span>
<a id="__codelineno-60-5" name="__codelineno-60-5"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_response</span><span class="p">):</span>
<a id="__codelineno-60-6" name="__codelineno-60-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_response</span> <span class="o">=</span> <span class="n">get_response</span>
<a id="__codelineno-60-7" name="__codelineno-60-7"></a>
<a id="__codelineno-60-8" name="__codelineno-60-8"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
<a id="__codelineno-60-9" name="__codelineno-60-9"></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<a id="__codelineno-60-10" name="__codelineno-60-10"></a>        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_response</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<a id="__codelineno-60-11" name="__codelineno-60-11"></a>        <span class="n">duration</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
<a id="__codelineno-60-12" name="__codelineno-60-12"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Async view took </span><span class="si">{</span><span class="n">duration</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<a id="__codelineno-60-13" name="__codelineno-60-13"></a>        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;X-Async-Duration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">duration</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span>
<a id="__codelineno-60-14" name="__codelineno-60-14"></a>        <span class="k">return</span> <span class="n">response</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="c-asynchronous-orm-operations">c. Asynchronous ORM Operations</h4>
<p>While Django’s ORM is primarily synchronous, you can use <code>sync_to_async</code> to run ORM queries without blocking the event loop.</p>
<p><strong>Example Using <code>sync_to_async</code>:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-61-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-61-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-61-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-61-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-61-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-61-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-61-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-61-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-61-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-61-10">10</a></span>
<span class="normal"><a href="#__codelineno-61-11">11</a></span>
<span class="normal"><a href="#__codelineno-61-12">12</a></span>
<span class="normal"><a href="#__codelineno-61-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1"></a><span class="c1"># myapp/views.py</span>
<a id="__codelineno-61-2" name="__codelineno-61-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">JsonResponse</span>
<a id="__codelineno-61-3" name="__codelineno-61-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">asgiref.sync</span><span class="w"> </span><span class="kn">import</span> <span class="n">sync_to_async</span>
<a id="__codelineno-61-4" name="__codelineno-61-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">User</span>
<a id="__codelineno-61-5" name="__codelineno-61-5"></a>
<a id="__codelineno-61-6" name="__codelineno-61-6"></a><span class="nd">@sync_to_async</span>
<a id="__codelineno-61-7" name="__codelineno-61-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_users</span><span class="p">():</span>
<a id="__codelineno-61-8" name="__codelineno-61-8"></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
<a id="__codelineno-61-9" name="__codelineno-61-9"></a>
<a id="__codelineno-61-10" name="__codelineno-61-10"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">async_user_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-61-11" name="__codelineno-61-11"></a>    <span class="n">users</span> <span class="o">=</span> <span class="k">await</span> <span class="n">get_users</span><span class="p">()</span>
<a id="__codelineno-61-12" name="__codelineno-61-12"></a>    <span class="n">user_data</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="p">}</span> <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">users</span><span class="p">]</span>
<a id="__codelineno-61-13" name="__codelineno-61-13"></a>    <span class="k">return</span> <span class="n">JsonResponse</span><span class="p">({</span><span class="s1">&#39;users&#39;</span><span class="p">:</span> <span class="n">user_data</span><span class="p">})</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Note:</strong> Complete async ORM support is ongoing; for intensive database operations, consider offloading to sync contexts.</p>
<h3 id="3-best-practices-for-integrating-async-code">3. Best Practices for Integrating Async Code</h3>
<h4 id="a-use-async-for-io-bound-tasks">a. Use Async for I/O-Bound Tasks</h4>
<p>Leverage async for operations involving network requests, file I/O, or database interactions where async support exists.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-62-1">1</a></span>
<span class="normal"><a href="#__codelineno-62-2">2</a></span>
<span class="normal"><a href="#__codelineno-62-3">3</a></span>
<span class="normal"><a href="#__codelineno-62-4">4</a></span>
<span class="normal"><a href="#__codelineno-62-5">5</a></span>
<span class="normal"><a href="#__codelineno-62-6">6</a></span>
<span class="normal"><a href="#__codelineno-62-7">7</a></span>
<span class="normal"><a href="#__codelineno-62-8">8</a></span>
<span class="normal"><a href="#__codelineno-62-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1"></a><span class="c1"># myapp/views.py</span>
<a id="__codelineno-62-2" name="__codelineno-62-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">aiohttp</span>
<a id="__codelineno-62-3" name="__codelineno-62-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">JsonResponse</span>
<a id="__codelineno-62-4" name="__codelineno-62-4"></a>
<a id="__codelineno-62-5" name="__codelineno-62-5"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">fetch_data</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-62-6" name="__codelineno-62-6"></a>    <span class="k">async</span> <span class="k">with</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientSession</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
<a id="__codelineno-62-7" name="__codelineno-62-7"></a>        <span class="k">async</span> <span class="k">with</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://api.example.com/data&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">resp</span><span class="p">:</span>
<a id="__codelineno-62-8" name="__codelineno-62-8"></a>            <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<a id="__codelineno-62-9" name="__codelineno-62-9"></a>    <span class="k">return</span> <span class="n">JsonResponse</span><span class="p">({</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="b-avoid-blocking-operations">b. Avoid Blocking Operations</h4>
<p>Ensure that async code does not perform CPU-bound or blocking operations, which can hinder performance.</p>
<p><strong>Solution:</strong> Offload CPU-bound tasks to separate threads or processes using <code>concurrent.futures</code>.</p>
<h4 id="c-utilize-sync_to_async-and-database_sync_to_async-carefully">c. Utilize <code>sync_to_async</code> and <code>database_sync_to_async</code> Carefully</h4>
<p>Minimize the use of these wrappers to maintain the benefits of async code.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-63-1">1</a></span>
<span class="normal"><a href="#__codelineno-63-2">2</a></span>
<span class="normal"><a href="#__codelineno-63-3">3</a></span>
<span class="normal"><a href="#__codelineno-63-4">4</a></span>
<span class="normal"><a href="#__codelineno-63-5">5</a></span>
<span class="normal"><a href="#__codelineno-63-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">asgiref.sync</span><span class="w"> </span><span class="kn">import</span> <span class="n">sync_to_async</span>
<a id="__codelineno-63-2" name="__codelineno-63-2"></a>
<a id="__codelineno-63-3" name="__codelineno-63-3"></a><span class="nd">@sync_to_async</span>
<a id="__codelineno-63-4" name="__codelineno-63-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">perform_sync_task</span><span class="p">():</span>
<a id="__codelineno-63-5" name="__codelineno-63-5"></a>    <span class="c1"># Synchronous task</span>
<a id="__codelineno-63-6" name="__codelineno-63-6"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="d-middleware-ordering">d. Middleware Ordering</h4>
<p>Ensure that async middleware is placed correctly in the <code>MIDDLEWARE</code> list to maintain compatibility.</p>
<h4 id="e-testing-async-views">e. Testing Async Views</h4>
<p>Use asynchronous testing frameworks like <code>pytest-asyncio</code> to effectively test async views.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-64-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-64-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-64-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-64-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-64-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-64-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-64-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-64-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-64-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-64-10">10</a></span>
<span class="normal"><a href="#__codelineno-64-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1"></a><span class="c1"># tests/test_async_views.py</span>
<a id="__codelineno-64-2" name="__codelineno-64-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<a id="__codelineno-64-3" name="__codelineno-64-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">reverse</span>
<a id="__codelineno-64-4" name="__codelineno-64-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">httpx</span><span class="w"> </span><span class="kn">import</span> <span class="n">AsyncClient</span>
<a id="__codelineno-64-5" name="__codelineno-64-5"></a>
<a id="__codelineno-64-6" name="__codelineno-64-6"></a><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<a id="__codelineno-64-7" name="__codelineno-64-7"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_async_view</span><span class="p">():</span>
<a id="__codelineno-64-8" name="__codelineno-64-8"></a>    <span class="k">async</span> <span class="k">with</span> <span class="n">AsyncClient</span><span class="p">()</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
<a id="__codelineno-64-9" name="__codelineno-64-9"></a>        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;async_view&#39;</span><span class="p">))</span>
<a id="__codelineno-64-10" name="__codelineno-64-10"></a>        <span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span>
<a id="__codelineno-64-11" name="__codelineno-64-11"></a>        <span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;This is an async view&#39;</span><span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="f-combine-async-and-sync-carefully">f. Combine Async and Sync Carefully</h4>
<p>Mixing async and sync code requires careful handling to prevent blocking. Avoid calling sync code directly within async contexts.</p>
<h3 id="4-potential-challenges">4. Potential Challenges</h3>
<h4 id="a-limited-async-orm-support">a. Limited Async ORM Support</h4>
<p>Django’s ORM remains largely synchronous, limiting the performance gains of async views involving database operations.</p>
<p><strong>Solution:</strong> Offload database operations using <code>sync_to_async</code>, but be mindful of the associated overhead.</p>
<h4 id="b-middleware-compatibility">b. Middleware Compatibility</h4>
<p>Not all middleware is async-compatible. Ensure that all middleware in the stack supports async to prevent runtime issues.</p>
<h4 id="c-third-party-package-support">c. Third-Party Package Support</h4>
<p>Many Django packages are synchronous, requiring wrapping with <code>sync_to_async</code>, potentially reducing performance benefits.</p>
<h4 id="d-increased-complexity">d. Increased Complexity</h4>
<p>Async code introduces additional complexity, requiring understanding of event loops, concurrency, and async patterns.</p>
<h4 id="e-deployment-considerations">e. Deployment Considerations</h4>
<p>Deploying async Django applications necessitates ASGI-compatible servers like Daphne or Uvicorn instead of traditional WSGI servers like Gunicorn.</p>
<h3 id="5-deployment-of-async-django-applications">5. Deployment of Async Django Applications</h3>
<h4 id="a-choose-an-asgi-server">a. Choose an ASGI Server</h4>
<ul>
<li><strong>Uvicorn:</strong> A lightning-fast ASGI server suitable for Django async applications.</li>
<li><strong>Daphne:</strong> Developed for Django Channels but can be used independently.</li>
</ul>
<p><strong>Example Using Uvicorn:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-65-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-65-1" name="__codelineno-65-1"></a>uvicorn<span class="w"> </span>myproject.asgi:application<span class="w"> </span>--host<span class="w"> </span><span class="m">0</span>.0.0.0<span class="w"> </span>--port<span class="w"> </span><span class="m">8000</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="b-configure-the-asgi-application">b. Configure the ASGI Application</h4>
<p>Ensure <code>asgi.py</code> is properly set up.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-66-1">1</a></span>
<span class="normal"><a href="#__codelineno-66-2">2</a></span>
<span class="normal"><a href="#__codelineno-66-3">3</a></span>
<span class="normal"><a href="#__codelineno-66-4">4</a></span>
<span class="normal"><a href="#__codelineno-66-5">5</a></span>
<span class="normal"><a href="#__codelineno-66-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-66-1" name="__codelineno-66-1"></a><span class="c1"># myproject/asgi.py</span>
<a id="__codelineno-66-2" name="__codelineno-66-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-66-3" name="__codelineno-66-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.core.asgi</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_asgi_application</span>
<a id="__codelineno-66-4" name="__codelineno-66-4"></a>
<a id="__codelineno-66-5" name="__codelineno-66-5"></a><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;DJANGO_SETTINGS_MODULE&#39;</span><span class="p">,</span> <span class="s1">&#39;myproject.settings&#39;</span><span class="p">)</span>
<a id="__codelineno-66-6" name="__codelineno-66-6"></a><span class="n">application</span> <span class="o">=</span> <span class="n">get_asgi_application</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<h4 id="c-integrate-with-reverse-proxy-eg-nginx">c. Integrate with Reverse Proxy (e.g., Nginx)</h4>
<p>Configure Nginx to proxy pass to the ASGI server.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-67-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-67-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-67-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-67-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-67-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-67-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-67-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-67-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-67-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-67-10">10</a></span>
<span class="normal"><a href="#__codelineno-67-11">11</a></span>
<span class="normal"><a href="#__codelineno-67-12">12</a></span>
<span class="normal"><a href="#__codelineno-67-13">13</a></span>
<span class="normal"><a href="#__codelineno-67-14">14</a></span>
<span class="normal"><a href="#__codelineno-67-15">15</a></span>
<span class="normal"><a href="#__codelineno-67-16">16</a></span>
<span class="normal"><a href="#__codelineno-67-17">17</a></span>
<span class="normal"><a href="#__codelineno-67-18">18</a></span>
<span class="normal"><a href="#__codelineno-67-19">19</a></span>
<span class="normal"><a href="#__codelineno-67-20">20</a></span>
<span class="normal"><a href="#__codelineno-67-21">21</a></span>
<span class="normal"><a href="#__codelineno-67-22">22</a></span>
<span class="normal"><a href="#__codelineno-67-23">23</a></span>
<span class="normal"><a href="#__codelineno-67-24">24</a></span>
<span class="normal"><a href="#__codelineno-67-25">25</a></span>
<span class="normal"><a href="#__codelineno-67-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-67-1" name="__codelineno-67-1"></a><span class="c1"># /etc/nginx/sites-available/myproject</span>
<a id="__codelineno-67-2" name="__codelineno-67-2"></a><span class="k">server</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-67-3" name="__codelineno-67-3"></a><span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">80</span><span class="p">;</span>
<a id="__codelineno-67-4" name="__codelineno-67-4"></a><span class="w">    </span><span class="kn">server_name</span><span class="w"> </span><span class="s">example.com</span><span class="w"> </span><span class="s">www.example.com</span><span class="p">;</span>
<a id="__codelineno-67-5" name="__codelineno-67-5"></a>
<a id="__codelineno-67-6" name="__codelineno-67-6"></a><span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/static/</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-67-7" name="__codelineno-67-7"></a><span class="w">        </span><span class="kn">root</span><span class="w"> </span><span class="s">/path/to/myproject</span><span class="p">;</span>
<a id="__codelineno-67-8" name="__codelineno-67-8"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-67-9" name="__codelineno-67-9"></a>
<a id="__codelineno-67-10" name="__codelineno-67-10"></a><span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-67-11" name="__codelineno-67-11"></a><span class="w">        </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://127.0.0.1:8000</span><span class="p">;</span>
<a id="__codelineno-67-12" name="__codelineno-67-12"></a><span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Host</span><span class="w"> </span><span class="nv">$host</span><span class="p">;</span>
<a id="__codelineno-67-13" name="__codelineno-67-13"></a><span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Real-IP</span><span class="w"> </span><span class="nv">$remote_addr</span><span class="p">;</span>
<a id="__codelineno-67-14" name="__codelineno-67-14"></a><span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-For</span><span class="w"> </span><span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
<a id="__codelineno-67-15" name="__codelineno-67-15"></a><span class="w">        </span><span class="kn">proxy_http_version</span><span class="w"> </span><span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
<a id="__codelineno-67-16" name="__codelineno-67-16"></a><span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Upgrade</span><span class="w"> </span><span class="nv">$http_upgrade</span><span class="p">;</span>
<a id="__codelineno-67-17" name="__codelineno-67-17"></a><span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Connection</span><span class="w"> </span><span class="s">&quot;upgrade&quot;</span><span class="p">;</span>
<a id="__codelineno-67-18" name="__codelineno-67-18"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-67-19" name="__codelineno-67-19"></a>
<a id="__codelineno-67-20" name="__codelineno-67-20"></a><span class="w">    </span><span class="c1"># SSL Configuration (optional)</span>
<a id="__codelineno-67-21" name="__codelineno-67-21"></a><span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="s">ssl</span><span class="p">;</span>
<a id="__codelineno-67-22" name="__codelineno-67-22"></a><span class="w">    </span><span class="kn">ssl_certificate</span><span class="w"> </span><span class="s">/etc/letsencrypt/live/example.com/fullchain.pem</span><span class="p">;</span>
<a id="__codelineno-67-23" name="__codelineno-67-23"></a><span class="w">    </span><span class="kn">ssl_certificate_key</span><span class="w"> </span><span class="s">/etc/letsencrypt/live/example.com/privkey.pem</span><span class="p">;</span>
<a id="__codelineno-67-24" name="__codelineno-67-24"></a><span class="w">    </span><span class="kn">include</span><span class="w"> </span><span class="s">/etc/letsencrypt/options-ssl-nginx.conf</span><span class="p">;</span>
<a id="__codelineno-67-25" name="__codelineno-67-25"></a><span class="w">    </span><span class="kn">ssl_dhparam</span><span class="w"> </span><span class="s">/etc/letsencrypt/ssl-dhparams.pem</span><span class="p">;</span>
<a id="__codelineno-67-26" name="__codelineno-67-26"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="6-example-comprehensive-async-view-with-external-api-call">6. Example: Comprehensive Async View with External API Call</h3>
<p><strong>Scenario:</strong> Fetch data from an external API asynchronously and return the result.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-68-1">1</a></span>
<span class="normal"><a href="#__codelineno-68-2">2</a></span>
<span class="normal"><a href="#__codelineno-68-3">3</a></span>
<span class="normal"><a href="#__codelineno-68-4">4</a></span>
<span class="normal"><a href="#__codelineno-68-5">5</a></span>
<span class="normal"><a href="#__codelineno-68-6">6</a></span>
<span class="normal"><a href="#__codelineno-68-7">7</a></span>
<span class="normal"><a href="#__codelineno-68-8">8</a></span>
<span class="normal"><a href="#__codelineno-68-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-68-1" name="__codelineno-68-1"></a><span class="c1"># myapp/views.py</span>
<a id="__codelineno-68-2" name="__codelineno-68-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">JsonResponse</span>
<a id="__codelineno-68-3" name="__codelineno-68-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">aiohttp</span>
<a id="__codelineno-68-4" name="__codelineno-68-4"></a>
<a id="__codelineno-68-5" name="__codelineno-68-5"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">async_external_api_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-68-6" name="__codelineno-68-6"></a>    <span class="k">async</span> <span class="k">with</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientSession</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
<a id="__codelineno-68-7" name="__codelineno-68-7"></a>        <span class="k">async</span> <span class="k">with</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://api.example.com/data&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">resp</span><span class="p">:</span>
<a id="__codelineno-68-8" name="__codelineno-68-8"></a>            <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<a id="__codelineno-68-9" name="__codelineno-68-9"></a>    <span class="k">return</span> <span class="n">JsonResponse</span><span class="p">({</span><span class="s1">&#39;external_data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<h3 id="7-best-practices">7. Best Practices</h3>
<ul>
<li><strong>Leverage Async for Suitable Tasks:</strong> Focus on I/O-bound operations where async provides benefits.</li>
<li><strong>Minimize Sync Calls in Async Contexts:</strong> Reduce use of <code>sync_to_async</code> to maintain performance gains.</li>
<li><strong>Ensure Middleware Compatibility:</strong> Use async-compatible middleware to prevent runtime issues.</li>
<li><strong>Monitor Performance:</strong> Use profiling tools to assess the impact of async code.</li>
<li><strong>Educate the Team:</strong> Ensure all developers understand async concepts and patterns.</li>
</ul>
<p><strong>Conclusion:</strong><br />
Asynchronous features in Django significantly enhance performance for I/O-bound tasks. By adhering to best practices and being mindful of potential challenges, developers can effectively integrate async code with traditional synchronous components to build scalable and efficient applications.</p>
<hr />
<h1 id="6-security-best-practices-in-django">6. Security Best Practices in Django</h1>
<p><strong>Question:</strong><br />
What are the key security features provided by Django, and how can you ensure that a Django application adheres to best security practices? Discuss measures to protect against common vulnerabilities such as SQL injection, Cross-Site Scripting (XSS), Cross-Site Request Forgery (CSRF), and clickjacking.</p>
<p><strong>Answer:</strong></p>
<p>Django is built with security in mind, offering numerous features to protect against common web vulnerabilities. Adhering to best practices ensures robust application security.</p>
<h3 id="1-built-in-security-features">1. Built-in Security Features</h3>
<ul>
<li><strong>SQL Injection Protection:</strong> Django ORM escapes queries automatically.</li>
<li><strong>XSS Protection:</strong> Template auto-escaping prevents injection of malicious scripts.</li>
<li><strong>CSRF Protection:</strong> Middleware and template tags secure POST requests.</li>
<li><strong>Clickjacking Protection:</strong> <code>X-Frame-Options</code> header prevents framing.</li>
<li><strong>Secure Password Storage:</strong> Uses PBKDF2 by default, with options like Argon2.</li>
<li><strong>SSL/HTTPS Enforcement:</strong> Settings to enforce secure connections.</li>
<li><strong>Session Security:</strong> Secure and HttpOnly cookies.</li>
<li><strong>Content Security Policy (CSP):</strong> Optional headers to control resource loading.</li>
</ul>
<h3 id="2-protecting-against-common-vulnerabilities">2. Protecting Against Common Vulnerabilities</h3>
<h4 id="a-sql-injection">a. SQL Injection</h4>
<p><strong>Use Django ORM:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-69-1">1</a></span>
<span class="normal"><a href="#__codelineno-69-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-69-1" name="__codelineno-69-1"></a><span class="c1"># Safe Query using ORM</span>
<a id="__codelineno-69-2" name="__codelineno-69-2"></a><span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Using Raw SQL Safely:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-70-1">1</a></span>
<span class="normal"><a href="#__codelineno-70-2">2</a></span>
<span class="normal"><a href="#__codelineno-70-3">3</a></span>
<span class="normal"><a href="#__codelineno-70-4">4</a></span>
<span class="normal"><a href="#__codelineno-70-5">5</a></span>
<span class="normal"><a href="#__codelineno-70-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-70-1" name="__codelineno-70-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">connection</span>
<a id="__codelineno-70-2" name="__codelineno-70-2"></a>
<a id="__codelineno-70-3" name="__codelineno-70-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_user</span><span class="p">(</span><span class="n">username</span><span class="p">):</span>
<a id="__codelineno-70-4" name="__codelineno-70-4"></a>    <span class="k">with</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cursor</span><span class="p">:</span>
<a id="__codelineno-70-5" name="__codelineno-70-5"></a>        <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM auth_user WHERE username = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">username</span><span class="p">])</span>
<a id="__codelineno-70-6" name="__codelineno-70-6"></a>        <span class="k">return</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<strong>Note:</strong> Always use parameterized queries to prevent injection.</p>
<h4 id="b-cross-site-scripting-xss">b. Cross-Site Scripting (XSS)</h4>
<ul>
<li><strong>Auto-Escaping:</strong> Django templates escape variables by default.</li>
</ul>
<p><strong>Example:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-71-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-71-1" name="__codelineno-71-1"></a><span class="cp">{{</span> <span class="nv">user.bio</span> <span class="cp">}}</span>
</code></pre></div></td></tr></table></div></p>
<ul>
<li>
<p><strong>Avoid <code>|safe</code> Filter:</strong> Use only when necessary and ensure data is sanitized.</p>
</li>
<li>
<p><strong>Content Security Policy (CSP):</strong> Restrict sources of executable scripts.</p>
</li>
</ul>
<p><strong>Example Using <code>django-csp</code>:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-72-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-72-1" name="__codelineno-72-1"></a>pip<span class="w"> </span>install<span class="w"> </span>django-csp
</code></pre></div></td></tr></table></div>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-73-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-73-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-73-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-73-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-73-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-73-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-73-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-73-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-73-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-73-10">10</a></span>
<span class="normal"><a href="#__codelineno-73-11">11</a></span>
<span class="normal"><a href="#__codelineno-73-12">12</a></span>
<span class="normal"><a href="#__codelineno-73-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-73-1" name="__codelineno-73-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-73-2" name="__codelineno-73-2"></a><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-73-3" name="__codelineno-73-3"></a>    <span class="c1"># ... other apps ...</span>
<a id="__codelineno-73-4" name="__codelineno-73-4"></a>    <span class="s1">&#39;csp&#39;</span><span class="p">,</span>
<a id="__codelineno-73-5" name="__codelineno-73-5"></a><span class="p">]</span>
<a id="__codelineno-73-6" name="__codelineno-73-6"></a>
<a id="__codelineno-73-7" name="__codelineno-73-7"></a><span class="n">MIDDLEWARE</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-73-8" name="__codelineno-73-8"></a>    <span class="c1"># ... other middleware ...</span>
<a id="__codelineno-73-9" name="__codelineno-73-9"></a>    <span class="s1">&#39;csp.middleware.CSPMiddleware&#39;</span><span class="p">,</span>
<a id="__codelineno-73-10" name="__codelineno-73-10"></a><span class="p">]</span>
<a id="__codelineno-73-11" name="__codelineno-73-11"></a>
<a id="__codelineno-73-12" name="__codelineno-73-12"></a><span class="n">CSP_DEFAULT_SRC</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&#39;self&#39;&quot;</span><span class="p">,)</span>
<a id="__codelineno-73-13" name="__codelineno-73-13"></a><span class="n">CSP_SCRIPT_SRC</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&#39;self&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;https://apis.google.com&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="c-cross-site-request-forgery-csrf">c. Cross-Site Request Forgery (CSRF)</h4>
<ul>
<li>
<p><strong>Enable CSRF Middleware:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-74-1">1</a></span>
<span class="normal"><a href="#__codelineno-74-2">2</a></span>
<span class="normal"><a href="#__codelineno-74-3">3</a></span>
<span class="normal"><a href="#__codelineno-74-4">4</a></span>
<span class="normal"><a href="#__codelineno-74-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-74-1" name="__codelineno-74-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-74-2" name="__codelineno-74-2"></a><span class="n">MIDDLEWARE</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-74-3" name="__codelineno-74-3"></a>    <span class="s1">&#39;django.middleware.csrf.CsrfViewMiddleware&#39;</span><span class="p">,</span>
<a id="__codelineno-74-4" name="__codelineno-74-4"></a>    <span class="c1"># ... other middleware ...</span>
<a id="__codelineno-74-5" name="__codelineno-74-5"></a><span class="p">]</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Use CSRF Tokens in Forms:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-75-1">1</a></span>
<span class="normal"><a href="#__codelineno-75-2">2</a></span>
<span class="normal"><a href="#__codelineno-75-3">3</a></span>
<span class="normal"><a href="#__codelineno-75-4">4</a></span>
<span class="normal"><a href="#__codelineno-75-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-75-1" name="__codelineno-75-1"></a><span class="x">&lt;form method=&quot;post&quot;&gt;</span>
<a id="__codelineno-75-2" name="__codelineno-75-2"></a><span class="x">    </span><span class="cp">{%</span> <span class="k">csrf_token</span> <span class="cp">%}</span>
<a id="__codelineno-75-3" name="__codelineno-75-3"></a><span class="x">    &lt;!-- form fields --&gt;</span>
<a id="__codelineno-75-4" name="__codelineno-75-4"></a><span class="x">    &lt;button type=&quot;submit&quot;&gt;Submit&lt;/button&gt;</span>
<a id="__codelineno-75-5" name="__codelineno-75-5"></a><span class="x">&lt;/form&gt;</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Handling CSRF in AJAX Requests:</strong>
  Include the CSRF token in headers.
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-76-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-76-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-76-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-76-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-76-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-76-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-76-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-76-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-76-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-76-10">10</a></span>
<span class="normal"><a href="#__codelineno-76-11">11</a></span>
<span class="normal"><a href="#__codelineno-76-12">12</a></span>
<span class="normal"><a href="#__codelineno-76-13">13</a></span>
<span class="normal"><a href="#__codelineno-76-14">14</a></span>
<span class="normal"><a href="#__codelineno-76-15">15</a></span>
<span class="normal"><a href="#__codelineno-76-16">16</a></span>
<span class="normal"><a href="#__codelineno-76-17">17</a></span>
<span class="normal"><a href="#__codelineno-76-18">18</a></span>
<span class="normal"><a href="#__codelineno-76-19">19</a></span>
<span class="normal"><a href="#__codelineno-76-20">20</a></span>
<span class="normal"><a href="#__codelineno-76-21">21</a></span>
<span class="normal"><a href="#__codelineno-76-22">22</a></span>
<span class="normal"><a href="#__codelineno-76-23">23</a></span>
<span class="normal"><a href="#__codelineno-76-24">24</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-76-1" name="__codelineno-76-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">getCookie</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-76-2" name="__codelineno-76-2"></a><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">cookieValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<a id="__codelineno-76-3" name="__codelineno-76-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-76-4" name="__codelineno-76-4"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">cookies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">);</span>
<a id="__codelineno-76-5" name="__codelineno-76-5"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">cookies</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-76-6" name="__codelineno-76-6"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">cookie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cookies</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">trim</span><span class="p">();</span>
<a id="__codelineno-76-7" name="__codelineno-76-7"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">cookie</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;=&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-76-8" name="__codelineno-76-8"></a><span class="w">                </span><span class="nx">cookieValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">decodeURIComponent</span><span class="p">(</span><span class="nx">cookie</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">name</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">));</span>
<a id="__codelineno-76-9" name="__codelineno-76-9"></a><span class="w">                </span><span class="k">break</span><span class="p">;</span>
<a id="__codelineno-76-10" name="__codelineno-76-10"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-76-11" name="__codelineno-76-11"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-76-12" name="__codelineno-76-12"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-76-13" name="__codelineno-76-13"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">cookieValue</span><span class="p">;</span>
<a id="__codelineno-76-14" name="__codelineno-76-14"></a><span class="p">}</span>
<a id="__codelineno-76-15" name="__codelineno-76-15"></a><span class="kd">const</span><span class="w"> </span><span class="nx">csrftoken</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">getCookie</span><span class="p">(</span><span class="s1">&#39;csrftoken&#39;</span><span class="p">);</span>
<a id="__codelineno-76-16" name="__codelineno-76-16"></a>
<a id="__codelineno-76-17" name="__codelineno-76-17"></a><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/some-url/&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-76-18" name="__codelineno-76-18"></a><span class="w">    </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
<a id="__codelineno-76-19" name="__codelineno-76-19"></a><span class="w">    </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-76-20" name="__codelineno-76-20"></a><span class="w">        </span><span class="s1">&#39;X-CSRFToken&#39;</span><span class="o">:</span><span class="w"> </span><span class="nx">csrftoken</span><span class="p">,</span>
<a id="__codelineno-76-21" name="__codelineno-76-21"></a><span class="w">        </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span>
<a id="__codelineno-76-22" name="__codelineno-76-22"></a><span class="w">    </span><span class="p">},</span>
<a id="__codelineno-76-23" name="__codelineno-76-23"></a><span class="w">    </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;value&#39;</span><span class="p">})</span>
<a id="__codelineno-76-24" name="__codelineno-76-24"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div></p>
</li>
</ul>
<h4 id="d-clickjacking">d. Clickjacking</h4>
<ul>
<li>
<p><strong>Set <code>X-Frame-Options</code>:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-77-1">1</a></span>
<span class="normal"><a href="#__codelineno-77-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-77-1" name="__codelineno-77-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-77-2" name="__codelineno-77-2"></a><span class="n">X_FRAME_OPTIONS</span> <span class="o">=</span> <span class="s1">&#39;DENY&#39;</span>  <span class="c1"># Options: &#39;DENY&#39;, &#39;SAMEORIGIN&#39;, &#39;ALLOW-FROM &lt;url&gt;&#39;</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Advanced Protection with CSP:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-78-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-78-1" name="__codelineno-78-1"></a><span class="n">CSP_FRAME_ANCESTORS</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&#39;none&#39;&quot;</span><span class="p">,)</span>
</code></pre></div></td></tr></table></div></p>
</li>
</ul>
<h3 id="3-additional-security-measures">3. Additional Security Measures</h3>
<h4 id="a-secure-password-storage">a. Secure Password Storage</h4>
<ul>
<li>
<p><strong>Use Strong Hashers:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-79-1">1</a></span>
<span class="normal"><a href="#__codelineno-79-2">2</a></span>
<span class="normal"><a href="#__codelineno-79-3">3</a></span>
<span class="normal"><a href="#__codelineno-79-4">4</a></span>
<span class="normal"><a href="#__codelineno-79-5">5</a></span>
<span class="normal"><a href="#__codelineno-79-6">6</a></span>
<span class="normal"><a href="#__codelineno-79-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-79-1" name="__codelineno-79-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-79-2" name="__codelineno-79-2"></a><span class="n">PASSWORD_HASHERS</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-79-3" name="__codelineno-79-3"></a>    <span class="s1">&#39;django.contrib.auth.hashers.Argon2PasswordHasher&#39;</span><span class="p">,</span>
<a id="__codelineno-79-4" name="__codelineno-79-4"></a>    <span class="s1">&#39;django.contrib.auth.hashers.PBKDF2PasswordHasher&#39;</span><span class="p">,</span>
<a id="__codelineno-79-5" name="__codelineno-79-5"></a>    <span class="s1">&#39;django.contrib.auth.hashers.PBKDF2SHA1PasswordHasher&#39;</span><span class="p">,</span>
<a id="__codelineno-79-6" name="__codelineno-79-6"></a>    <span class="s1">&#39;django.contrib.auth.hashers.BCryptSHA256PasswordHasher&#39;</span><span class="p">,</span>
<a id="__codelineno-79-7" name="__codelineno-79-7"></a><span class="p">]</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Enforce Strong Password Policies:</strong>
  Utilize Django’s password validators.
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-80-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-80-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-80-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-80-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-80-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-80-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-80-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-80-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-80-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-80-10">10</a></span>
<span class="normal"><a href="#__codelineno-80-11">11</a></span>
<span class="normal"><a href="#__codelineno-80-12">12</a></span>
<span class="normal"><a href="#__codelineno-80-13">13</a></span>
<span class="normal"><a href="#__codelineno-80-14">14</a></span>
<span class="normal"><a href="#__codelineno-80-15">15</a></span>
<span class="normal"><a href="#__codelineno-80-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-80-1" name="__codelineno-80-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-80-2" name="__codelineno-80-2"></a><span class="n">AUTH_PASSWORD_VALIDATORS</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-80-3" name="__codelineno-80-3"></a>    <span class="p">{</span>
<a id="__codelineno-80-4" name="__codelineno-80-4"></a>        <span class="s1">&#39;NAME&#39;</span><span class="p">:</span> <span class="s1">&#39;django.contrib.auth.password_validation.UserAttributeSimilarityValidator&#39;</span><span class="p">,</span>
<a id="__codelineno-80-5" name="__codelineno-80-5"></a>    <span class="p">},</span>
<a id="__codelineno-80-6" name="__codelineno-80-6"></a>    <span class="p">{</span>
<a id="__codelineno-80-7" name="__codelineno-80-7"></a>        <span class="s1">&#39;NAME&#39;</span><span class="p">:</span> <span class="s1">&#39;django.contrib.auth.password_validation.MinimumLengthValidator&#39;</span><span class="p">,</span>
<a id="__codelineno-80-8" name="__codelineno-80-8"></a>        <span class="s1">&#39;OPTIONS&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;min_length&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">},</span>
<a id="__codelineno-80-9" name="__codelineno-80-9"></a>    <span class="p">},</span>
<a id="__codelineno-80-10" name="__codelineno-80-10"></a>    <span class="p">{</span>
<a id="__codelineno-80-11" name="__codelineno-80-11"></a>        <span class="s1">&#39;NAME&#39;</span><span class="p">:</span> <span class="s1">&#39;django.contrib.auth.password_validation.CommonPasswordValidator&#39;</span><span class="p">,</span>
<a id="__codelineno-80-12" name="__codelineno-80-12"></a>    <span class="p">},</span>
<a id="__codelineno-80-13" name="__codelineno-80-13"></a>    <span class="p">{</span>
<a id="__codelineno-80-14" name="__codelineno-80-14"></a>        <span class="s1">&#39;NAME&#39;</span><span class="p">:</span> <span class="s1">&#39;django.contrib.auth.password_validation.NumericPasswordValidator&#39;</span><span class="p">,</span>
<a id="__codelineno-80-15" name="__codelineno-80-15"></a>    <span class="p">},</span>
<a id="__codelineno-80-16" name="__codelineno-80-16"></a><span class="p">]</span>
</code></pre></div></td></tr></table></div></p>
</li>
</ul>
<h4 id="b-sslhttps-enforcement">b. SSL/HTTPS Enforcement</h4>
<ul>
<li>
<p><strong>Redirect HTTP to HTTPS:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-81-1">1</a></span>
<span class="normal"><a href="#__codelineno-81-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-81-1" name="__codelineno-81-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-81-2" name="__codelineno-81-2"></a><span class="n">SECURE_SSL_REDIRECT</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>HTTP Strict Transport Security (HSTS):</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-82-1">1</a></span>
<span class="normal"><a href="#__codelineno-82-2">2</a></span>
<span class="normal"><a href="#__codelineno-82-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-82-1" name="__codelineno-82-1"></a><span class="n">SECURE_HSTS_SECONDS</span> <span class="o">=</span> <span class="mi">31536000</span>  <span class="c1"># 1 year</span>
<a id="__codelineno-82-2" name="__codelineno-82-2"></a><span class="n">SECURE_HSTS_INCLUDE_SUBDOMAINS</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-82-3" name="__codelineno-82-3"></a><span class="n">SECURE_HSTS_PRELOAD</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Secure Cookies:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-83-1">1</a></span>
<span class="normal"><a href="#__codelineno-83-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-83-1" name="__codelineno-83-1"></a><span class="n">SESSION_COOKIE_SECURE</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-83-2" name="__codelineno-83-2"></a><span class="n">CSRF_COOKIE_SECURE</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div></p>
</li>
</ul>
<h4 id="c-session-security">c. Session Security</h4>
<ul>
<li>
<p><strong>HttpOnly Cookies:</strong> Prevent JavaScript access to session cookies.
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-84-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-84-1" name="__codelineno-84-1"></a><span class="n">SESSION_COOKIE_HTTPONLY</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>SameSite Cookies:</strong> Mitigate CSRF attacks.
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-85-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-85-1" name="__codelineno-85-1"></a><span class="n">SESSION_COOKIE_SAMESITE</span> <span class="o">=</span> <span class="s1">&#39;Lax&#39;</span>  <span class="c1"># Options: &#39;Lax&#39;, &#39;Strict&#39;, &#39;None&#39;</span>
</code></pre></div></td></tr></table></div></p>
</li>
</ul>
<h4 id="d-content-security-policy-csp">d. Content Security Policy (CSP)</h4>
<p>Control resources the user agent is allowed to load.</p>
<p><strong>Example Using <code>django-csp</code>:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-86-1">1</a></span>
<span class="normal"><a href="#__codelineno-86-2">2</a></span>
<span class="normal"><a href="#__codelineno-86-3">3</a></span>
<span class="normal"><a href="#__codelineno-86-4">4</a></span>
<span class="normal"><a href="#__codelineno-86-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-86-1" name="__codelineno-86-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-86-2" name="__codelineno-86-2"></a><span class="n">CSP_DEFAULT_SRC</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&#39;self&#39;&quot;</span><span class="p">,)</span>
<a id="__codelineno-86-3" name="__codelineno-86-3"></a><span class="n">CSP_STYLE_SRC</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&#39;self&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;https://fonts.googleapis.com&#39;</span><span class="p">)</span>
<a id="__codelineno-86-4" name="__codelineno-86-4"></a><span class="n">CSP_FONT_SRC</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&#39;self&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;https://fonts.gstatic.com&#39;</span><span class="p">)</span>
<a id="__codelineno-86-5" name="__codelineno-86-5"></a><span class="n">CSP_SCRIPT_SRC</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&#39;self&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;https://apis.google.com&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="e-secure-file-uploads">e. Secure File Uploads</h4>
<ul>
<li>
<p><strong>Validate File Types:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-87-1">1</a></span>
<span class="normal"><a href="#__codelineno-87-2">2</a></span>
<span class="normal"><a href="#__codelineno-87-3">3</a></span>
<span class="normal"><a href="#__codelineno-87-4">4</a></span>
<span class="normal"><a href="#__codelineno-87-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-87-1" name="__codelineno-87-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.core.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">ValidationError</span>
<a id="__codelineno-87-2" name="__codelineno-87-2"></a>
<a id="__codelineno-87-3" name="__codelineno-87-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">validate_file_extension</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
<a id="__codelineno-87-4" name="__codelineno-87-4"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.pdf&#39;</span><span class="p">):</span>
<a id="__codelineno-87-5" name="__codelineno-87-5"></a>        <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;Only PDF files are allowed.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Use Secure Storage Backends:</strong>
  Store uploaded files in secure locations with appropriate permissions.</p>
</li>
</ul>
<h4 id="f-rate-limiting">f. Rate Limiting</h4>
<p>Prevent brute-force attacks by limiting the number of requests from a single IP.</p>
<p><strong>Example Using <code>django-ratelimit</code>:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-88-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-88-1" name="__codelineno-88-1"></a>pip<span class="w"> </span>install<span class="w"> </span>django-ratelimit
</code></pre></div></td></tr></table></div></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-89-1">1</a></span>
<span class="normal"><a href="#__codelineno-89-2">2</a></span>
<span class="normal"><a href="#__codelineno-89-3">3</a></span>
<span class="normal"><a href="#__codelineno-89-4">4</a></span>
<span class="normal"><a href="#__codelineno-89-5">5</a></span>
<span class="normal"><a href="#__codelineno-89-6">6</a></span>
<span class="normal"><a href="#__codelineno-89-7">7</a></span>
<span class="normal"><a href="#__codelineno-89-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-89-1" name="__codelineno-89-1"></a><span class="c1"># myapp/views.py</span>
<a id="__codelineno-89-2" name="__codelineno-89-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django_ratelimit.decorators</span><span class="w"> </span><span class="kn">import</span> <span class="n">ratelimit</span>
<a id="__codelineno-89-3" name="__codelineno-89-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.shortcuts</span><span class="w"> </span><span class="kn">import</span> <span class="n">render</span>
<a id="__codelineno-89-4" name="__codelineno-89-4"></a>
<a id="__codelineno-89-5" name="__codelineno-89-5"></a><span class="nd">@ratelimit</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;ip&#39;</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="s1">&#39;5/m&#39;</span><span class="p">,</span> <span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-89-6" name="__codelineno-89-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">login_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-89-7" name="__codelineno-89-7"></a>    <span class="c1"># Handle login</span>
<a id="__codelineno-89-8" name="__codelineno-89-8"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
<h4 id="g-regularly-update-dependencies">g. Regularly Update Dependencies</h4>
<p>Keep Django and all dependencies updated to patch known vulnerabilities.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-90-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-90-1" name="__codelineno-90-1"></a>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>django
</code></pre></div></td></tr></table></div>
<h4 id="h-use-strong-unique-secrets">h. Use Strong, Unique Secrets</h4>
<p>Store sensitive settings like <code>SECRET_KEY</code> securely using environment variables.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-91-1">1</a></span>
<span class="normal"><a href="#__codelineno-91-2">2</a></span>
<span class="normal"><a href="#__codelineno-91-3">3</a></span>
<span class="normal"><a href="#__codelineno-91-4">4</a></span>
<span class="normal"><a href="#__codelineno-91-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-91-1" name="__codelineno-91-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-91-2" name="__codelineno-91-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-91-3" name="__codelineno-91-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.core.management.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_random_secret_key</span>
<a id="__codelineno-91-4" name="__codelineno-91-4"></a>
<a id="__codelineno-91-5" name="__codelineno-91-5"></a><span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DJANGO_SECRET_KEY&#39;</span><span class="p">,</span> <span class="n">get_random_secret_key</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<h3 id="4-example-implementing-csrf-protection-in-a-django-form">4. Example: Implementing CSRF Protection in a Django Form</h3>
<h4 id="a-django-form-template">a. Django Form Template</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-92-1">1</a></span>
<span class="normal"><a href="#__codelineno-92-2">2</a></span>
<span class="normal"><a href="#__codelineno-92-3">3</a></span>
<span class="normal"><a href="#__codelineno-92-4">4</a></span>
<span class="normal"><a href="#__codelineno-92-5">5</a></span>
<span class="normal"><a href="#__codelineno-92-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-92-1" name="__codelineno-92-1"></a><span class="x">&lt;!-- templates/myapp/register.html --&gt;</span>
<a id="__codelineno-92-2" name="__codelineno-92-2"></a><span class="x">&lt;form method=&quot;post&quot; action=&quot;</span><span class="cp">{%</span> <span class="k">url</span> <span class="s1">&#39;register&#39;</span> <span class="cp">%}</span><span class="x">&quot;&gt;</span>
<a id="__codelineno-92-3" name="__codelineno-92-3"></a><span class="x">    </span><span class="cp">{%</span> <span class="k">csrf_token</span> <span class="cp">%}</span>
<a id="__codelineno-92-4" name="__codelineno-92-4"></a><span class="x">    </span><span class="cp">{{</span> <span class="nv">form.as_p</span> <span class="cp">}}</span>
<a id="__codelineno-92-5" name="__codelineno-92-5"></a><span class="x">    &lt;button type=&quot;submit&quot;&gt;Register&lt;/button&gt;</span>
<a id="__codelineno-92-6" name="__codelineno-92-6"></a><span class="x">&lt;/form&gt;</span>
</code></pre></div></td></tr></table></div>
<h4 id="b-django-view">b. Django View</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-93-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-93-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-93-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-93-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-93-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-93-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-93-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-93-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-93-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-93-10">10</a></span>
<span class="normal"><a href="#__codelineno-93-11">11</a></span>
<span class="normal"><a href="#__codelineno-93-12">12</a></span>
<span class="normal"><a href="#__codelineno-93-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-93-1" name="__codelineno-93-1"></a><span class="c1"># myapp/views.py</span>
<a id="__codelineno-93-2" name="__codelineno-93-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.shortcuts</span><span class="w"> </span><span class="kn">import</span> <span class="n">render</span><span class="p">,</span> <span class="n">redirect</span>
<a id="__codelineno-93-3" name="__codelineno-93-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.forms</span><span class="w"> </span><span class="kn">import</span> <span class="n">UserCreationForm</span>
<a id="__codelineno-93-4" name="__codelineno-93-4"></a>
<a id="__codelineno-93-5" name="__codelineno-93-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">register</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-93-6" name="__codelineno-93-6"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
<a id="__codelineno-93-7" name="__codelineno-93-7"></a>        <span class="n">form</span> <span class="o">=</span> <span class="n">UserCreationForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
<a id="__codelineno-93-8" name="__codelineno-93-8"></a>        <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
<a id="__codelineno-93-9" name="__codelineno-93-9"></a>            <span class="n">form</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<a id="__codelineno-93-10" name="__codelineno-93-10"></a>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">)</span>
<a id="__codelineno-93-11" name="__codelineno-93-11"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-93-12" name="__codelineno-93-12"></a>        <span class="n">form</span> <span class="o">=</span> <span class="n">UserCreationForm</span><span class="p">()</span>
<a id="__codelineno-93-13" name="__codelineno-93-13"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;myapp/register.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;form&#39;</span><span class="p">:</span> <span class="n">form</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<h4 id="c-middleware-configuration">c. Middleware Configuration</h4>
<p>Ensure <code>CsrfViewMiddleware</code> is included (enabled by default).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-94-1">1</a></span>
<span class="normal"><a href="#__codelineno-94-2">2</a></span>
<span class="normal"><a href="#__codelineno-94-3">3</a></span>
<span class="normal"><a href="#__codelineno-94-4">4</a></span>
<span class="normal"><a href="#__codelineno-94-5">5</a></span>
<span class="normal"><a href="#__codelineno-94-6">6</a></span>
<span class="normal"><a href="#__codelineno-94-7">7</a></span>
<span class="normal"><a href="#__codelineno-94-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-94-1" name="__codelineno-94-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-94-2" name="__codelineno-94-2"></a><span class="n">MIDDLEWARE</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-94-3" name="__codelineno-94-3"></a>    <span class="s1">&#39;django.middleware.security.SecurityMiddleware&#39;</span><span class="p">,</span>
<a id="__codelineno-94-4" name="__codelineno-94-4"></a>    <span class="s1">&#39;django.contrib.sessions.middleware.SessionMiddleware&#39;</span><span class="p">,</span>
<a id="__codelineno-94-5" name="__codelineno-94-5"></a>    <span class="s1">&#39;django.middleware.csrf.CsrfViewMiddleware&#39;</span><span class="p">,</span>  <span class="c1"># CSRF Protection</span>
<a id="__codelineno-94-6" name="__codelineno-94-6"></a>    <span class="s1">&#39;django.middleware.common.CommonMiddleware&#39;</span><span class="p">,</span>
<a id="__codelineno-94-7" name="__codelineno-94-7"></a>    <span class="c1"># ... other middleware ...</span>
<a id="__codelineno-94-8" name="__codelineno-94-8"></a><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<h3 id="5-best-practices_1">5. Best Practices</h3>
<ul>
<li><strong>Least Privilege Principle:</strong> Grant minimal necessary permissions to users and services.</li>
<li><strong>Secure Development Lifecycle:</strong> Integrate security checks throughout development stages.</li>
<li><strong>Educate Developers:</strong> Ensure all team members are aware of security best practices and common vulnerabilities.</li>
<li><strong>Regular Security Audits:</strong> Conduct periodic reviews and audits to identify and mitigate security risks.</li>
<li><strong>Use Security Headers:</strong> Implement additional security headers like <code>Referrer-Policy</code>, <code>Feature-Policy</code>, etc.</li>
</ul>
<p><strong>Example:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-95-1">1</a></span>
<span class="normal"><a href="#__codelineno-95-2">2</a></span>
<span class="normal"><a href="#__codelineno-95-3">3</a></span>
<span class="normal"><a href="#__codelineno-95-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-95-1" name="__codelineno-95-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-95-2" name="__codelineno-95-2"></a><span class="n">SECURE_REFERRER_POLICY</span> <span class="o">=</span> <span class="s1">&#39;no-referrer-when-downgrade&#39;</span>
<a id="__codelineno-95-3" name="__codelineno-95-3"></a><span class="n">SECURE_BROWSER_XSS_FILTER</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-95-4" name="__codelineno-95-4"></a><span class="n">SECURE_CONTENT_TYPE_NOSNIFF</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div></p>
<ul>
<li><strong>Avoid Sensitive Data in URLs:</strong> Do not include sensitive information in query parameters or URL paths.</li>
<li><strong>Implement Two-Factor Authentication (2FA):</strong> Enhance user account security.</li>
</ul>
<p><strong>Conclusion:</strong><br />
Django provides comprehensive security features to protect against common vulnerabilities. By adhering to best practices and leveraging Django’s built-in protections, developers can build secure and resilient web applications.</p>
<hr />
<h1 id="7-caching-strategies-in-django">7. Caching Strategies in Django</h1>
<p><strong>Question:</strong><br />
Describe the different caching mechanisms available in Django. How would you implement per-view caching, template fragment caching, and low-level caching in a Django application? Provide examples of when to use each type.</p>
<p><strong>Answer:</strong></p>
<p>Caching is crucial for improving web application performance by storing frequently accessed data in faster storage mediums. Django offers various caching mechanisms tailored to different needs.</p>
<h3 id="1-types-of-caching-mechanisms">1. Types of Caching Mechanisms</h3>
<ul>
<li><strong>Per-View Caching:</strong> Caches the entire output of a view for a specified period.</li>
<li><strong>Template Fragment Caching:</strong> Caches specific parts of a template.</li>
<li><strong>Low-Level Caching:</strong> Directly interacts with the cache API to store and retrieve arbitrary data.</li>
<li><strong>Site-Wide Caching:</strong> Caches all content across the entire site.</li>
</ul>
<h3 id="2-configuring-the-cache-backend">2. Configuring the Cache Backend</h3>
<p>Before implementing caching, configure a cache backend in <code>settings.py</code>. Django supports several backends:</p>
<ul>
<li><strong>LocMemCache:</strong> In-memory caching, suitable for development and low-traffic sites.</li>
<li><strong>Memcached:</strong> High-performance, distributed memory object caching system.</li>
<li><strong>Redis:</strong> In-memory data structure store, often used as a cache.</li>
</ul>
<p><strong>Example Configuration Using Redis:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-96-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-96-1" name="__codelineno-96-1"></a>pip<span class="w"> </span>install<span class="w"> </span>django-redis
</code></pre></div></td></tr></table></div></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-97-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-97-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-97-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-97-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-97-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-97-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-97-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-97-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-97-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-97-10">10</a></span>
<span class="normal"><a href="#__codelineno-97-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-97-1" name="__codelineno-97-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-97-2" name="__codelineno-97-2"></a><span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-97-3" name="__codelineno-97-3"></a>    <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-97-4" name="__codelineno-97-4"></a>        <span class="s1">&#39;BACKEND&#39;</span><span class="p">:</span> <span class="s1">&#39;django_redis.cache.RedisCache&#39;</span><span class="p">,</span>
<a id="__codelineno-97-5" name="__codelineno-97-5"></a>        <span class="s1">&#39;LOCATION&#39;</span><span class="p">:</span> <span class="s1">&#39;redis://127.0.0.1:6379/1&#39;</span><span class="p">,</span>  <span class="c1"># Redis instance</span>
<a id="__codelineno-97-6" name="__codelineno-97-6"></a>        <span class="s1">&#39;OPTIONS&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-97-7" name="__codelineno-97-7"></a>            <span class="s1">&#39;CLIENT_CLASS&#39;</span><span class="p">:</span> <span class="s1">&#39;django_redis.client.DefaultClient&#39;</span><span class="p">,</span>
<a id="__codelineno-97-8" name="__codelineno-97-8"></a>            <span class="s1">&#39;CONNECTION_POOL_KWARGS&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;max_connections&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
<a id="__codelineno-97-9" name="__codelineno-97-9"></a>        <span class="p">}</span>
<a id="__codelineno-97-10" name="__codelineno-97-10"></a>    <span class="p">}</span>
<a id="__codelineno-97-11" name="__codelineno-97-11"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p><strong>Advanced Configuration:</strong>
- <strong>Cache Timeout:</strong> Adjust based on data volatility.
- <strong>Key Prefixing:</strong> Use <code>KEY_PREFIX</code> to avoid key collisions in shared caches.
- <strong>Compression:</strong> Enable compression for large cached data.
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-98-1">1</a></span>
<span class="normal"><a href="#__codelineno-98-2">2</a></span>
<span class="normal"><a href="#__codelineno-98-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-98-1" name="__codelineno-98-1"></a><span class="s1">&#39;OPTIONS&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-98-2" name="__codelineno-98-2"></a>    <span class="s1">&#39;COMPRESSOR&#39;</span><span class="p">:</span> <span class="s1">&#39;django_redis.compressors.zlib.ZlibCompressor&#39;</span><span class="p">,</span>
<a id="__codelineno-98-3" name="__codelineno-98-3"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="3-per-view-caching">3. Per-View Caching</h3>
<p><strong>Use Case:</strong> Static content that doesn’t change frequently or high-traffic views with resource-intensive processing.</p>
<p><strong>Implementation:</strong></p>
<ul>
<li>
<p><strong>Using the <code>@cache_page</code> Decorator:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-99-1">1</a></span>
<span class="normal"><a href="#__codelineno-99-2">2</a></span>
<span class="normal"><a href="#__codelineno-99-3">3</a></span>
<span class="normal"><a href="#__codelineno-99-4">4</a></span>
<span class="normal"><a href="#__codelineno-99-5">5</a></span>
<span class="normal"><a href="#__codelineno-99-6">6</a></span>
<span class="normal"><a href="#__codelineno-99-7">7</a></span>
<span class="normal"><a href="#__codelineno-99-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-99-1" name="__codelineno-99-1"></a><span class="c1"># myapp/views.py</span>
<a id="__codelineno-99-2" name="__codelineno-99-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.views.decorators.cache</span><span class="w"> </span><span class="kn">import</span> <span class="n">cache_page</span>
<a id="__codelineno-99-3" name="__codelineno-99-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.shortcuts</span><span class="w"> </span><span class="kn">import</span> <span class="n">render</span>
<a id="__codelineno-99-4" name="__codelineno-99-4"></a>
<a id="__codelineno-99-5" name="__codelineno-99-5"></a><span class="nd">@cache_page</span><span class="p">(</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">15</span><span class="p">)</span>  <span class="c1"># Cache for 15 minutes</span>
<a id="__codelineno-99-6" name="__codelineno-99-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">expensive_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-99-7" name="__codelineno-99-7"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">perform_expensive_operation</span><span class="p">()</span>
<a id="__codelineno-99-8" name="__codelineno-99-8"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;myapp/expensive.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Using Class-Based Views:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-100-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-100-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-100-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-100-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-100-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-100-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-100-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-100-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-100-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-100-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-100-1" name="__codelineno-100-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.views.decorators.cache</span><span class="w"> </span><span class="kn">import</span> <span class="n">cache_page</span>
<a id="__codelineno-100-2" name="__codelineno-100-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.utils.decorators</span><span class="w"> </span><span class="kn">import</span> <span class="n">method_decorator</span>
<a id="__codelineno-100-3" name="__codelineno-100-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.views</span><span class="w"> </span><span class="kn">import</span> <span class="n">View</span>
<a id="__codelineno-100-4" name="__codelineno-100-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.shortcuts</span><span class="w"> </span><span class="kn">import</span> <span class="n">render</span>
<a id="__codelineno-100-5" name="__codelineno-100-5"></a>
<a id="__codelineno-100-6" name="__codelineno-100-6"></a><span class="nd">@method_decorator</span><span class="p">(</span><span class="n">cache_page</span><span class="p">(</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">15</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;dispatch&#39;</span><span class="p">)</span>
<a id="__codelineno-100-7" name="__codelineno-100-7"></a><span class="k">class</span><span class="w"> </span><span class="nc">ExpensiveView</span><span class="p">(</span><span class="n">View</span><span class="p">):</span>
<a id="__codelineno-100-8" name="__codelineno-100-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
<a id="__codelineno-100-9" name="__codelineno-100-9"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">perform_expensive_operation</span><span class="p">()</span>
<a id="__codelineno-100-10" name="__codelineno-100-10"></a>        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;myapp/expensive.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
</code></pre></div></td></tr></table></div></p>
</li>
</ul>
<p><strong>Advanced Techniques:</strong>
- <strong>Varying Cache by Parameters:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-101-1">1</a></span>
<span class="normal"><a href="#__codelineno-101-2">2</a></span>
<span class="normal"><a href="#__codelineno-101-3">3</a></span>
<span class="normal"><a href="#__codelineno-101-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-101-1" name="__codelineno-101-1"></a><span class="nd">@cache_page</span><span class="p">(</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">15</span><span class="p">,</span> <span class="n">key_prefix</span><span class="o">=</span><span class="s1">&#39;expensive_view&#39;</span><span class="p">)</span>
<a id="__codelineno-101-2" name="__codelineno-101-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">expensive_view</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">category</span><span class="p">):</span>
<a id="__codelineno-101-3" name="__codelineno-101-3"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">perform_expensive_operation</span><span class="p">(</span><span class="n">category</span><span class="p">)</span>
<a id="__codelineno-101-4" name="__codelineno-101-4"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;myapp/expensive.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="4-template-fragment-caching">4. Template Fragment Caching</h3>
<p><strong>Use Case:</strong> Parts of a template that are expensive to render or infrequently changing, allowing dynamic content to coexist with cached content.</p>
<p><strong>Implementation:</strong></p>
<ul>
<li>
<p><strong>Using the <code>{% cache %}</code> Template Tag:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-102-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-102-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-102-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-102-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-102-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-102-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-102-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-102-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-102-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-102-10">10</a></span>
<span class="normal"><a href="#__codelineno-102-11">11</a></span>
<span class="normal"><a href="#__codelineno-102-12">12</a></span>
<span class="normal"><a href="#__codelineno-102-13">13</a></span>
<span class="normal"><a href="#__codelineno-102-14">14</a></span>
<span class="normal"><a href="#__codelineno-102-15">15</a></span>
<span class="normal"><a href="#__codelineno-102-16">16</a></span>
<span class="normal"><a href="#__codelineno-102-17">17</a></span>
<span class="normal"><a href="#__codelineno-102-18">18</a></span>
<span class="normal"><a href="#__codelineno-102-19">19</a></span>
<span class="normal"><a href="#__codelineno-102-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-102-1" name="__codelineno-102-1"></a><span class="x">&lt;!-- templates/myapp/page.html --&gt;</span>
<a id="__codelineno-102-2" name="__codelineno-102-2"></a><span class="cp">{%</span> <span class="k">load</span> <span class="nv">cache</span> <span class="cp">%}</span>
<a id="__codelineno-102-3" name="__codelineno-102-3"></a><span class="x">&lt;html&gt;</span>
<a id="__codelineno-102-4" name="__codelineno-102-4"></a><span class="x">&lt;head&gt;</span>
<a id="__codelineno-102-5" name="__codelineno-102-5"></a><span class="x">    &lt;title&gt;My Page&lt;/title&gt;</span>
<a id="__codelineno-102-6" name="__codelineno-102-6"></a><span class="x">&lt;/head&gt;</span>
<a id="__codelineno-102-7" name="__codelineno-102-7"></a><span class="x">&lt;body&gt;</span>
<a id="__codelineno-102-8" name="__codelineno-102-8"></a><span class="x">    &lt;h1&gt;Welcome to My Page&lt;/h1&gt;</span>
<a id="__codelineno-102-9" name="__codelineno-102-9"></a>
<a id="__codelineno-102-10" name="__codelineno-102-10"></a><span class="x">    </span><span class="cp">{%</span> <span class="k">cache</span> <span class="m">300</span> <span class="nv">sidebar</span> <span class="cp">%}</span>
<a id="__codelineno-102-11" name="__codelineno-102-11"></a><span class="x">        &lt;!-- Sidebar content that is cached for 5 minutes --&gt;</span>
<a id="__codelineno-102-12" name="__codelineno-102-12"></a><span class="x">        </span><span class="cp">{%</span> <span class="k">include</span> <span class="s1">&#39;myapp/sidebar.html&#39;</span> <span class="cp">%}</span>
<a id="__codelineno-102-13" name="__codelineno-102-13"></a><span class="x">    </span><span class="cp">{%</span> <span class="k">endcache</span> <span class="cp">%}</span>
<a id="__codelineno-102-14" name="__codelineno-102-14"></a>
<a id="__codelineno-102-15" name="__codelineno-102-15"></a><span class="x">    &lt;div&gt;</span>
<a id="__codelineno-102-16" name="__codelineno-102-16"></a><span class="x">        &lt;!-- Dynamic content that is not cached --&gt;</span>
<a id="__codelineno-102-17" name="__codelineno-102-17"></a><span class="x">        </span><span class="cp">{{</span> <span class="nv">dynamic_content</span> <span class="cp">}}</span>
<a id="__codelineno-102-18" name="__codelineno-102-18"></a><span class="x">    &lt;/div&gt;</span>
<a id="__codelineno-102-19" name="__codelineno-102-19"></a><span class="x">&lt;/body&gt;</span>
<a id="__codelineno-102-20" name="__codelineno-102-20"></a><span class="x">&lt;/html&gt;</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Cache Key Naming with Variables:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-103-1">1</a></span>
<span class="normal"><a href="#__codelineno-103-2">2</a></span>
<span class="normal"><a href="#__codelineno-103-3">3</a></span>
<span class="normal"><a href="#__codelineno-103-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-103-1" name="__codelineno-103-1"></a><span class="cp">{%</span> <span class="k">cache</span> <span class="m">600</span> <span class="nv">sidebar</span> <span class="nv">request.user.username</span> <span class="cp">%}</span>
<a id="__codelineno-103-2" name="__codelineno-103-2"></a><span class="x">    &lt;!-- Personalized sidebar content --&gt;</span>
<a id="__codelineno-103-3" name="__codelineno-103-3"></a><span class="x">    </span><span class="cp">{%</span> <span class="k">include</span> <span class="s1">&#39;myapp/user_sidebar.html&#39;</span> <span class="cp">%}</span>
<a id="__codelineno-103-4" name="__codelineno-103-4"></a><span class="cp">{%</span> <span class="k">endcache</span> <span class="cp">%}</span>
</code></pre></div></td></tr></table></div></p>
</li>
</ul>
<p><strong>Advanced Techniques:</strong>
- <strong>Nested Caching:</strong> Cache within cached fragments for granular control.
- <strong>Cache Invalidation:</strong> Use signals or hooks to invalidate cached fragments when underlying data changes.</p>
<h3 id="5-low-level-caching">5. Low-Level Caching</h3>
<p><strong>Use Case:</strong> Custom caching needs, such as caching API responses, complex computations, or data from external sources.</p>
<p><strong>Implementation:</strong></p>
<ul>
<li>
<p><strong>Using Django’s Cache API:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-104-1">1</a></span>
<span class="normal"><a href="#__codelineno-104-2">2</a></span>
<span class="normal"><a href="#__codelineno-104-3">3</a></span>
<span class="normal"><a href="#__codelineno-104-4">4</a></span>
<span class="normal"><a href="#__codelineno-104-5">5</a></span>
<span class="normal"><a href="#__codelineno-104-6">6</a></span>
<span class="normal"><a href="#__codelineno-104-7">7</a></span>
<span class="normal"><a href="#__codelineno-104-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-104-1" name="__codelineno-104-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.core.cache</span><span class="w"> </span><span class="kn">import</span> <span class="n">cache</span>
<a id="__codelineno-104-2" name="__codelineno-104-2"></a>
<a id="__codelineno-104-3" name="__codelineno-104-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_expensive_data</span><span class="p">():</span>
<a id="__codelineno-104-4" name="__codelineno-104-4"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;expensive_data&#39;</span><span class="p">)</span>
<a id="__codelineno-104-5" name="__codelineno-104-5"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-104-6" name="__codelineno-104-6"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">perform_expensive_operation</span><span class="p">()</span>
<a id="__codelineno-104-7" name="__codelineno-104-7"></a>        <span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;expensive_data&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">15</span><span class="p">)</span>  <span class="c1"># Cache for 15 minutes</span>
<a id="__codelineno-104-8" name="__codelineno-104-8"></a>    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Using Cache Decorators:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-105-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-105-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-105-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-105-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-105-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-105-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-105-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-105-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-105-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-105-10">10</a></span>
<span class="normal"><a href="#__codelineno-105-11">11</a></span>
<span class="normal"><a href="#__codelineno-105-12">12</a></span>
<span class="normal"><a href="#__codelineno-105-13">13</a></span>
<span class="normal"><a href="#__codelineno-105-14">14</a></span>
<span class="normal"><a href="#__codelineno-105-15">15</a></span>
<span class="normal"><a href="#__codelineno-105-16">16</a></span>
<span class="normal"><a href="#__codelineno-105-17">17</a></span>
<span class="normal"><a href="#__codelineno-105-18">18</a></span>
<span class="normal"><a href="#__codelineno-105-19">19</a></span>
<span class="normal"><a href="#__codelineno-105-20">20</a></span>
<span class="normal"><a href="#__codelineno-105-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-105-1" name="__codelineno-105-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.core.cache</span><span class="w"> </span><span class="kn">import</span> <span class="n">cache</span>
<a id="__codelineno-105-2" name="__codelineno-105-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">wraps</span>
<a id="__codelineno-105-3" name="__codelineno-105-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<a id="__codelineno-105-4" name="__codelineno-105-4"></a>
<a id="__codelineno-105-5" name="__codelineno-105-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">cache_function</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
<a id="__codelineno-105-6" name="__codelineno-105-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
<a id="__codelineno-105-7" name="__codelineno-105-7"></a>        <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<a id="__codelineno-105-8" name="__codelineno-105-8"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-105-9" name="__codelineno-105-9"></a>            <span class="n">key</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">kwargs</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<a id="__codelineno-105-10" name="__codelineno-105-10"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<a id="__codelineno-105-11" name="__codelineno-105-11"></a>            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-105-12" name="__codelineno-105-12"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-105-13" name="__codelineno-105-13"></a>                <span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
<a id="__codelineno-105-14" name="__codelineno-105-14"></a>            <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-105-15" name="__codelineno-105-15"></a>        <span class="k">return</span> <span class="n">wrapper</span>
<a id="__codelineno-105-16" name="__codelineno-105-16"></a>    <span class="k">return</span> <span class="n">decorator</span>
<a id="__codelineno-105-17" name="__codelineno-105-17"></a>
<a id="__codelineno-105-18" name="__codelineno-105-18"></a><span class="nd">@cache_function</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
<a id="__codelineno-105-19" name="__codelineno-105-19"></a><span class="k">def</span><span class="w"> </span><span class="nf">compute_heavy_task</span><span class="p">(</span><span class="n">param</span><span class="p">):</span>
<a id="__codelineno-105-20" name="__codelineno-105-20"></a>    <span class="c1"># Perform computation</span>
<a id="__codelineno-105-21" name="__codelineno-105-21"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div></p>
</li>
</ul>
<p><strong>Advanced Techniques:</strong>
- <strong>Cache Versioning:</strong> Manage different versions of cached data.
- <strong>Distributed Caching:</strong> Use Redis or Memcached for scalable caching across multiple servers.</p>
<h3 id="6-site-wide-caching">6. Site-Wide Caching</h3>
<p><strong>Use Case:</strong> Entirely static sites or parts of the site that do not change frequently, maximizing cache hit rates.</p>
<p><strong>Implementation:</strong></p>
<ul>
<li><strong>Using <code>UpdateCacheMiddleware</code> and <code>FetchFromCacheMiddleware</code>:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-106-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-106-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-106-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-106-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-106-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-106-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-106-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-106-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-106-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-106-10">10</a></span>
<span class="normal"><a href="#__codelineno-106-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-106-1" name="__codelineno-106-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-106-2" name="__codelineno-106-2"></a><span class="n">MIDDLEWARE</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-106-3" name="__codelineno-106-3"></a>    <span class="s1">&#39;django.middleware.cache.UpdateCacheMiddleware&#39;</span><span class="p">,</span>  <span class="c1"># Must be first</span>
<a id="__codelineno-106-4" name="__codelineno-106-4"></a>    <span class="s1">&#39;django.middleware.common.CommonMiddleware&#39;</span><span class="p">,</span>
<a id="__codelineno-106-5" name="__codelineno-106-5"></a>    <span class="c1"># ... other middleware ...</span>
<a id="__codelineno-106-6" name="__codelineno-106-6"></a>    <span class="s1">&#39;django.middleware.cache.FetchFromCacheMiddleware&#39;</span><span class="p">,</span>  <span class="c1"># Must be last</span>
<a id="__codelineno-106-7" name="__codelineno-106-7"></a><span class="p">]</span>
<a id="__codelineno-106-8" name="__codelineno-106-8"></a>
<a id="__codelineno-106-9" name="__codelineno-106-9"></a><span class="n">CACHE_MIDDLEWARE_ALIAS</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span>
<a id="__codelineno-106-10" name="__codelineno-106-10"></a><span class="n">CACHE_MIDDLEWARE_SECONDS</span> <span class="o">=</span> <span class="mi">600</span>  <span class="c1"># Cache for 10 minutes</span>
<a id="__codelineno-106-11" name="__codelineno-106-11"></a><span class="n">CACHE_MIDDLEWARE_KEY_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</code></pre></div></td></tr></table></div></li>
</ul>
<p><strong>Advanced Techniques:</strong>
- <strong>Varying Cache by Headers:</strong> Use <code>Vary</code> headers to cache different responses based on request headers.
- <strong>Cache Bypass for Authenticated Users:</strong> Prevent caching for authenticated sessions to ensure personalized content.</p>
<h3 id="7-advanced-caching-strategies">7. Advanced Caching Strategies</h3>
<h4 id="a-cache-invalidation">a. Cache Invalidation</h4>
<p>Ensure cached data is updated or cleared when underlying data changes.</p>
<p><strong>Example Using Signals:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-107-1">1</a></span>
<span class="normal"><a href="#__codelineno-107-2">2</a></span>
<span class="normal"><a href="#__codelineno-107-3">3</a></span>
<span class="normal"><a href="#__codelineno-107-4">4</a></span>
<span class="normal"><a href="#__codelineno-107-5">5</a></span>
<span class="normal"><a href="#__codelineno-107-6">6</a></span>
<span class="normal"><a href="#__codelineno-107-7">7</a></span>
<span class="normal"><a href="#__codelineno-107-8">8</a></span>
<span class="normal"><a href="#__codelineno-107-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-107-1" name="__codelineno-107-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.db.models.signals</span><span class="w"> </span><span class="kn">import</span> <span class="n">post_save</span><span class="p">,</span> <span class="n">post_delete</span>
<a id="__codelineno-107-2" name="__codelineno-107-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.dispatch</span><span class="w"> </span><span class="kn">import</span> <span class="n">receiver</span>
<a id="__codelineno-107-3" name="__codelineno-107-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.core.cache</span><span class="w"> </span><span class="kn">import</span> <span class="n">cache</span>
<a id="__codelineno-107-4" name="__codelineno-107-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Product</span>
<a id="__codelineno-107-5" name="__codelineno-107-5"></a>
<a id="__codelineno-107-6" name="__codelineno-107-6"></a><span class="nd">@receiver</span><span class="p">([</span><span class="n">post_save</span><span class="p">,</span> <span class="n">post_delete</span><span class="p">],</span> <span class="n">sender</span><span class="o">=</span><span class="n">Product</span><span class="p">)</span>
<a id="__codelineno-107-7" name="__codelineno-107-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">invalidate_product_cache</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-107-8" name="__codelineno-107-8"></a>    <span class="n">cache_key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;product_</span><span class="si">{</span><span class="n">instance</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-107-9" name="__codelineno-107-9"></a>    <span class="n">cache</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="b-cache-versioning">b. Cache Versioning</h4>
<p>Manage different versions of cached data to handle updates without conflicts.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-108-1">1</a></span>
<span class="normal"><a href="#__codelineno-108-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-108-1" name="__codelineno-108-1"></a><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;product_data_v1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-108-2" name="__codelineno-108-2"></a><span class="n">data</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;product_data&#39;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="c-using-cache-backends-with-persistence">c. Using Cache Backends with Persistence</h4>
<p>Use cache backends that support data persistence to prevent cache loss on server restarts.</p>
<p><strong>Example Using Redis with Persistence:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-109-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-109-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-109-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-109-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-109-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-109-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-109-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-109-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-109-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-109-10">10</a></span>
<span class="normal"><a href="#__codelineno-109-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-109-1" name="__codelineno-109-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-109-2" name="__codelineno-109-2"></a><span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-109-3" name="__codelineno-109-3"></a>    <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-109-4" name="__codelineno-109-4"></a>        <span class="s1">&#39;BACKEND&#39;</span><span class="p">:</span> <span class="s1">&#39;django_redis.cache.RedisCache&#39;</span><span class="p">,</span>
<a id="__codelineno-109-5" name="__codelineno-109-5"></a>        <span class="s1">&#39;LOCATION&#39;</span><span class="p">:</span> <span class="s1">&#39;redis://127.0.0.1:6379/1&#39;</span><span class="p">,</span>
<a id="__codelineno-109-6" name="__codelineno-109-6"></a>        <span class="s1">&#39;OPTIONS&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-109-7" name="__codelineno-109-7"></a>            <span class="s1">&#39;CLIENT_CLASS&#39;</span><span class="p">:</span> <span class="s1">&#39;django_redis.client.DefaultClient&#39;</span><span class="p">,</span>
<a id="__codelineno-109-8" name="__codelineno-109-8"></a>            <span class="s1">&#39;IGNORE_EXCEPTIONS&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># Gracefully handle Redis downtime</span>
<a id="__codelineno-109-9" name="__codelineno-109-9"></a>        <span class="p">}</span>
<a id="__codelineno-109-10" name="__codelineno-109-10"></a>    <span class="p">}</span>
<a id="__codelineno-109-11" name="__codelineno-109-11"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="8-best-practices_1">8. Best Practices</h3>
<ul>
<li><strong>Choose the Right Cache Backend:</strong> Use Redis or Memcached for production environments due to their performance and scalability.</li>
<li><strong>Implement Cache Invalidation:</strong> Ensure caches are updated or cleared when data changes to maintain consistency.</li>
<li><strong>Avoid Caching Sensitive Data:</strong> Do not cache personal or sensitive information unless properly secured.</li>
<li><strong>Monitor Cache Performance:</strong> Track cache hit rates and performance metrics to optimize caching strategies.</li>
<li><strong>Use Vary Headers Appropriately:</strong> Ensure cached content varies based on relevant factors like user status or request parameters.</li>
<li><strong>Leverage CDN for Static Content:</strong> Offload serving static and media files to a Content Delivery Network for improved performance and reduced server load.</li>
</ul>
<h3 id="9-example-comprehensive-implementation">9. Example: Comprehensive Implementation</h3>
<h4 id="a-per-view-caching-example">a. Per-View Caching Example</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-110-1">1</a></span>
<span class="normal"><a href="#__codelineno-110-2">2</a></span>
<span class="normal"><a href="#__codelineno-110-3">3</a></span>
<span class="normal"><a href="#__codelineno-110-4">4</a></span>
<span class="normal"><a href="#__codelineno-110-5">5</a></span>
<span class="normal"><a href="#__codelineno-110-6">6</a></span>
<span class="normal"><a href="#__codelineno-110-7">7</a></span>
<span class="normal"><a href="#__codelineno-110-8">8</a></span>
<span class="normal"><a href="#__codelineno-110-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-110-1" name="__codelineno-110-1"></a><span class="c1"># myapp/views.py</span>
<a id="__codelineno-110-2" name="__codelineno-110-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.views.decorators.cache</span><span class="w"> </span><span class="kn">import</span> <span class="n">cache_page</span>
<a id="__codelineno-110-3" name="__codelineno-110-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.shortcuts</span><span class="w"> </span><span class="kn">import</span> <span class="n">render</span>
<a id="__codelineno-110-4" name="__codelineno-110-4"></a>
<a id="__codelineno-110-5" name="__codelineno-110-5"></a><span class="nd">@cache_page</span><span class="p">(</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># Cache for 10 minutes</span>
<a id="__codelineno-110-6" name="__codelineno-110-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">homepage</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-110-7" name="__codelineno-110-7"></a>    <span class="c1"># Expensive operations</span>
<a id="__codelineno-110-8" name="__codelineno-110-8"></a>    <span class="n">context</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">expensive_data</span><span class="p">()}</span>
<a id="__codelineno-110-9" name="__codelineno-110-9"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;myapp/homepage.html&#39;</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h4 id="b-template-fragment-caching-example">b. Template Fragment Caching Example</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-111-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-111-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-111-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-111-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-111-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-111-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-111-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-111-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-111-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-111-10">10</a></span>
<span class="normal"><a href="#__codelineno-111-11">11</a></span>
<span class="normal"><a href="#__codelineno-111-12">12</a></span>
<span class="normal"><a href="#__codelineno-111-13">13</a></span>
<span class="normal"><a href="#__codelineno-111-14">14</a></span>
<span class="normal"><a href="#__codelineno-111-15">15</a></span>
<span class="normal"><a href="#__codelineno-111-16">16</a></span>
<span class="normal"><a href="#__codelineno-111-17">17</a></span>
<span class="normal"><a href="#__codelineno-111-18">18</a></span>
<span class="normal"><a href="#__codelineno-111-19">19</a></span>
<span class="normal"><a href="#__codelineno-111-20">20</a></span>
<span class="normal"><a href="#__codelineno-111-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-111-1" name="__codelineno-111-1"></a><span class="x">&lt;!-- templates/myapp/homepage.html --&gt;</span>
<a id="__codelineno-111-2" name="__codelineno-111-2"></a><span class="cp">{%</span> <span class="k">load</span> <span class="nv">cache</span> <span class="cp">%}</span>
<a id="__codelineno-111-3" name="__codelineno-111-3"></a><span class="x">&lt;!DOCTYPE html&gt;</span>
<a id="__codelineno-111-4" name="__codelineno-111-4"></a><span class="x">&lt;html&gt;</span>
<a id="__codelineno-111-5" name="__codelineno-111-5"></a><span class="x">&lt;head&gt;</span>
<a id="__codelineno-111-6" name="__codelineno-111-6"></a><span class="x">    &lt;title&gt;Homepage&lt;/title&gt;</span>
<a id="__codelineno-111-7" name="__codelineno-111-7"></a><span class="x">&lt;/head&gt;</span>
<a id="__codelineno-111-8" name="__codelineno-111-8"></a><span class="x">&lt;body&gt;</span>
<a id="__codelineno-111-9" name="__codelineno-111-9"></a><span class="x">    &lt;h1&gt;Welcome to the Homepage&lt;/h1&gt;</span>
<a id="__codelineno-111-10" name="__codelineno-111-10"></a>
<a id="__codelineno-111-11" name="__codelineno-111-11"></a><span class="x">    </span><span class="cp">{%</span> <span class="k">cache</span> <span class="m">300</span> <span class="nv">latest_articles</span> <span class="cp">%}</span>
<a id="__codelineno-111-12" name="__codelineno-111-12"></a><span class="x">        </span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">article</span> <span class="k">in</span> <span class="nv">latest_articles</span> <span class="cp">%}</span>
<a id="__codelineno-111-13" name="__codelineno-111-13"></a><span class="x">            &lt;div&gt;</span><span class="cp">{{</span> <span class="nv">article.title</span> <span class="cp">}}</span><span class="x">&lt;/div&gt;</span>
<a id="__codelineno-111-14" name="__codelineno-111-14"></a><span class="x">        </span><span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<a id="__codelineno-111-15" name="__codelineno-111-15"></a><span class="x">    </span><span class="cp">{%</span> <span class="k">endcache</span> <span class="cp">%}</span>
<a id="__codelineno-111-16" name="__codelineno-111-16"></a>
<a id="__codelineno-111-17" name="__codelineno-111-17"></a><span class="x">    &lt;div&gt;</span>
<a id="__codelineno-111-18" name="__codelineno-111-18"></a><span class="x">        &lt;!-- Other dynamic content --&gt;</span>
<a id="__codelineno-111-19" name="__codelineno-111-19"></a><span class="x">    &lt;/div&gt;</span>
<a id="__codelineno-111-20" name="__codelineno-111-20"></a><span class="x">&lt;/body&gt;</span>
<a id="__codelineno-111-21" name="__codelineno-111-21"></a><span class="x">&lt;/html&gt;</span>
</code></pre></div></td></tr></table></div>
<h4 id="c-low-level-caching-example">c. Low-Level Caching Example</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-112-1">1</a></span>
<span class="normal"><a href="#__codelineno-112-2">2</a></span>
<span class="normal"><a href="#__codelineno-112-3">3</a></span>
<span class="normal"><a href="#__codelineno-112-4">4</a></span>
<span class="normal"><a href="#__codelineno-112-5">5</a></span>
<span class="normal"><a href="#__codelineno-112-6">6</a></span>
<span class="normal"><a href="#__codelineno-112-7">7</a></span>
<span class="normal"><a href="#__codelineno-112-8">8</a></span>
<span class="normal"><a href="#__codelineno-112-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-112-1" name="__codelineno-112-1"></a><span class="c1"># myapp/utils.py</span>
<a id="__codelineno-112-2" name="__codelineno-112-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.core.cache</span><span class="w"> </span><span class="kn">import</span> <span class="n">cache</span>
<a id="__codelineno-112-3" name="__codelineno-112-3"></a>
<a id="__codelineno-112-4" name="__codelineno-112-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_latest_articles</span><span class="p">():</span>
<a id="__codelineno-112-5" name="__codelineno-112-5"></a>    <span class="n">articles</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;latest_articles&#39;</span><span class="p">)</span>
<a id="__codelineno-112-6" name="__codelineno-112-6"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">articles</span><span class="p">:</span>
<a id="__codelineno-112-7" name="__codelineno-112-7"></a>        <span class="n">articles</span> <span class="o">=</span> <span class="n">fetch_latest_articles_from_db</span><span class="p">()</span>
<a id="__codelineno-112-8" name="__codelineno-112-8"></a>        <span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;latest_articles&#39;</span><span class="p">,</span> <span class="n">articles</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>  <span class="c1"># Cache for 5 minutes</span>
<a id="__codelineno-112-9" name="__codelineno-112-9"></a>    <span class="k">return</span> <span class="n">articles</span>
</code></pre></div></td></tr></table></div>
<h4 id="d-integrating-in-views">d. Integrating in Views</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-113-1">1</a></span>
<span class="normal"><a href="#__codelineno-113-2">2</a></span>
<span class="normal"><a href="#__codelineno-113-3">3</a></span>
<span class="normal"><a href="#__codelineno-113-4">4</a></span>
<span class="normal"><a href="#__codelineno-113-5">5</a></span>
<span class="normal"><a href="#__codelineno-113-6">6</a></span>
<span class="normal"><a href="#__codelineno-113-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-113-1" name="__codelineno-113-1"></a><span class="c1"># myapp/views.py</span>
<a id="__codelineno-113-2" name="__codelineno-113-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.shortcuts</span><span class="w"> </span><span class="kn">import</span> <span class="n">render</span>
<a id="__codelineno-113-3" name="__codelineno-113-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_latest_articles</span>
<a id="__codelineno-113-4" name="__codelineno-113-4"></a>
<a id="__codelineno-113-5" name="__codelineno-113-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">homepage</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-113-6" name="__codelineno-113-6"></a>    <span class="n">latest_articles</span> <span class="o">=</span> <span class="n">get_latest_articles</span><span class="p">()</span>
<a id="__codelineno-113-7" name="__codelineno-113-7"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;myapp/homepage.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;latest_articles&#39;</span><span class="p">:</span> <span class="n">latest_articles</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<h3 id="10-advanced-caching-considerations">10. Advanced Caching Considerations</h3>
<h4 id="a-fragment-cache-with-varying-context">a. Fragment Cache with Varying Context</h4>
<p>Cache fragments based on user-specific data to serve personalized content.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-114-1">1</a></span>
<span class="normal"><a href="#__codelineno-114-2">2</a></span>
<span class="normal"><a href="#__codelineno-114-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-114-1" name="__codelineno-114-1"></a><span class="cp">{%</span> <span class="k">cache</span> <span class="m">300</span> <span class="nv">sidebar</span> <span class="nv">request.user.username</span> <span class="cp">%}</span>
<a id="__codelineno-114-2" name="__codelineno-114-2"></a><span class="x">    </span><span class="cp">{%</span> <span class="k">include</span> <span class="s1">&#39;myapp/user_sidebar.html&#39;</span> <span class="cp">%}</span>
<a id="__codelineno-114-3" name="__codelineno-114-3"></a><span class="cp">{%</span> <span class="k">endcache</span> <span class="cp">%}</span>
</code></pre></div></td></tr></table></div>
<h4 id="b-using-cache-aliases">b. Using Cache Aliases</h4>
<p>Define multiple cache backends for different caching needs.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-115-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-115-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-115-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-115-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-115-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-115-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-115-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-115-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-115-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-115-10">10</a></span>
<span class="normal"><a href="#__codelineno-115-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-115-1" name="__codelineno-115-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-115-2" name="__codelineno-115-2"></a><span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-115-3" name="__codelineno-115-3"></a>    <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-115-4" name="__codelineno-115-4"></a>        <span class="s1">&#39;BACKEND&#39;</span><span class="p">:</span> <span class="s1">&#39;django_redis.cache.RedisCache&#39;</span><span class="p">,</span>
<a id="__codelineno-115-5" name="__codelineno-115-5"></a>        <span class="s1">&#39;LOCATION&#39;</span><span class="p">:</span> <span class="s1">&#39;redis://127.0.0.1:6379/1&#39;</span><span class="p">,</span>
<a id="__codelineno-115-6" name="__codelineno-115-6"></a>    <span class="p">},</span>
<a id="__codelineno-115-7" name="__codelineno-115-7"></a>    <span class="s1">&#39;sessions&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-115-8" name="__codelineno-115-8"></a>        <span class="s1">&#39;BACKEND&#39;</span><span class="p">:</span> <span class="s1">&#39;django_redis.cache.RedisCache&#39;</span><span class="p">,</span>
<a id="__codelineno-115-9" name="__codelineno-115-9"></a>        <span class="s1">&#39;LOCATION&#39;</span><span class="p">:</span> <span class="s1">&#39;redis://127.0.0.1:6379/2&#39;</span><span class="p">,</span>
<a id="__codelineno-115-10" name="__codelineno-115-10"></a>    <span class="p">},</span>
<a id="__codelineno-115-11" name="__codelineno-115-11"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p><strong>Usage:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-116-1">1</a></span>
<span class="normal"><a href="#__codelineno-116-2">2</a></span>
<span class="normal"><a href="#__codelineno-116-3">3</a></span>
<span class="normal"><a href="#__codelineno-116-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-116-1" name="__codelineno-116-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.core.cache</span><span class="w"> </span><span class="kn">import</span> <span class="n">caches</span>
<a id="__codelineno-116-2" name="__codelineno-116-2"></a>
<a id="__codelineno-116-3" name="__codelineno-116-3"></a><span class="n">session_cache</span> <span class="o">=</span> <span class="n">caches</span><span class="p">[</span><span class="s1">&#39;sessions&#39;</span><span class="p">]</span>
<a id="__codelineno-116-4" name="__codelineno-116-4"></a><span class="n">session_cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;session_key&#39;</span><span class="p">,</span> <span class="n">session_data</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="c-optimizing-cache-keys">c. Optimizing Cache Keys</h4>
<p>Use meaningful and unique cache keys to prevent collisions and ensure efficient retrieval.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-117-1">1</a></span>
<span class="normal"><a href="#__codelineno-117-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-117-1" name="__codelineno-117-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_product_cache_key</span><span class="p">(</span><span class="n">product_id</span><span class="p">):</span>
<a id="__codelineno-117-2" name="__codelineno-117-2"></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;product_</span><span class="si">{</span><span class="n">product_id</span><span class="si">}</span><span class="s2">_details&quot;</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="d-asynchronous-cache-operations">d. Asynchronous Cache Operations</h4>
<p>For high-performance applications, consider asynchronous cache operations using <code>channels</code> or <code>async</code> libraries.</p>
<p><strong>Example with <code>django-redis</code>:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-118-1">1</a></span>
<span class="normal"><a href="#__codelineno-118-2">2</a></span>
<span class="normal"><a href="#__codelineno-118-3">3</a></span>
<span class="normal"><a href="#__codelineno-118-4">4</a></span>
<span class="normal"><a href="#__codelineno-118-5">5</a></span>
<span class="normal"><a href="#__codelineno-118-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-118-1" name="__codelineno-118-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<a id="__codelineno-118-2" name="__codelineno-118-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.core.cache</span><span class="w"> </span><span class="kn">import</span> <span class="n">cache</span>
<a id="__codelineno-118-3" name="__codelineno-118-3"></a>
<a id="__codelineno-118-4" name="__codelineno-118-4"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">async_cache_set</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
<a id="__codelineno-118-5" name="__codelineno-118-5"></a>    <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>
<a id="__codelineno-118-6" name="__codelineno-118-6"></a>    <span class="k">await</span> <span class="n">loop</span><span class="o">.</span><span class="n">run_in_executor</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Conclusion:</strong><br />
Django's versatile caching framework allows developers to implement various strategies tailored to different application needs. By effectively using per-view caching, template fragment caching, low-level caching, and adhering to advanced caching practices, applications can achieve significant performance improvements and handle increased traffic efficiently.</p>
<hr />
<h1 id="8-custom-management-commands">8. Custom Management Commands</h1>
<p><strong>Question:</strong><br />
How can you create custom management commands in Django? Provide an example of a custom command that performs a specific task, such as importing data from a CSV file into the database.</p>
<p><strong>Answer:</strong></p>
<p>Custom management commands extend Django’s <code>manage.py</code> utility, enabling automation of repetitive tasks like data imports, exports, maintenance operations, and more.</p>
<h3 id="1-creating-custom-management-commands">1. Creating Custom Management Commands</h3>
<p><strong>Step-by-Step Implementation:</strong></p>
<h4 id="a-directory-structure">a. Directory Structure</h4>
<p>Within a Django app, create a <code>management/commands</code> directory structure.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-119-1">1</a></span>
<span class="normal"><a href="#__codelineno-119-2">2</a></span>
<span class="normal"><a href="#__codelineno-119-3">3</a></span>
<span class="normal"><a href="#__codelineno-119-4">4</a></span>
<span class="normal"><a href="#__codelineno-119-5">5</a></span>
<span class="normal"><a href="#__codelineno-119-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-119-1" name="__codelineno-119-1"></a>myapp/
<a id="__codelineno-119-2" name="__codelineno-119-2"></a>├── management/
<a id="__codelineno-119-3" name="__codelineno-119-3"></a>│   ├── __init__.py
<a id="__codelineno-119-4" name="__codelineno-119-4"></a>│   └── commands/
<a id="__codelineno-119-5" name="__codelineno-119-5"></a>│       ├── __init__.py
<a id="__codelineno-119-6" name="__codelineno-119-6"></a>│       └── import_csv.py
</code></pre></div></td></tr></table></div>
<h4 id="b-define-the-custom-command">b. Define the Custom Command</h4>
<p><strong>Example:</strong> Importing Data from a CSV File into the <code>Product</code> Model.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-120-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-120-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-120-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-120-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-120-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-120-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-120-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-120-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-120-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-120-10">10</a></span>
<span class="normal"><a href="#__codelineno-120-11">11</a></span>
<span class="normal"><a href="#__codelineno-120-12">12</a></span>
<span class="normal"><a href="#__codelineno-120-13">13</a></span>
<span class="normal"><a href="#__codelineno-120-14">14</a></span>
<span class="normal"><a href="#__codelineno-120-15">15</a></span>
<span class="normal"><a href="#__codelineno-120-16">16</a></span>
<span class="normal"><a href="#__codelineno-120-17">17</a></span>
<span class="normal"><a href="#__codelineno-120-18">18</a></span>
<span class="normal"><a href="#__codelineno-120-19">19</a></span>
<span class="normal"><a href="#__codelineno-120-20">20</a></span>
<span class="normal"><a href="#__codelineno-120-21">21</a></span>
<span class="normal"><a href="#__codelineno-120-22">22</a></span>
<span class="normal"><a href="#__codelineno-120-23">23</a></span>
<span class="normal"><a href="#__codelineno-120-24">24</a></span>
<span class="normal"><a href="#__codelineno-120-25">25</a></span>
<span class="normal"><a href="#__codelineno-120-26">26</a></span>
<span class="normal"><a href="#__codelineno-120-27">27</a></span>
<span class="normal"><a href="#__codelineno-120-28">28</a></span>
<span class="normal"><a href="#__codelineno-120-29">29</a></span>
<span class="normal"><a href="#__codelineno-120-30">30</a></span>
<span class="normal"><a href="#__codelineno-120-31">31</a></span>
<span class="normal"><a href="#__codelineno-120-32">32</a></span>
<span class="normal"><a href="#__codelineno-120-33">33</a></span>
<span class="normal"><a href="#__codelineno-120-34">34</a></span>
<span class="normal"><a href="#__codelineno-120-35">35</a></span>
<span class="normal"><a href="#__codelineno-120-36">36</a></span>
<span class="normal"><a href="#__codelineno-120-37">37</a></span>
<span class="normal"><a href="#__codelineno-120-38">38</a></span>
<span class="normal"><a href="#__codelineno-120-39">39</a></span>
<span class="normal"><a href="#__codelineno-120-40">40</a></span>
<span class="normal"><a href="#__codelineno-120-41">41</a></span>
<span class="normal"><a href="#__codelineno-120-42">42</a></span>
<span class="normal"><a href="#__codelineno-120-43">43</a></span>
<span class="normal"><a href="#__codelineno-120-44">44</a></span>
<span class="normal"><a href="#__codelineno-120-45">45</a></span>
<span class="normal"><a href="#__codelineno-120-46">46</a></span>
<span class="normal"><a href="#__codelineno-120-47">47</a></span>
<span class="normal"><a href="#__codelineno-120-48">48</a></span>
<span class="normal"><a href="#__codelineno-120-49">49</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-120-1" name="__codelineno-120-1"></a><span class="c1"># myapp/management/commands/import_csv.py</span>
<a id="__codelineno-120-2" name="__codelineno-120-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">csv</span>
<a id="__codelineno-120-3" name="__codelineno-120-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.core.management.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseCommand</span><span class="p">,</span> <span class="n">CommandError</span>
<a id="__codelineno-120-4" name="__codelineno-120-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">myapp.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Product</span>
<a id="__codelineno-120-5" name="__codelineno-120-5"></a>
<a id="__codelineno-120-6" name="__codelineno-120-6"></a><span class="k">class</span><span class="w"> </span><span class="nc">Command</span><span class="p">(</span><span class="n">BaseCommand</span><span class="p">):</span>
<a id="__codelineno-120-7" name="__codelineno-120-7"></a>    <span class="n">help</span> <span class="o">=</span> <span class="s1">&#39;Import products from a CSV file&#39;</span>
<a id="__codelineno-120-8" name="__codelineno-120-8"></a>
<a id="__codelineno-120-9" name="__codelineno-120-9"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
<a id="__codelineno-120-10" name="__codelineno-120-10"></a>        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;csv_file&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Path to the CSV file to import&#39;</span><span class="p">)</span>
<a id="__codelineno-120-11" name="__codelineno-120-11"></a>        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<a id="__codelineno-120-12" name="__codelineno-120-12"></a>            <span class="s1">&#39;--update&#39;</span><span class="p">,</span>
<a id="__codelineno-120-13" name="__codelineno-120-13"></a>            <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span>
<a id="__codelineno-120-14" name="__codelineno-120-14"></a>            <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Update existing products instead of creating new ones&#39;</span><span class="p">,</span>
<a id="__codelineno-120-15" name="__codelineno-120-15"></a>        <span class="p">)</span>
<a id="__codelineno-120-16" name="__codelineno-120-16"></a>
<a id="__codelineno-120-17" name="__codelineno-120-17"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
<a id="__codelineno-120-18" name="__codelineno-120-18"></a>        <span class="n">csv_file</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;csv_file&#39;</span><span class="p">]</span>
<a id="__codelineno-120-19" name="__codelineno-120-19"></a>        <span class="n">update</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;update&#39;</span><span class="p">]</span>
<a id="__codelineno-120-20" name="__codelineno-120-20"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-120-21" name="__codelineno-120-21"></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-120-22" name="__codelineno-120-22"></a>                <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-120-23" name="__codelineno-120-23"></a>                <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
<a id="__codelineno-120-24" name="__codelineno-120-24"></a>                    <span class="n">sku</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;sku&#39;</span><span class="p">]</span>
<a id="__codelineno-120-25" name="__codelineno-120-25"></a>                    <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
<a id="__codelineno-120-26" name="__codelineno-120-26"></a>                        <span class="n">product</span><span class="p">,</span> <span class="n">created</span> <span class="o">=</span> <span class="n">Product</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">update_or_create</span><span class="p">(</span>
<a id="__codelineno-120-27" name="__codelineno-120-27"></a>                            <span class="n">sku</span><span class="o">=</span><span class="n">sku</span><span class="p">,</span>
<a id="__codelineno-120-28" name="__codelineno-120-28"></a>                            <span class="n">defaults</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-120-29" name="__codelineno-120-29"></a>                                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
<a id="__codelineno-120-30" name="__codelineno-120-30"></a>                                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">],</span>
<a id="__codelineno-120-31" name="__codelineno-120-31"></a>                                <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">],</span>
<a id="__codelineno-120-32" name="__codelineno-120-32"></a>                            <span class="p">}</span>
<a id="__codelineno-120-33" name="__codelineno-120-33"></a>                        <span class="p">)</span>
<a id="__codelineno-120-34" name="__codelineno-120-34"></a>                        <span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;Created&#39;</span> <span class="k">if</span> <span class="n">created</span> <span class="k">else</span> <span class="s1">&#39;Updated&#39;</span>
<a id="__codelineno-120-35" name="__codelineno-120-35"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">SUCCESS</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2"> Product: </span><span class="si">{</span><span class="n">product</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
<a id="__codelineno-120-36" name="__codelineno-120-36"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-120-37" name="__codelineno-120-37"></a>                        <span class="n">Product</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
<a id="__codelineno-120-38" name="__codelineno-120-38"></a>                            <span class="n">sku</span><span class="o">=</span><span class="n">sku</span><span class="p">,</span>
<a id="__codelineno-120-39" name="__codelineno-120-39"></a>                            <span class="n">name</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
<a id="__codelineno-120-40" name="__codelineno-120-40"></a>                            <span class="n">description</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">],</span>
<a id="__codelineno-120-41" name="__codelineno-120-41"></a>                            <span class="n">price</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">],</span>
<a id="__codelineno-120-42" name="__codelineno-120-42"></a>                        <span class="p">)</span>
<a id="__codelineno-120-43" name="__codelineno-120-43"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">SUCCESS</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created Product: </span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
<a id="__codelineno-120-44" name="__codelineno-120-44"></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
<a id="__codelineno-120-45" name="__codelineno-120-45"></a>            <span class="k">raise</span> <span class="n">CommandError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File </span><span class="si">{</span><span class="n">csv_file</span><span class="si">}</span><span class="s2"> does not exist&quot;</span><span class="p">)</span>
<a id="__codelineno-120-46" name="__codelineno-120-46"></a>        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-120-47" name="__codelineno-120-47"></a>            <span class="k">raise</span> <span class="n">CommandError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing column in CSV: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-120-48" name="__codelineno-120-48"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-120-49" name="__codelineno-120-49"></a>            <span class="k">raise</span> <span class="n">CommandError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p><strong>Features:</strong>
- <strong>Arguments:</strong>
  - <code>csv_file</code>: Positional argument specifying the CSV file path.
  - <code>--update</code>: Optional flag to update existing products based on SKU.</p>
<ul>
<li>
<p><strong>Error Handling:</strong> Gracefully handles file not found, missing columns, and other exceptions.</p>
</li>
<li>
<p><strong>Output:</strong> Provides success messages for created or updated products.</p>
</li>
</ul>
<h4 id="c-running-the-custom-command">c. Running the Custom Command</h4>
<p>Execute the command using Django’s <code>manage.py</code>, providing the path to the CSV file.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-121-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-121-1" name="__codelineno-121-1"></a>python<span class="w"> </span>manage.py<span class="w"> </span>import_csv<span class="w"> </span>path/to/products.csv
</code></pre></div></td></tr></table></div>
<p><strong>With Update Flag:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-122-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-122-1" name="__codelineno-122-1"></a>python<span class="w"> </span>manage.py<span class="w"> </span>import_csv<span class="w"> </span>path/to/products.csv<span class="w"> </span>--update
</code></pre></div></td></tr></table></div></p>
<h3 id="2-advanced-features">2. Advanced Features</h3>
<h4 id="a-verbose-mode">a. Verbose Mode</h4>
<p>Control the level of output detail.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-123-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-123-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-123-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-123-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-123-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-123-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-123-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-123-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-123-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-123-10">10</a></span>
<span class="normal"><a href="#__codelineno-123-11">11</a></span>
<span class="normal"><a href="#__codelineno-123-12">12</a></span>
<span class="normal"><a href="#__codelineno-123-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-123-1" name="__codelineno-123-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
<a id="__codelineno-123-2" name="__codelineno-123-2"></a>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;csv_file&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Path to the CSV file to import&#39;</span><span class="p">)</span>
<a id="__codelineno-123-3" name="__codelineno-123-3"></a>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<a id="__codelineno-123-4" name="__codelineno-123-4"></a>        <span class="s1">&#39;--update&#39;</span><span class="p">,</span>
<a id="__codelineno-123-5" name="__codelineno-123-5"></a>        <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span>
<a id="__codelineno-123-6" name="__codelineno-123-6"></a>        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Update existing products instead of creating new ones&#39;</span><span class="p">,</span>
<a id="__codelineno-123-7" name="__codelineno-123-7"></a>    <span class="p">)</span>
<a id="__codelineno-123-8" name="__codelineno-123-8"></a>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<a id="__codelineno-123-9" name="__codelineno-123-9"></a>        <span class="s1">&#39;--verbosity&#39;</span><span class="p">,</span>
<a id="__codelineno-123-10" name="__codelineno-123-10"></a>        <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-123-11" name="__codelineno-123-11"></a>        <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<a id="__codelineno-123-12" name="__codelineno-123-12"></a>        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Verbosity level; 0=minimal, 1=normal, 2=maximum&#39;</span><span class="p">,</span>
<a id="__codelineno-123-13" name="__codelineno-123-13"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p><strong>Usage:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-124-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-124-1" name="__codelineno-124-1"></a>python<span class="w"> </span>manage.py<span class="w"> </span>import_csv<span class="w"> </span>path/to/products.csv<span class="w"> </span>--verbosity<span class="w"> </span><span class="m">2</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="b-dry-run-option">b. Dry-Run Option</h4>
<p>Simulate the import without making database changes.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-125-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-125-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-125-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-125-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-125-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-125-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-125-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-125-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-125-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-125-10">10</a></span>
<span class="normal"><a href="#__codelineno-125-11">11</a></span>
<span class="normal"><a href="#__codelineno-125-12">12</a></span>
<span class="normal"><a href="#__codelineno-125-13">13</a></span>
<span class="normal"><a href="#__codelineno-125-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-125-1" name="__codelineno-125-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
<a id="__codelineno-125-2" name="__codelineno-125-2"></a>    <span class="c1"># ... existing arguments ...</span>
<a id="__codelineno-125-3" name="__codelineno-125-3"></a>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<a id="__codelineno-125-4" name="__codelineno-125-4"></a>        <span class="s1">&#39;--dry-run&#39;</span><span class="p">,</span>
<a id="__codelineno-125-5" name="__codelineno-125-5"></a>        <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span>
<a id="__codelineno-125-6" name="__codelineno-125-6"></a>        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Simulate the import without saving to the database&#39;</span><span class="p">,</span>
<a id="__codelineno-125-7" name="__codelineno-125-7"></a>    <span class="p">)</span>
<a id="__codelineno-125-8" name="__codelineno-125-8"></a>
<a id="__codelineno-125-9" name="__codelineno-125-9"></a><span class="k">def</span><span class="w"> </span><span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
<a id="__codelineno-125-10" name="__codelineno-125-10"></a>    <span class="n">dry_run</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;dry_run&#39;</span><span class="p">]</span>
<a id="__codelineno-125-11" name="__codelineno-125-11"></a>    <span class="c1"># Implement logic accordingly</span>
<a id="__codelineno-125-12" name="__codelineno-125-12"></a>    <span class="k">if</span> <span class="n">dry_run</span><span class="p">:</span>
<a id="__codelineno-125-13" name="__codelineno-125-13"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Dry run: No changes will be made to the database.&quot;</span><span class="p">)</span>
<a id="__codelineno-125-14" name="__codelineno-125-14"></a>    <span class="c1"># Proceed with import logic</span>
</code></pre></div></td></tr></table></div>
<h4 id="c-transaction-management">c. Transaction Management</h4>
<p>Ensure atomic operations to maintain database integrity.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-126-1">1</a></span>
<span class="normal"><a href="#__codelineno-126-2">2</a></span>
<span class="normal"><a href="#__codelineno-126-3">3</a></span>
<span class="normal"><a href="#__codelineno-126-4">4</a></span>
<span class="normal"><a href="#__codelineno-126-5">5</a></span>
<span class="normal"><a href="#__codelineno-126-6">6</a></span>
<span class="normal"><a href="#__codelineno-126-7">7</a></span>
<span class="normal"><a href="#__codelineno-126-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-126-1" name="__codelineno-126-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">transaction</span>
<a id="__codelineno-126-2" name="__codelineno-126-2"></a>
<a id="__codelineno-126-3" name="__codelineno-126-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
<a id="__codelineno-126-4" name="__codelineno-126-4"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-126-5" name="__codelineno-126-5"></a>        <span class="k">with</span> <span class="n">transaction</span><span class="o">.</span><span class="n">atomic</span><span class="p">():</span>
<a id="__codelineno-126-6" name="__codelineno-126-6"></a>            <span class="c1"># Import logic</span>
<a id="__codelineno-126-7" name="__codelineno-126-7"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-126-8" name="__codelineno-126-8"></a>        <span class="k">raise</span> <span class="n">CommandError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="3-testing-custom-commands">3. Testing Custom Commands</h3>
<p>Ensure custom commands function correctly and handle edge cases.</p>
<p><strong>Example Using Django’s Test Framework:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-127-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-127-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-127-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-127-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-127-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-127-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-127-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-127-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-127-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-127-10">10</a></span>
<span class="normal"><a href="#__codelineno-127-11">11</a></span>
<span class="normal"><a href="#__codelineno-127-12">12</a></span>
<span class="normal"><a href="#__codelineno-127-13">13</a></span>
<span class="normal"><a href="#__codelineno-127-14">14</a></span>
<span class="normal"><a href="#__codelineno-127-15">15</a></span>
<span class="normal"><a href="#__codelineno-127-16">16</a></span>
<span class="normal"><a href="#__codelineno-127-17">17</a></span>
<span class="normal"><a href="#__codelineno-127-18">18</a></span>
<span class="normal"><a href="#__codelineno-127-19">19</a></span>
<span class="normal"><a href="#__codelineno-127-20">20</a></span>
<span class="normal"><a href="#__codelineno-127-21">21</a></span>
<span class="normal"><a href="#__codelineno-127-22">22</a></span>
<span class="normal"><a href="#__codelineno-127-23">23</a></span>
<span class="normal"><a href="#__codelineno-127-24">24</a></span>
<span class="normal"><a href="#__codelineno-127-25">25</a></span>
<span class="normal"><a href="#__codelineno-127-26">26</a></span>
<span class="normal"><a href="#__codelineno-127-27">27</a></span>
<span class="normal"><a href="#__codelineno-127-28">28</a></span>
<span class="normal"><a href="#__codelineno-127-29">29</a></span>
<span class="normal"><a href="#__codelineno-127-30">30</a></span>
<span class="normal"><a href="#__codelineno-127-31">31</a></span>
<span class="normal"><a href="#__codelineno-127-32">32</a></span>
<span class="normal"><a href="#__codelineno-127-33">33</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-127-1" name="__codelineno-127-1"></a><span class="c1"># myapp/tests/test_commands.py</span>
<a id="__codelineno-127-2" name="__codelineno-127-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.core.management</span><span class="w"> </span><span class="kn">import</span> <span class="n">call_command</span>
<a id="__codelineno-127-3" name="__codelineno-127-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.test</span><span class="w"> </span><span class="kn">import</span> <span class="n">TestCase</span>
<a id="__codelineno-127-4" name="__codelineno-127-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">myapp.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Product</span>
<a id="__codelineno-127-5" name="__codelineno-127-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-127-6" name="__codelineno-127-6"></a>
<a id="__codelineno-127-7" name="__codelineno-127-7"></a><span class="k">class</span><span class="w"> </span><span class="nc">ImportCSVCommandTest</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
<a id="__codelineno-127-8" name="__codelineno-127-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-127-9" name="__codelineno-127-9"></a>        <span class="c1"># Create a sample CSV file</span>
<a id="__codelineno-127-10" name="__codelineno-127-10"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">csv_path</span> <span class="o">=</span> <span class="s1">&#39;test_products.csv&#39;</span>
<a id="__codelineno-127-11" name="__codelineno-127-11"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">csv_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-127-12" name="__codelineno-127-12"></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;sku,name,description,price</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-127-13" name="__codelineno-127-13"></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;SKU001,Product 1,Description 1,10.99</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-127-14" name="__codelineno-127-14"></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;SKU002,Product 2,Description 2,19.99</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-127-15" name="__codelineno-127-15"></a>
<a id="__codelineno-127-16" name="__codelineno-127-16"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-127-17" name="__codelineno-127-17"></a>        <span class="c1"># Remove the sample CSV file</span>
<a id="__codelineno-127-18" name="__codelineno-127-18"></a>        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">csv_path</span><span class="p">)</span>
<a id="__codelineno-127-19" name="__codelineno-127-19"></a>
<a id="__codelineno-127-20" name="__codelineno-127-20"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_import_csv_creation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-127-21" name="__codelineno-127-21"></a>        <span class="n">call_command</span><span class="p">(</span><span class="s1">&#39;import_csv&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">csv_path</span><span class="p">)</span>
<a id="__codelineno-127-22" name="__codelineno-127-22"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Product</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-127-23" name="__codelineno-127-23"></a>        <span class="n">product</span> <span class="o">=</span> <span class="n">Product</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sku</span><span class="o">=</span><span class="s1">&#39;SKU001&#39;</span><span class="p">)</span>
<a id="__codelineno-127-24" name="__codelineno-127-24"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">product</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;Product 1&#39;</span><span class="p">)</span>
<a id="__codelineno-127-25" name="__codelineno-127-25"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">product</span><span class="o">.</span><span class="n">price</span><span class="p">,</span> <span class="mf">10.99</span><span class="p">)</span>
<a id="__codelineno-127-26" name="__codelineno-127-26"></a>
<a id="__codelineno-127-27" name="__codelineno-127-27"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_import_csv_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-127-28" name="__codelineno-127-28"></a>        <span class="n">Product</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">sku</span><span class="o">=</span><span class="s1">&#39;SKU001&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Old Product&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Old Description&#39;</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="mf">5.00</span><span class="p">)</span>
<a id="__codelineno-127-29" name="__codelineno-127-29"></a>        <span class="n">call_command</span><span class="p">(</span><span class="s1">&#39;import_csv&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">csv_path</span><span class="p">,</span> <span class="s1">&#39;--update&#39;</span><span class="p">)</span>
<a id="__codelineno-127-30" name="__codelineno-127-30"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Product</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-127-31" name="__codelineno-127-31"></a>        <span class="n">product</span> <span class="o">=</span> <span class="n">Product</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sku</span><span class="o">=</span><span class="s1">&#39;SKU001&#39;</span><span class="p">)</span>
<a id="__codelineno-127-32" name="__codelineno-127-32"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">product</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;Product 1&#39;</span><span class="p">)</span>
<a id="__codelineno-127-33" name="__codelineno-127-33"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">product</span><span class="o">.</span><span class="n">price</span><span class="p">,</span> <span class="mf">10.99</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Conclusion:</strong><br />
Custom management commands in Django are powerful tools for automating tasks like data imports, maintenance, and more. By following Django’s conventions and incorporating advanced features such as verbosity control, dry-run options, and transaction management, developers can create robust and reusable commands that enhance application functionality and maintainability.</p>
<hr />
<h1 id="9-testing-strategies-in-django">9. Testing Strategies in Django</h1>
<p><strong>Question:</strong><br />
What are the best practices for writing tests in Django applications? Discuss how to use Django's testing framework to write unit tests, integration tests, and end-to-end tests. Additionally, explain how to utilize tools like pytest and factory_boy to enhance testing efficiency.</p>
<p><strong>Answer:</strong></p>
<p>Comprehensive testing ensures Django applications are reliable, maintainable, and free of regressions. Employing a mix of unit, integration, and end-to-end (E2E) tests, alongside tools like <code>pytest</code> and <code>factory_boy</code>, enhances testing efficiency and coverage.</p>
<h3 id="1-types-of-tests">1. Types of Tests</h3>
<ul>
<li><strong>Unit Tests:</strong> Test individual components (functions, methods) in isolation.</li>
<li><strong>Integration Tests:</strong> Test interactions between multiple components or layers.</li>
<li><strong>End-to-End (E2E) Tests:</strong> Simulate real user scenarios, testing the application as a whole.</li>
</ul>
<h3 id="2-djangos-built-in-testing-framework">2. Django’s Built-in Testing Framework</h3>
<p>Django provides a robust testing framework based on Python’s <code>unittest</code> module.</p>
<h4 id="a-unit-tests">a. Unit Tests</h4>
<p><strong>Example: Testing a Model Method</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-128-1">1</a></span>
<span class="normal"><a href="#__codelineno-128-2">2</a></span>
<span class="normal"><a href="#__codelineno-128-3">3</a></span>
<span class="normal"><a href="#__codelineno-128-4">4</a></span>
<span class="normal"><a href="#__codelineno-128-5">5</a></span>
<span class="normal"><a href="#__codelineno-128-6">6</a></span>
<span class="normal"><a href="#__codelineno-128-7">7</a></span>
<span class="normal"><a href="#__codelineno-128-8">8</a></span>
<span class="normal"><a href="#__codelineno-128-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-128-1" name="__codelineno-128-1"></a><span class="c1"># myapp/models.py</span>
<a id="__codelineno-128-2" name="__codelineno-128-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
<a id="__codelineno-128-3" name="__codelineno-128-3"></a>
<a id="__codelineno-128-4" name="__codelineno-128-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">Product</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-128-5" name="__codelineno-128-5"></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-128-6" name="__codelineno-128-6"></a>    <span class="n">price</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DecimalField</span><span class="p">(</span><span class="n">max_digits</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-128-7" name="__codelineno-128-7"></a>
<a id="__codelineno-128-8" name="__codelineno-128-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_expensive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-128-9" name="__codelineno-128-9"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">price</span> <span class="o">&gt;</span> <span class="mi">100</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-129-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-129-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-129-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-129-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-129-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-129-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-129-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-129-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-129-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-129-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-129-1" name="__codelineno-129-1"></a><span class="c1"># myapp/tests/test_models.py</span>
<a id="__codelineno-129-2" name="__codelineno-129-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.test</span><span class="w"> </span><span class="kn">import</span> <span class="n">TestCase</span>
<a id="__codelineno-129-3" name="__codelineno-129-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">myapp.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Product</span>
<a id="__codelineno-129-4" name="__codelineno-129-4"></a>
<a id="__codelineno-129-5" name="__codelineno-129-5"></a><span class="k">class</span><span class="w"> </span><span class="nc">ProductModelTest</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
<a id="__codelineno-129-6" name="__codelineno-129-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_is_expensive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-129-7" name="__codelineno-129-7"></a>        <span class="n">cheap_product</span> <span class="o">=</span> <span class="n">Product</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Cheap&#39;</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-129-8" name="__codelineno-129-8"></a>        <span class="n">expensive_product</span> <span class="o">=</span> <span class="n">Product</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Expensive&#39;</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<a id="__codelineno-129-9" name="__codelineno-129-9"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">cheap_product</span><span class="o">.</span><span class="n">is_expensive</span><span class="p">())</span>
<a id="__codelineno-129-10" name="__codelineno-129-10"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">expensive_product</span><span class="o">.</span><span class="n">is_expensive</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<h4 id="b-integration-tests">b. Integration Tests</h4>
<p><strong>Example: Testing a View and Template Rendering</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-130-1">1</a></span>
<span class="normal"><a href="#__codelineno-130-2">2</a></span>
<span class="normal"><a href="#__codelineno-130-3">3</a></span>
<span class="normal"><a href="#__codelineno-130-4">4</a></span>
<span class="normal"><a href="#__codelineno-130-5">5</a></span>
<span class="normal"><a href="#__codelineno-130-6">6</a></span>
<span class="normal"><a href="#__codelineno-130-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-130-1" name="__codelineno-130-1"></a><span class="c1"># myapp/views.py</span>
<a id="__codelineno-130-2" name="__codelineno-130-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.shortcuts</span><span class="w"> </span><span class="kn">import</span> <span class="n">render</span>
<a id="__codelineno-130-3" name="__codelineno-130-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Product</span>
<a id="__codelineno-130-4" name="__codelineno-130-4"></a>
<a id="__codelineno-130-5" name="__codelineno-130-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">product_list</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-130-6" name="__codelineno-130-6"></a>    <span class="n">products</span> <span class="o">=</span> <span class="n">Product</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-130-7" name="__codelineno-130-7"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;myapp/product_list.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;products&#39;</span><span class="p">:</span> <span class="n">products</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-131-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-131-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-131-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-131-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-131-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-131-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-131-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-131-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-131-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-131-10">10</a></span>
<span class="normal"><a href="#__codelineno-131-11">11</a></span>
<span class="normal"><a href="#__codelineno-131-12">12</a></span>
<span class="normal"><a href="#__codelineno-131-13">13</a></span>
<span class="normal"><a href="#__codelineno-131-14">14</a></span>
<span class="normal"><a href="#__codelineno-131-15">15</a></span>
<span class="normal"><a href="#__codelineno-131-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-131-1" name="__codelineno-131-1"></a><span class="c1"># myapp/tests/test_views.py</span>
<a id="__codelineno-131-2" name="__codelineno-131-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.test</span><span class="w"> </span><span class="kn">import</span> <span class="n">TestCase</span>
<a id="__codelineno-131-3" name="__codelineno-131-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">reverse</span>
<a id="__codelineno-131-4" name="__codelineno-131-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">myapp.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Product</span>
<a id="__codelineno-131-5" name="__codelineno-131-5"></a>
<a id="__codelineno-131-6" name="__codelineno-131-6"></a><span class="k">class</span><span class="w"> </span><span class="nc">ProductListViewTest</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
<a id="__codelineno-131-7" name="__codelineno-131-7"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-131-8" name="__codelineno-131-8"></a>        <span class="n">Product</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Product 1&#39;</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="mf">10.99</span><span class="p">)</span>
<a id="__codelineno-131-9" name="__codelineno-131-9"></a>        <span class="n">Product</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Product 2&#39;</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="mf">19.99</span><span class="p">)</span>
<a id="__codelineno-131-10" name="__codelineno-131-10"></a>
<a id="__codelineno-131-11" name="__codelineno-131-11"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_product_list_view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-131-12" name="__codelineno-131-12"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;product_list&#39;</span><span class="p">))</span>
<a id="__codelineno-131-13" name="__codelineno-131-13"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<a id="__codelineno-131-14" name="__codelineno-131-14"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;Product 1&#39;</span><span class="p">)</span>
<a id="__codelineno-131-15" name="__codelineno-131-15"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;Product 2&#39;</span><span class="p">)</span>
<a id="__codelineno-131-16" name="__codelineno-131-16"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertTemplateUsed</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;myapp/product_list.html&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h4 id="c-end-to-end-e2e-tests">c. End-to-End (E2E) Tests</h4>
<p><strong>Example Using Selenium and <code>LiveServerTestCase</code>:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-132-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-132-1" name="__codelineno-132-1"></a>pip<span class="w"> </span>install<span class="w"> </span>selenium
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-133-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-133-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-133-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-133-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-133-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-133-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-133-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-133-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-133-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-133-10">10</a></span>
<span class="normal"><a href="#__codelineno-133-11">11</a></span>
<span class="normal"><a href="#__codelineno-133-12">12</a></span>
<span class="normal"><a href="#__codelineno-133-13">13</a></span>
<span class="normal"><a href="#__codelineno-133-14">14</a></span>
<span class="normal"><a href="#__codelineno-133-15">15</a></span>
<span class="normal"><a href="#__codelineno-133-16">16</a></span>
<span class="normal"><a href="#__codelineno-133-17">17</a></span>
<span class="normal"><a href="#__codelineno-133-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-133-1" name="__codelineno-133-1"></a><span class="c1"># myapp/tests/test_e2e.py</span>
<a id="__codelineno-133-2" name="__codelineno-133-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.test</span><span class="w"> </span><span class="kn">import</span> <span class="n">LiveServerTestCase</span>
<a id="__codelineno-133-3" name="__codelineno-133-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">selenium</span><span class="w"> </span><span class="kn">import</span> <span class="n">webdriver</span>
<a id="__codelineno-133-4" name="__codelineno-133-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">reverse</span>
<a id="__codelineno-133-5" name="__codelineno-133-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">myapp.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Product</span>
<a id="__codelineno-133-6" name="__codelineno-133-6"></a>
<a id="__codelineno-133-7" name="__codelineno-133-7"></a><span class="k">class</span><span class="w"> </span><span class="nc">ProductListE2ETest</span><span class="p">(</span><span class="n">LiveServerTestCase</span><span class="p">):</span>
<a id="__codelineno-133-8" name="__codelineno-133-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-133-9" name="__codelineno-133-9"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Firefox</span><span class="p">()</span>
<a id="__codelineno-133-10" name="__codelineno-133-10"></a>        <span class="n">Product</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Product 1&#39;</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="mf">10.99</span><span class="p">)</span>
<a id="__codelineno-133-11" name="__codelineno-133-11"></a>
<a id="__codelineno-133-12" name="__codelineno-133-12"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-133-13" name="__codelineno-133-13"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
<a id="__codelineno-133-14" name="__codelineno-133-14"></a>
<a id="__codelineno-133-15" name="__codelineno-133-15"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_can_view_product_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-133-16" name="__codelineno-133-16"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">live_server_url</span> <span class="o">+</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;product_list&#39;</span><span class="p">))</span>
<a id="__codelineno-133-17" name="__codelineno-133-17"></a>        <span class="n">body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_tag_name</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
<a id="__codelineno-133-18" name="__codelineno-133-18"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s1">&#39;Product 1&#39;</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p><strong>Advanced E2E Testing with Headless Browsers:</strong></p>
<p>Use headless browsers like Chrome Headless for faster testing environments.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-134-1">1</a></span>
<span class="normal"><a href="#__codelineno-134-2">2</a></span>
<span class="normal"><a href="#__codelineno-134-3">3</a></span>
<span class="normal"><a href="#__codelineno-134-4">4</a></span>
<span class="normal"><a href="#__codelineno-134-5">5</a></span>
<span class="normal"><a href="#__codelineno-134-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-134-1" name="__codelineno-134-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">selenium.webdriver.chrome.options</span><span class="w"> </span><span class="kn">import</span> <span class="n">Options</span>
<a id="__codelineno-134-2" name="__codelineno-134-2"></a>
<a id="__codelineno-134-3" name="__codelineno-134-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-134-4" name="__codelineno-134-4"></a>    <span class="n">chrome_options</span> <span class="o">=</span> <span class="n">Options</span><span class="p">()</span>
<a id="__codelineno-134-5" name="__codelineno-134-5"></a>    <span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--headless&quot;</span><span class="p">)</span>
<a id="__codelineno-134-6" name="__codelineno-134-6"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">chrome_options</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="3-enhancing-testing-with-pytest">3. Enhancing Testing with <code>pytest</code></h3>
<p><code>pytest</code> offers a more flexible and feature-rich testing framework compared to Django’s default <code>unittest</code>-based framework.</p>
<h4 id="a-installation-and-configuration">a. Installation and Configuration</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-135-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-135-1" name="__codelineno-135-1"></a>pip<span class="w"> </span>install<span class="w"> </span>pytest<span class="w"> </span>pytest-django
</code></pre></div></td></tr></table></div>
<p>Create a <code>pytest.ini</code> in the project root.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-136-1">1</a></span>
<span class="normal"><a href="#__codelineno-136-2">2</a></span>
<span class="normal"><a href="#__codelineno-136-3">3</a></span>
<span class="normal"><a href="#__codelineno-136-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-136-1" name="__codelineno-136-1"></a><span class="c1"># pytest.ini</span>
<a id="__codelineno-136-2" name="__codelineno-136-2"></a><span class="k">[pytest]</span>
<a id="__codelineno-136-3" name="__codelineno-136-3"></a><span class="na">DJANGO_SETTINGS_MODULE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">myproject.settings</span>
<a id="__codelineno-136-4" name="__codelineno-136-4"></a><span class="na">python_files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">tests.py test_*.py *_tests.py</span>
</code></pre></div></td></tr></table></div>
<h4 id="b-writing-tests-with-pytest">b. Writing Tests with <code>pytest</code></h4>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-137-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-137-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-137-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-137-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-137-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-137-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-137-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-137-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-137-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-137-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-137-1" name="__codelineno-137-1"></a><span class="c1"># myapp/tests/test_models.py</span>
<a id="__codelineno-137-2" name="__codelineno-137-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<a id="__codelineno-137-3" name="__codelineno-137-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">myapp.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Product</span>
<a id="__codelineno-137-4" name="__codelineno-137-4"></a>
<a id="__codelineno-137-5" name="__codelineno-137-5"></a><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">django_db</span>
<a id="__codelineno-137-6" name="__codelineno-137-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_is_expensive</span><span class="p">():</span>
<a id="__codelineno-137-7" name="__codelineno-137-7"></a>    <span class="n">cheap_product</span> <span class="o">=</span> <span class="n">Product</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Cheap&#39;</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-137-8" name="__codelineno-137-8"></a>    <span class="n">expensive_product</span> <span class="o">=</span> <span class="n">Product</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Expensive&#39;</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<a id="__codelineno-137-9" name="__codelineno-137-9"></a>    <span class="k">assert</span> <span class="ow">not</span> <span class="n">cheap_product</span><span class="o">.</span><span class="n">is_expensive</span><span class="p">()</span>
<a id="__codelineno-137-10" name="__codelineno-137-10"></a>    <span class="k">assert</span> <span class="n">expensive_product</span><span class="o">.</span><span class="n">is_expensive</span><span class="p">()</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Advantages:</strong>
- <strong>Fixture Management:</strong> More flexible fixtures with <code>@pytest.fixture</code>.
- <strong>Better Assertions:</strong> Enhanced assertion introspection for clearer error messages.
- <strong>Plugin Ecosystem:</strong> Access to a rich set of plugins for extended functionality (e.g., coverage, mocking).</p>
<h3 id="4-enhancing-testing-with-factory_boy">4. Enhancing Testing with <code>factory_boy</code></h3>
<p><code>factory_boy</code> is a fixtures replacement tool that helps create test data efficiently and flexibly.</p>
<h4 id="a-installation">a. Installation</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-138-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-138-1" name="__codelineno-138-1"></a>pip<span class="w"> </span>install<span class="w"> </span>factory_boy
</code></pre></div></td></tr></table></div>
<h4 id="b-defining-factories">b. Defining Factories</h4>
<p><strong>Example:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-139-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-139-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-139-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-139-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-139-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-139-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-139-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-139-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-139-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-139-10">10</a></span>
<span class="normal"><a href="#__codelineno-139-11">11</a></span>
<span class="normal"><a href="#__codelineno-139-12">12</a></span>
<span class="normal"><a href="#__codelineno-139-13">13</a></span>
<span class="normal"><a href="#__codelineno-139-14">14</a></span>
<span class="normal"><a href="#__codelineno-139-15">15</a></span>
<span class="normal"><a href="#__codelineno-139-16">16</a></span>
<span class="normal"><a href="#__codelineno-139-17">17</a></span>
<span class="normal"><a href="#__codelineno-139-18">18</a></span>
<span class="normal"><a href="#__codelineno-139-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-139-1" name="__codelineno-139-1"></a><span class="c1"># myapp/tests/factories.py</span>
<a id="__codelineno-139-2" name="__codelineno-139-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">factory</span>
<a id="__codelineno-139-3" name="__codelineno-139-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">User</span>
<a id="__codelineno-139-4" name="__codelineno-139-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">myapp.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Product</span>
<a id="__codelineno-139-5" name="__codelineno-139-5"></a>
<a id="__codelineno-139-6" name="__codelineno-139-6"></a><span class="k">class</span><span class="w"> </span><span class="nc">UserFactory</span><span class="p">(</span><span class="n">factory</span><span class="o">.</span><span class="n">django</span><span class="o">.</span><span class="n">DjangoModelFactory</span><span class="p">):</span>
<a id="__codelineno-139-7" name="__codelineno-139-7"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
<a id="__codelineno-139-8" name="__codelineno-139-8"></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">User</span>
<a id="__codelineno-139-9" name="__codelineno-139-9"></a>
<a id="__codelineno-139-10" name="__codelineno-139-10"></a>    <span class="n">username</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">Faker</span><span class="p">(</span><span class="s1">&#39;user_name&#39;</span><span class="p">)</span>
<a id="__codelineno-139-11" name="__codelineno-139-11"></a>    <span class="n">email</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">Faker</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">)</span>
<a id="__codelineno-139-12" name="__codelineno-139-12"></a>    <span class="n">password</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">PostGenerationMethodCall</span><span class="p">(</span><span class="s1">&#39;set_password&#39;</span><span class="p">,</span> <span class="s1">&#39;password123&#39;</span><span class="p">)</span>
<a id="__codelineno-139-13" name="__codelineno-139-13"></a>
<a id="__codelineno-139-14" name="__codelineno-139-14"></a><span class="k">class</span><span class="w"> </span><span class="nc">ProductFactory</span><span class="p">(</span><span class="n">factory</span><span class="o">.</span><span class="n">django</span><span class="o">.</span><span class="n">DjangoModelFactory</span><span class="p">):</span>
<a id="__codelineno-139-15" name="__codelineno-139-15"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
<a id="__codelineno-139-16" name="__codelineno-139-16"></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">Product</span>
<a id="__codelineno-139-17" name="__codelineno-139-17"></a>
<a id="__codelineno-139-18" name="__codelineno-139-18"></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">Faker</span><span class="p">(</span><span class="s1">&#39;word&#39;</span><span class="p">)</span>
<a id="__codelineno-139-19" name="__codelineno-139-19"></a>    <span class="n">price</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">Faker</span><span class="p">(</span><span class="s1">&#39;pydecimal&#39;</span><span class="p">,</span> <span class="n">left_digits</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">right_digits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h4 id="c-using-factories-in-tests">c. Using Factories in Tests</h4>
<p><strong>Example:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-140-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-140-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-140-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-140-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-140-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-140-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-140-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-140-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-140-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-140-10">10</a></span>
<span class="normal"><a href="#__codelineno-140-11">11</a></span>
<span class="normal"><a href="#__codelineno-140-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-140-1" name="__codelineno-140-1"></a><span class="c1"># myapp/tests/test_views.py</span>
<a id="__codelineno-140-2" name="__codelineno-140-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<a id="__codelineno-140-3" name="__codelineno-140-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">reverse</span>
<a id="__codelineno-140-4" name="__codelineno-140-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.factories</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProductFactory</span>
<a id="__codelineno-140-5" name="__codelineno-140-5"></a>
<a id="__codelineno-140-6" name="__codelineno-140-6"></a><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">django_db</span>
<a id="__codelineno-140-7" name="__codelineno-140-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_product_list_view</span><span class="p">(</span><span class="n">client</span><span class="p">):</span>
<a id="__codelineno-140-8" name="__codelineno-140-8"></a>    <span class="n">products</span> <span class="o">=</span> <span class="n">ProductFactory</span><span class="o">.</span><span class="n">create_batch</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a id="__codelineno-140-9" name="__codelineno-140-9"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;product_list&#39;</span><span class="p">))</span>
<a id="__codelineno-140-10" name="__codelineno-140-10"></a>    <span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span>
<a id="__codelineno-140-11" name="__codelineno-140-11"></a>    <span class="k">for</span> <span class="n">product</span> <span class="ow">in</span> <span class="n">products</span><span class="p">:</span>
<a id="__codelineno-140-12" name="__codelineno-140-12"></a>        <span class="k">assert</span> <span class="n">product</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<p><strong>Advanced Usage:</strong>
- <strong>Trait Definitions:</strong> Create variations of factories.
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-141-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-141-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-141-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-141-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-141-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-141-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-141-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-141-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-141-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-141-10">10</a></span>
<span class="normal"><a href="#__codelineno-141-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-141-1" name="__codelineno-141-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">ProductFactory</span><span class="p">(</span><span class="n">factory</span><span class="o">.</span><span class="n">django</span><span class="o">.</span><span class="n">DjangoModelFactory</span><span class="p">):</span>
<a id="__codelineno-141-2" name="__codelineno-141-2"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
<a id="__codelineno-141-3" name="__codelineno-141-3"></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">Product</span>
<a id="__codelineno-141-4" name="__codelineno-141-4"></a>
<a id="__codelineno-141-5" name="__codelineno-141-5"></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">Faker</span><span class="p">(</span><span class="s1">&#39;word&#39;</span><span class="p">)</span>
<a id="__codelineno-141-6" name="__codelineno-141-6"></a>    <span class="n">price</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">Faker</span><span class="p">(</span><span class="s1">&#39;pydecimal&#39;</span><span class="p">,</span> <span class="n">left_digits</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">right_digits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-141-7" name="__codelineno-141-7"></a>
<a id="__codelineno-141-8" name="__codelineno-141-8"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">Params</span><span class="p">:</span>
<a id="__codelineno-141-9" name="__codelineno-141-9"></a>        <span class="n">expensive</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">Trait</span><span class="p">(</span>
<a id="__codelineno-141-10" name="__codelineno-141-10"></a>            <span class="n">price</span><span class="o">=</span><span class="mi">150</span>
<a id="__codelineno-141-11" name="__codelineno-141-11"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
  <strong>Usage:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-142-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-142-1" name="__codelineno-142-1"></a><span class="n">expensive_product</span> <span class="o">=</span> <span class="n">ProductFactory</span><span class="p">(</span><span class="n">expensive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="5-additional-testing-best-practices">5. Additional Testing Best Practices</h3>
<h4 id="a-isolate-tests">a. Isolate Tests</h4>
<p>Ensure tests do not depend on each other and can run in any order. Use <code>setUp</code> and <code>tearDown</code> methods or fixtures to prepare test environments.</p>
<h4 id="b-use-test-coverage-tools">b. Use Test Coverage Tools</h4>
<p>Measure test coverage to identify untested code areas.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-143-1">1</a></span>
<span class="normal"><a href="#__codelineno-143-2">2</a></span>
<span class="normal"><a href="#__codelineno-143-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-143-1" name="__codelineno-143-1"></a>pip<span class="w"> </span>install<span class="w"> </span>coverage
<a id="__codelineno-143-2" name="__codelineno-143-2"></a>coverage<span class="w"> </span>run<span class="w"> </span>-m<span class="w"> </span>pytest
<a id="__codelineno-143-3" name="__codelineno-143-3"></a>coverage<span class="w"> </span>report
</code></pre></div></td></tr></table></div>
<h4 id="c-mock-external-dependencies">c. Mock External Dependencies</h4>
<p>Use mocking to simulate external services, APIs, or complex objects.</p>
<p><strong>Example Using <code>unittest.mock</code>:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-144-1">1</a></span>
<span class="normal"><a href="#__codelineno-144-2">2</a></span>
<span class="normal"><a href="#__codelineno-144-3">3</a></span>
<span class="normal"><a href="#__codelineno-144-4">4</a></span>
<span class="normal"><a href="#__codelineno-144-5">5</a></span>
<span class="normal"><a href="#__codelineno-144-6">6</a></span>
<span class="normal"><a href="#__codelineno-144-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-144-1" name="__codelineno-144-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">unittest.mock</span><span class="w"> </span><span class="kn">import</span> <span class="n">patch</span>
<a id="__codelineno-144-2" name="__codelineno-144-2"></a>
<a id="__codelineno-144-3" name="__codelineno-144-3"></a><span class="nd">@patch</span><span class="p">(</span><span class="s1">&#39;myapp.utils.send_email&#39;</span><span class="p">)</span>
<a id="__codelineno-144-4" name="__codelineno-144-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_user_registration</span><span class="p">(</span><span class="n">mock_send_email</span><span class="p">,</span> <span class="n">client</span><span class="p">):</span>
<a id="__codelineno-144-5" name="__codelineno-144-5"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s1">&#39;/register/&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;testuser&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="s1">&#39;pass&#39;</span><span class="p">})</span>
<a id="__codelineno-144-6" name="__codelineno-144-6"></a>    <span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">302</span>
<a id="__codelineno-144-7" name="__codelineno-144-7"></a>    <span class="n">mock_send_email</span><span class="o">.</span><span class="n">assert_called_once</span><span class="p">()</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="d-continuous-integration-ci">d. Continuous Integration (CI)</h4>
<p>Integrate tests into CI pipelines (e.g., GitHub Actions, GitLab CI) to run tests automatically on commits and pull requests.</p>
<p><strong>Example GitHub Actions Workflow:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-145-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-145-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-145-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-145-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-145-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-145-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-145-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-145-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-145-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-145-10">10</a></span>
<span class="normal"><a href="#__codelineno-145-11">11</a></span>
<span class="normal"><a href="#__codelineno-145-12">12</a></span>
<span class="normal"><a href="#__codelineno-145-13">13</a></span>
<span class="normal"><a href="#__codelineno-145-14">14</a></span>
<span class="normal"><a href="#__codelineno-145-15">15</a></span>
<span class="normal"><a href="#__codelineno-145-16">16</a></span>
<span class="normal"><a href="#__codelineno-145-17">17</a></span>
<span class="normal"><a href="#__codelineno-145-18">18</a></span>
<span class="normal"><a href="#__codelineno-145-19">19</a></span>
<span class="normal"><a href="#__codelineno-145-20">20</a></span>
<span class="normal"><a href="#__codelineno-145-21">21</a></span>
<span class="normal"><a href="#__codelineno-145-22">22</a></span>
<span class="normal"><a href="#__codelineno-145-23">23</a></span>
<span class="normal"><a href="#__codelineno-145-24">24</a></span>
<span class="normal"><a href="#__codelineno-145-25">25</a></span>
<span class="normal"><a href="#__codelineno-145-26">26</a></span>
<span class="normal"><a href="#__codelineno-145-27">27</a></span>
<span class="normal"><a href="#__codelineno-145-28">28</a></span>
<span class="normal"><a href="#__codelineno-145-29">29</a></span>
<span class="normal"><a href="#__codelineno-145-30">30</a></span>
<span class="normal"><a href="#__codelineno-145-31">31</a></span>
<span class="normal"><a href="#__codelineno-145-32">32</a></span>
<span class="normal"><a href="#__codelineno-145-33">33</a></span>
<span class="normal"><a href="#__codelineno-145-34">34</a></span>
<span class="normal"><a href="#__codelineno-145-35">35</a></span>
<span class="normal"><a href="#__codelineno-145-36">36</a></span>
<span class="normal"><a href="#__codelineno-145-37">37</a></span>
<span class="normal"><a href="#__codelineno-145-38">38</a></span>
<span class="normal"><a href="#__codelineno-145-39">39</a></span>
<span class="normal"><a href="#__codelineno-145-40">40</a></span>
<span class="normal"><a href="#__codelineno-145-41">41</a></span>
<span class="normal"><a href="#__codelineno-145-42">42</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-145-1" name="__codelineno-145-1"></a><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Django CI</span>
<a id="__codelineno-145-2" name="__codelineno-145-2"></a>
<a id="__codelineno-145-3" name="__codelineno-145-3"></a><span class="nt">on</span><span class="p">:</span>
<a id="__codelineno-145-4" name="__codelineno-145-4"></a><span class="w">  </span><span class="nt">push</span><span class="p">:</span>
<a id="__codelineno-145-5" name="__codelineno-145-5"></a><span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">main</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-145-6" name="__codelineno-145-6"></a><span class="w">  </span><span class="nt">pull_request</span><span class="p">:</span>
<a id="__codelineno-145-7" name="__codelineno-145-7"></a><span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">main</span><span class="w"> </span><span class="p p-Indicator">]</span>
<a id="__codelineno-145-8" name="__codelineno-145-8"></a>
<a id="__codelineno-145-9" name="__codelineno-145-9"></a><span class="nt">jobs</span><span class="p">:</span>
<a id="__codelineno-145-10" name="__codelineno-145-10"></a><span class="w">  </span><span class="nt">build</span><span class="p">:</span>
<a id="__codelineno-145-11" name="__codelineno-145-11"></a><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<a id="__codelineno-145-12" name="__codelineno-145-12"></a>
<a id="__codelineno-145-13" name="__codelineno-145-13"></a><span class="w">    </span><span class="nt">services</span><span class="p">:</span>
<a id="__codelineno-145-14" name="__codelineno-145-14"></a><span class="w">      </span><span class="nt">postgres</span><span class="p">:</span>
<a id="__codelineno-145-15" name="__codelineno-145-15"></a><span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres:12</span>
<a id="__codelineno-145-16" name="__codelineno-145-16"></a><span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<a id="__codelineno-145-17" name="__codelineno-145-17"></a><span class="w">          </span><span class="nt">POSTGRES_USER</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres</span>
<a id="__codelineno-145-18" name="__codelineno-145-18"></a><span class="w">          </span><span class="nt">POSTGRES_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres</span>
<a id="__codelineno-145-19" name="__codelineno-145-19"></a><span class="w">          </span><span class="nt">POSTGRES_DB</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test_db</span>
<a id="__codelineno-145-20" name="__codelineno-145-20"></a><span class="w">        </span><span class="nt">ports</span><span class="p">:</span>
<a id="__codelineno-145-21" name="__codelineno-145-21"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5432:5432</span>
<a id="__codelineno-145-22" name="__codelineno-145-22"></a><span class="w">        </span><span class="nt">options</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<a id="__codelineno-145-23" name="__codelineno-145-23"></a><span class="w">          </span><span class="no">--health-cmd pg_isready</span>
<a id="__codelineno-145-24" name="__codelineno-145-24"></a><span class="w">          </span><span class="no">--health-interval 10s</span>
<a id="__codelineno-145-25" name="__codelineno-145-25"></a><span class="w">          </span><span class="no">--health-timeout 5s</span>
<a id="__codelineno-145-26" name="__codelineno-145-26"></a><span class="w">          </span><span class="no">--health-retries 5</span>
<a id="__codelineno-145-27" name="__codelineno-145-27"></a>
<a id="__codelineno-145-28" name="__codelineno-145-28"></a><span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<a id="__codelineno-145-29" name="__codelineno-145-29"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v2</span>
<a id="__codelineno-145-30" name="__codelineno-145-30"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set up Python</span>
<a id="__codelineno-145-31" name="__codelineno-145-31"></a><span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/setup-python@v2</span>
<a id="__codelineno-145-32" name="__codelineno-145-32"></a><span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<a id="__codelineno-145-33" name="__codelineno-145-33"></a><span class="w">        </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.9&#39;</span>
<a id="__codelineno-145-34" name="__codelineno-145-34"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install dependencies</span>
<a id="__codelineno-145-35" name="__codelineno-145-35"></a><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-145-36" name="__codelineno-145-36"></a><span class="w">        </span><span class="no">python -m pip install --upgrade pip</span>
<a id="__codelineno-145-37" name="__codelineno-145-37"></a><span class="w">        </span><span class="no">pip install -r requirements.txt</span>
<a id="__codelineno-145-38" name="__codelineno-145-38"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run tests</span>
<a id="__codelineno-145-39" name="__codelineno-145-39"></a><span class="w">      </span><span class="nt">env</span><span class="p">:</span>
<a id="__codelineno-145-40" name="__codelineno-145-40"></a><span class="w">        </span><span class="nt">DATABASE_URL</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres://postgres:postgres@localhost:5432/test_db</span>
<a id="__codelineno-145-41" name="__codelineno-145-41"></a><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-145-42" name="__codelineno-145-42"></a><span class="w">        </span><span class="no">pytest</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="e-test-naming-conventions">e. Test Naming Conventions</h4>
<p>Use clear and descriptive names for test functions and classes to improve readability and maintainability.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-146-1">1</a></span>
<span class="normal"><a href="#__codelineno-146-2">2</a></span>
<span class="normal"><a href="#__codelineno-146-3">3</a></span>
<span class="normal"><a href="#__codelineno-146-4">4</a></span>
<span class="normal"><a href="#__codelineno-146-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-146-1" name="__codelineno-146-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_product_creation</span><span class="p">():</span>
<a id="__codelineno-146-2" name="__codelineno-146-2"></a>    <span class="k">pass</span>
<a id="__codelineno-146-3" name="__codelineno-146-3"></a>
<a id="__codelineno-146-4" name="__codelineno-146-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_user_registration_sends_email</span><span class="p">():</span>
<a id="__codelineno-146-5" name="__codelineno-146-5"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="6-example-comprehensive-testing-with-pytest-and-factory_boy">6. Example: Comprehensive Testing with <code>pytest</code> and <code>factory_boy</code></h3>
<h4 id="a-defining-factories">a. Defining Factories</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-147-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-147-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-147-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-147-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-147-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-147-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-147-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-147-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-147-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-147-10">10</a></span>
<span class="normal"><a href="#__codelineno-147-11">11</a></span>
<span class="normal"><a href="#__codelineno-147-12">12</a></span>
<span class="normal"><a href="#__codelineno-147-13">13</a></span>
<span class="normal"><a href="#__codelineno-147-14">14</a></span>
<span class="normal"><a href="#__codelineno-147-15">15</a></span>
<span class="normal"><a href="#__codelineno-147-16">16</a></span>
<span class="normal"><a href="#__codelineno-147-17">17</a></span>
<span class="normal"><a href="#__codelineno-147-18">18</a></span>
<span class="normal"><a href="#__codelineno-147-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-147-1" name="__codelineno-147-1"></a><span class="c1"># myapp/tests/factories.py</span>
<a id="__codelineno-147-2" name="__codelineno-147-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">factory</span>
<a id="__codelineno-147-3" name="__codelineno-147-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">User</span>
<a id="__codelineno-147-4" name="__codelineno-147-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">myapp.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Product</span>
<a id="__codelineno-147-5" name="__codelineno-147-5"></a>
<a id="__codelineno-147-6" name="__codelineno-147-6"></a><span class="k">class</span><span class="w"> </span><span class="nc">UserFactory</span><span class="p">(</span><span class="n">factory</span><span class="o">.</span><span class="n">django</span><span class="o">.</span><span class="n">DjangoModelFactory</span><span class="p">):</span>
<a id="__codelineno-147-7" name="__codelineno-147-7"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
<a id="__codelineno-147-8" name="__codelineno-147-8"></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">User</span>
<a id="__codelineno-147-9" name="__codelineno-147-9"></a>
<a id="__codelineno-147-10" name="__codelineno-147-10"></a>    <span class="n">username</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">Faker</span><span class="p">(</span><span class="s1">&#39;user_name&#39;</span><span class="p">)</span>
<a id="__codelineno-147-11" name="__codelineno-147-11"></a>    <span class="n">email</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">Faker</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">)</span>
<a id="__codelineno-147-12" name="__codelineno-147-12"></a>    <span class="n">password</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">PostGenerationMethodCall</span><span class="p">(</span><span class="s1">&#39;set_password&#39;</span><span class="p">,</span> <span class="s1">&#39;password123&#39;</span><span class="p">)</span>
<a id="__codelineno-147-13" name="__codelineno-147-13"></a>
<a id="__codelineno-147-14" name="__codelineno-147-14"></a><span class="k">class</span><span class="w"> </span><span class="nc">ProductFactory</span><span class="p">(</span><span class="n">factory</span><span class="o">.</span><span class="n">django</span><span class="o">.</span><span class="n">DjangoModelFactory</span><span class="p">):</span>
<a id="__codelineno-147-15" name="__codelineno-147-15"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
<a id="__codelineno-147-16" name="__codelineno-147-16"></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">Product</span>
<a id="__codelineno-147-17" name="__codelineno-147-17"></a>
<a id="__codelineno-147-18" name="__codelineno-147-18"></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">Faker</span><span class="p">(</span><span class="s1">&#39;word&#39;</span><span class="p">)</span>
<a id="__codelineno-147-19" name="__codelineno-147-19"></a>    <span class="n">price</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">Faker</span><span class="p">(</span><span class="s1">&#39;pydecimal&#39;</span><span class="p">,</span> <span class="n">left_digits</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">right_digits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h4 id="b-writing-a-view-test-using-pytest-and-factory_boy">b. Writing a View Test Using <code>pytest</code> and <code>factory_boy</code></h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-148-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-148-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-148-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-148-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-148-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-148-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-148-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-148-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-148-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-148-10">10</a></span>
<span class="normal"><a href="#__codelineno-148-11">11</a></span>
<span class="normal"><a href="#__codelineno-148-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-148-1" name="__codelineno-148-1"></a><span class="c1"># myapp/tests/test_views.py</span>
<a id="__codelineno-148-2" name="__codelineno-148-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<a id="__codelineno-148-3" name="__codelineno-148-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">reverse</span>
<a id="__codelineno-148-4" name="__codelineno-148-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.factories</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProductFactory</span>
<a id="__codelineno-148-5" name="__codelineno-148-5"></a>
<a id="__codelineno-148-6" name="__codelineno-148-6"></a><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">django_db</span>
<a id="__codelineno-148-7" name="__codelineno-148-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_product_list_view</span><span class="p">(</span><span class="n">client</span><span class="p">):</span>
<a id="__codelineno-148-8" name="__codelineno-148-8"></a>    <span class="n">products</span> <span class="o">=</span> <span class="n">ProductFactory</span><span class="o">.</span><span class="n">create_batch</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a id="__codelineno-148-9" name="__codelineno-148-9"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;product_list&#39;</span><span class="p">))</span>
<a id="__codelineno-148-10" name="__codelineno-148-10"></a>    <span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span>
<a id="__codelineno-148-11" name="__codelineno-148-11"></a>    <span class="k">for</span> <span class="n">product</span> <span class="ow">in</span> <span class="n">products</span><span class="p">:</span>
<a id="__codelineno-148-12" name="__codelineno-148-12"></a>        <span class="k">assert</span> <span class="n">product</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<h4 id="c-testing-a-model-method">c. Testing a Model Method</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-149-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-149-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-149-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-149-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-149-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-149-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-149-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-149-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-149-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-149-10">10</a></span>
<span class="normal"><a href="#__codelineno-149-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-149-1" name="__codelineno-149-1"></a><span class="c1"># myapp/tests/test_models.py</span>
<a id="__codelineno-149-2" name="__codelineno-149-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<a id="__codelineno-149-3" name="__codelineno-149-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">myapp.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Product</span>
<a id="__codelineno-149-4" name="__codelineno-149-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.factories</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProductFactory</span>
<a id="__codelineno-149-5" name="__codelineno-149-5"></a>
<a id="__codelineno-149-6" name="__codelineno-149-6"></a><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">django_db</span>
<a id="__codelineno-149-7" name="__codelineno-149-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_product_is_expensive</span><span class="p">():</span>
<a id="__codelineno-149-8" name="__codelineno-149-8"></a>    <span class="n">cheap_product</span> <span class="o">=</span> <span class="n">ProductFactory</span><span class="p">(</span><span class="n">price</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-149-9" name="__codelineno-149-9"></a>    <span class="n">expensive_product</span> <span class="o">=</span> <span class="n">ProductFactory</span><span class="p">(</span><span class="n">price</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<a id="__codelineno-149-10" name="__codelineno-149-10"></a>    <span class="k">assert</span> <span class="ow">not</span> <span class="n">cheap_product</span><span class="o">.</span><span class="n">is_expensive</span><span class="p">()</span>
<a id="__codelineno-149-11" name="__codelineno-149-11"></a>    <span class="k">assert</span> <span class="n">expensive_product</span><span class="o">.</span><span class="n">is_expensive</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<h3 id="7-best-practices_1">7. Best Practices</h3>
<ul>
<li><strong>Isolate Tests:</strong> Ensure tests are independent and can run in any order.</li>
<li><strong>Use Fixtures Effectively:</strong> Leverage <code>pytest</code> fixtures for reusable test setups.</li>
<li><strong>Mock External Services:</strong> Isolate tests from external dependencies to ensure reliability.</li>
<li><strong>Maintain High Coverage:</strong> Aim for comprehensive test coverage to catch potential issues early.</li>
<li><strong>Automate Testing:</strong> Integrate tests into CI/CD pipelines for continuous validation.</li>
</ul>
<p><strong>Conclusion:</strong><br />
Implementing a comprehensive testing strategy in Django involves writing unit, integration, and E2E tests, enhanced by tools like <code>pytest</code> and <code>factory_boy</code>. Adhering to best practices ensures robust, maintainable, and reliable applications.</p>
<hr />
<h1 id="10-deployment-and-scalability-of-django-applications">10. Deployment and Scalability of Django Applications</h1>
<p><strong>Question:</strong><br />
What are the key considerations for deploying a Django application in a production environment? Discuss the roles of WSGI/ASGI servers, application servers (e.g., Gunicorn, Daphne), reverse proxies (e.g., Nginx), and database configurations. Additionally, explain strategies to scale a Django application to handle increased traffic.</p>
<p><strong>Answer:</strong></p>
<p>Deploying a Django application to production involves configuring servers, proxies, databases, and implementing scalability strategies to ensure performance, security, and reliability.</p>
<h3 id="1-key-components-in-deployment">1. Key Components in Deployment</h3>
<ul>
<li><strong>WSGI/ASGI Servers:</strong> Interface between Django and the web server.</li>
<li><strong>WSGI:</strong> Synchronous interface (e.g., Gunicorn).</li>
<li>
<p><strong>ASGI:</strong> Asynchronous interface (e.g., Daphne, Uvicorn).</p>
</li>
<li>
<p><strong>Application Servers:</strong> Manage worker processes handling incoming requests.</p>
</li>
<li><strong>Gunicorn:</strong> Popular WSGI server.</li>
<li>
<p><strong>Daphne:</strong> ASGI server for asynchronous support.</p>
</li>
<li>
<p><strong>Reverse Proxies:</strong> Handle client requests, load balancing, SSL termination, and serve static files.</p>
</li>
<li><strong>Nginx:</strong> Common choice for reverse proxying.</li>
<li>
<p><strong>Apache:</strong> Another option with mod_wsgi.</p>
</li>
<li>
<p><strong>Database Configurations:</strong> Optimize performance, ensure high availability, and manage connections.</p>
</li>
<li><strong>PostgreSQL:</strong> Preferred for production.</li>
<li><strong>Connection Pooling:</strong> Use PgBouncer for efficient database connections.</li>
</ul>
<h3 id="2-deployment-steps-and-considerations">2. Deployment Steps and Considerations</h3>
<h4 id="a-setting-up-the-web-server-and-application-server">a. Setting Up the Web Server and Application Server</h4>
<p><strong>Example Using Gunicorn and Nginx:</strong></p>
<ol>
<li>
<p><strong>Install Gunicorn:</strong>
   <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-150-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-150-1" name="__codelineno-150-1"></a>pip<span class="w"> </span>install<span class="w"> </span>gunicorn
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Run Gunicorn:</strong>
   <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-151-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-151-1" name="__codelineno-151-1"></a>gunicorn<span class="w"> </span>myproject.wsgi:application<span class="w"> </span>--bind<span class="w"> </span><span class="m">127</span>.0.0.1:8000
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Install and Configure Nginx:</strong></p>
</li>
</ol>
<p><strong>Example Nginx Configuration:</strong>
   <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-152-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-152-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-152-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-152-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-152-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-152-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-152-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-152-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-152-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-152-10">10</a></span>
<span class="normal"><a href="#__codelineno-152-11">11</a></span>
<span class="normal"><a href="#__codelineno-152-12">12</a></span>
<span class="normal"><a href="#__codelineno-152-13">13</a></span>
<span class="normal"><a href="#__codelineno-152-14">14</a></span>
<span class="normal"><a href="#__codelineno-152-15">15</a></span>
<span class="normal"><a href="#__codelineno-152-16">16</a></span>
<span class="normal"><a href="#__codelineno-152-17">17</a></span>
<span class="normal"><a href="#__codelineno-152-18">18</a></span>
<span class="normal"><a href="#__codelineno-152-19">19</a></span>
<span class="normal"><a href="#__codelineno-152-20">20</a></span>
<span class="normal"><a href="#__codelineno-152-21">21</a></span>
<span class="normal"><a href="#__codelineno-152-22">22</a></span>
<span class="normal"><a href="#__codelineno-152-23">23</a></span>
<span class="normal"><a href="#__codelineno-152-24">24</a></span>
<span class="normal"><a href="#__codelineno-152-25">25</a></span>
<span class="normal"><a href="#__codelineno-152-26">26</a></span>
<span class="normal"><a href="#__codelineno-152-27">27</a></span>
<span class="normal"><a href="#__codelineno-152-28">28</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-152-1" name="__codelineno-152-1"></a><span class="c1"># /etc/nginx/sites-available/myproject</span>
<a id="__codelineno-152-2" name="__codelineno-152-2"></a><span class="k">server</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-152-3" name="__codelineno-152-3"></a><span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">80</span><span class="p">;</span>
<a id="__codelineno-152-4" name="__codelineno-152-4"></a><span class="w">    </span><span class="kn">server_name</span><span class="w"> </span><span class="s">example.com</span><span class="w"> </span><span class="s">www.example.com</span><span class="p">;</span>
<a id="__codelineno-152-5" name="__codelineno-152-5"></a>
<a id="__codelineno-152-6" name="__codelineno-152-6"></a><span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">/favicon.ico</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kn">access_log</span><span class="w"> </span><span class="no">off</span><span class="p">;</span><span class="w"> </span><span class="kn">log_not_found</span><span class="w"> </span><span class="no">off</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-152-7" name="__codelineno-152-7"></a><span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/static/</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-152-8" name="__codelineno-152-8"></a><span class="w">        </span><span class="kn">root</span><span class="w"> </span><span class="s">/path/to/myproject</span><span class="p">;</span>
<a id="__codelineno-152-9" name="__codelineno-152-9"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-152-10" name="__codelineno-152-10"></a>
<a id="__codelineno-152-11" name="__codelineno-152-11"></a><span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/media/</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-152-12" name="__codelineno-152-12"></a><span class="w">        </span><span class="kn">root</span><span class="w"> </span><span class="s">/path/to/myproject</span><span class="p">;</span>
<a id="__codelineno-152-13" name="__codelineno-152-13"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-152-14" name="__codelineno-152-14"></a>
<a id="__codelineno-152-15" name="__codelineno-152-15"></a><span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-152-16" name="__codelineno-152-16"></a><span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Host</span><span class="w"> </span><span class="nv">$host</span><span class="p">;</span>
<a id="__codelineno-152-17" name="__codelineno-152-17"></a><span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Real-IP</span><span class="w"> </span><span class="nv">$remote_addr</span><span class="p">;</span>
<a id="__codelineno-152-18" name="__codelineno-152-18"></a><span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-For</span><span class="w"> </span><span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
<a id="__codelineno-152-19" name="__codelineno-152-19"></a><span class="w">        </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://127.0.0.1:8000</span><span class="p">;</span>
<a id="__codelineno-152-20" name="__codelineno-152-20"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-152-21" name="__codelineno-152-21"></a>
<a id="__codelineno-152-22" name="__codelineno-152-22"></a><span class="w">    </span><span class="c1"># Optional: Redirect HTTP to HTTPS</span>
<a id="__codelineno-152-23" name="__codelineno-152-23"></a><span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="s">ssl</span><span class="p">;</span><span class="w"> </span><span class="c1"># managed by Certbot</span>
<a id="__codelineno-152-24" name="__codelineno-152-24"></a><span class="w">    </span><span class="kn">ssl_certificate</span><span class="w"> </span><span class="s">/etc/letsencrypt/live/example.com/fullchain.pem</span><span class="p">;</span>
<a id="__codelineno-152-25" name="__codelineno-152-25"></a><span class="w">    </span><span class="kn">ssl_certificate_key</span><span class="w"> </span><span class="s">/etc/letsencrypt/live/example.com/privkey.pem</span><span class="p">;</span>
<a id="__codelineno-152-26" name="__codelineno-152-26"></a><span class="w">    </span><span class="kn">include</span><span class="w"> </span><span class="s">/etc/letsencrypt/options-ssl-nginx.conf</span><span class="p">;</span>
<a id="__codelineno-152-27" name="__codelineno-152-27"></a><span class="w">    </span><span class="kn">ssl_dhparam</span><span class="w"> </span><span class="s">/etc/letsencrypt/ssl-dhparams.pem</span><span class="p">;</span>
<a id="__codelineno-152-28" name="__codelineno-152-28"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<ol>
<li><strong>Enable the Nginx Site and Restart Nginx:</strong>
   <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-153-1">1</a></span>
<span class="normal"><a href="#__codelineno-153-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-153-1" name="__codelineno-153-1"></a>sudo<span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span>/etc/nginx/sites-available/myproject<span class="w"> </span>/etc/nginx/sites-enabled
<a id="__codelineno-153-2" name="__codelineno-153-2"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>nginx
</code></pre></div></td></tr></table></div></li>
</ol>
<h4 id="b-serving-static-and-media-files">b. Serving Static and Media Files</h4>
<ul>
<li><strong>Static Files:</strong></li>
<li>Use <code>collectstatic</code> to gather all static files into a single directory.
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-154-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-154-1" name="__codelineno-154-1"></a>python<span class="w"> </span>manage.py<span class="w"> </span>collectstatic
</code></pre></div></td></tr></table></div></li>
<li>
<p>Serve static files via Nginx or a CDN for better performance.</p>
</li>
<li>
<p><strong>Media Files:</strong></p>
</li>
<li>Configure Nginx to serve user-uploaded media files securely.
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-155-1">1</a></span>
<span class="normal"><a href="#__codelineno-155-2">2</a></span>
<span class="normal"><a href="#__codelineno-155-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-155-1" name="__codelineno-155-1"></a><span class="k">location</span><span class="w"> </span><span class="s">/media/</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-155-2" name="__codelineno-155-2"></a><span class="w">    </span><span class="kn">root</span><span class="w"> </span><span class="s">/path/to/myproject</span><span class="p">;</span>
<a id="__codelineno-155-3" name="__codelineno-155-3"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div></li>
</ul>
<h4 id="c-database-configuration">c. Database Configuration</h4>
<ul>
<li><strong>Use a Production-Ready Database:</strong></li>
<li><strong>PostgreSQL:</strong> Robust features and performance.</li>
<li>
<p><strong>Configure Connection Pooling:</strong></p>
<ul>
<li><strong>PgBouncer:</strong> Lightweight connection pooler.
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-156-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-156-1" name="__codelineno-156-1"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>pgbouncer
</code></pre></div></td></tr></table></div>
  <strong>PgBouncer Configuration:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-157-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-157-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-157-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-157-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-157-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-157-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-157-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-157-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-157-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-157-10">10</a></span>
<span class="normal"><a href="#__codelineno-157-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-157-1" name="__codelineno-157-1"></a><span class="k">[databases]</span>
<a id="__codelineno-157-2" name="__codelineno-157-2"></a><span class="na">myproject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">host=127.0.0.1 port=5432 dbname=myproject</span>
<a id="__codelineno-157-3" name="__codelineno-157-3"></a>
<a id="__codelineno-157-4" name="__codelineno-157-4"></a><span class="k">[pgbouncer]</span>
<a id="__codelineno-157-5" name="__codelineno-157-5"></a><span class="na">listen_addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">127.0.0.1</span>
<a id="__codelineno-157-6" name="__codelineno-157-6"></a><span class="na">listen_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">6432</span>
<a id="__codelineno-157-7" name="__codelineno-157-7"></a><span class="na">auth_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">md5</span>
<a id="__codelineno-157-8" name="__codelineno-157-8"></a><span class="na">auth_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/etc/pgbouncer/userlist.txt</span>
<a id="__codelineno-157-9" name="__codelineno-157-9"></a><span class="na">pool_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">transaction</span>
<a id="__codelineno-157-10" name="__codelineno-157-10"></a><span class="na">max_client_conn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">100</span>
<a id="__codelineno-157-11" name="__codelineno-157-11"></a><span class="na">default_pool_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">20</span>
</code></pre></div></td></tr></table></div>
  <strong>Run PgBouncer:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-158-1">1</a></span>
<span class="normal"><a href="#__codelineno-158-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-158-1" name="__codelineno-158-1"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>pgbouncer
<a id="__codelineno-158-2" name="__codelineno-158-2"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>pgbouncer
</code></pre></div></td></tr></table></div></li>
</ul>
</li>
<li>
<p><strong>Optimize Database Settings:</strong></p>
</li>
<li>Adjust PostgreSQL settings like <code>MAX_CONNECTIONS</code>, <code>WORK_MEM</code>, and <code>MAINTENANCE_WORK_MEM</code> based on workload.</li>
</ul>
<h4 id="d-security-settings">d. Security Settings</h4>
<ul>
<li>
<p><strong>Set <code>DEBUG = False</code>:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-159-1">1</a></span>
<span class="normal"><a href="#__codelineno-159-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-159-1" name="__codelineno-159-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-159-2" name="__codelineno-159-2"></a><span class="n">DEBUG</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Configure Allowed Hosts:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-160-1">1</a></span>
<span class="normal"><a href="#__codelineno-160-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-160-1" name="__codelineno-160-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-160-2" name="__codelineno-160-2"></a><span class="n">ALLOWED_HOSTS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;example.com&#39;</span><span class="p">,</span> <span class="s1">&#39;www.example.com&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Enforce HTTPS:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-161-1">1</a></span>
<span class="normal"><a href="#__codelineno-161-2">2</a></span>
<span class="normal"><a href="#__codelineno-161-3">3</a></span>
<span class="normal"><a href="#__codelineno-161-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-161-1" name="__codelineno-161-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-161-2" name="__codelineno-161-2"></a><span class="n">SECURE_SSL_REDIRECT</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-161-3" name="__codelineno-161-3"></a><span class="n">SESSION_COOKIE_SECURE</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-161-4" name="__codelineno-161-4"></a><span class="n">CSRF_COOKIE_SECURE</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Secure Secrets:</strong></p>
</li>
<li>Use environment variables to store sensitive settings like <code>SECRET_KEY</code>.
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-162-1">1</a></span>
<span class="normal"><a href="#__codelineno-162-2">2</a></span>
<span class="normal"><a href="#__codelineno-162-3">3</a></span>
<span class="normal"><a href="#__codelineno-162-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-162-1" name="__codelineno-162-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-162-2" name="__codelineno-162-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-162-3" name="__codelineno-162-3"></a>
<a id="__codelineno-162-4" name="__codelineno-162-4"></a><span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DJANGO_SECRET_KEY&#39;</span><span class="p">,</span> <span class="s1">&#39;unsafe-default-key&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></li>
</ul>
<h3 id="3-scaling-strategies">3. Scaling Strategies</h3>
<h4 id="a-horizontal-scaling">a. Horizontal Scaling</h4>
<ul>
<li><strong>Add More Application Server Instances:</strong></li>
<li>
<p>Increase Gunicorn workers or deploy multiple Gunicorn instances across different servers.</p>
</li>
<li>
<p><strong>Load Balancing:</strong></p>
</li>
<li>Use Nginx’s load balancing features or dedicated load balancers to distribute traffic evenly.</li>
</ul>
<p><strong>Example Nginx Load Balancing Configuration:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-163-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-163-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-163-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-163-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-163-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-163-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-163-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-163-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-163-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-163-10">10</a></span>
<span class="normal"><a href="#__codelineno-163-11">11</a></span>
<span class="normal"><a href="#__codelineno-163-12">12</a></span>
<span class="normal"><a href="#__codelineno-163-13">13</a></span>
<span class="normal"><a href="#__codelineno-163-14">14</a></span>
<span class="normal"><a href="#__codelineno-163-15">15</a></span>
<span class="normal"><a href="#__codelineno-163-16">16</a></span>
<span class="normal"><a href="#__codelineno-163-17">17</a></span>
<span class="normal"><a href="#__codelineno-163-18">18</a></span>
<span class="normal"><a href="#__codelineno-163-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-163-1" name="__codelineno-163-1"></a><span class="k">http</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-163-2" name="__codelineno-163-2"></a><span class="w">    </span><span class="kn">upstream</span><span class="w"> </span><span class="s">django_app</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-163-3" name="__codelineno-163-3"></a><span class="w">        </span><span class="kn">server</span><span class="w"> </span><span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8000</span><span class="p">;</span>
<a id="__codelineno-163-4" name="__codelineno-163-4"></a><span class="w">        </span><span class="kn">server</span><span class="w"> </span><span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8001</span><span class="p">;</span>
<a id="__codelineno-163-5" name="__codelineno-163-5"></a><span class="w">        </span><span class="kn">server</span><span class="w"> </span><span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8002</span><span class="p">;</span>
<a id="__codelineno-163-6" name="__codelineno-163-6"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-163-7" name="__codelineno-163-7"></a>
<a id="__codelineno-163-8" name="__codelineno-163-8"></a><span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-163-9" name="__codelineno-163-9"></a><span class="w">        </span><span class="kn">listen</span><span class="w"> </span><span class="mi">80</span><span class="p">;</span>
<a id="__codelineno-163-10" name="__codelineno-163-10"></a><span class="w">        </span><span class="kn">server_name</span><span class="w"> </span><span class="s">example.com</span><span class="p">;</span>
<a id="__codelineno-163-11" name="__codelineno-163-11"></a>
<a id="__codelineno-163-12" name="__codelineno-163-12"></a><span class="w">        </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-163-13" name="__codelineno-163-13"></a><span class="w">            </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://django_app</span><span class="p">;</span>
<a id="__codelineno-163-14" name="__codelineno-163-14"></a><span class="w">            </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Host</span><span class="w"> </span><span class="nv">$host</span><span class="p">;</span>
<a id="__codelineno-163-15" name="__codelineno-163-15"></a><span class="w">            </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Real-IP</span><span class="w"> </span><span class="nv">$remote_addr</span><span class="p">;</span>
<a id="__codelineno-163-16" name="__codelineno-163-16"></a><span class="w">            </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-For</span><span class="w"> </span><span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
<a id="__codelineno-163-17" name="__codelineno-163-17"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-163-18" name="__codelineno-163-18"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-163-19" name="__codelineno-163-19"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="b-vertical-scaling">b. Vertical Scaling</h4>
<ul>
<li><strong>Upgrade Server Resources:</strong></li>
<li>Increase CPU, memory, and storage on existing servers to handle more load.</li>
</ul>
<h4 id="c-caching">c. Caching</h4>
<ul>
<li><strong>Implement Caching Layers:</strong></li>
<li>
<p>Use Redis or Memcached for caching database queries, session data, and other frequently accessed data.</p>
</li>
<li>
<p><strong>Use a Content Delivery Network (CDN):</strong></p>
</li>
<li>Offload serving static and media files to a CDN to reduce server load and improve content delivery speed.</li>
</ul>
<h4 id="d-database-scaling">d. Database Scaling</h4>
<ul>
<li><strong>Read Replicas:</strong></li>
<li>Distribute read operations across multiple database replicas to balance the load.</li>
</ul>
<p><strong>Example PostgreSQL Read Replica Setup:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-164-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-164-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-164-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-164-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-164-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-164-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-164-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-164-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-164-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-164-10">10</a></span>
<span class="normal"><a href="#__codelineno-164-11">11</a></span>
<span class="normal"><a href="#__codelineno-164-12">12</a></span>
<span class="normal"><a href="#__codelineno-164-13">13</a></span>
<span class="normal"><a href="#__codelineno-164-14">14</a></span>
<span class="normal"><a href="#__codelineno-164-15">15</a></span>
<span class="normal"><a href="#__codelineno-164-16">16</a></span>
<span class="normal"><a href="#__codelineno-164-17">17</a></span>
<span class="normal"><a href="#__codelineno-164-18">18</a></span>
<span class="normal"><a href="#__codelineno-164-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-164-1" name="__codelineno-164-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-164-2" name="__codelineno-164-2"></a><span class="na">DATABASES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{</span>
<a id="__codelineno-164-3" name="__codelineno-164-3"></a><span class="w">    </span><span class="na">&#39;default&#39;</span><span class="o">:</span><span class="w"> </span><span class="s">{</span>
<a id="__codelineno-164-4" name="__codelineno-164-4"></a><span class="w">        </span><span class="na">&#39;ENGINE&#39;</span><span class="o">:</span><span class="w"> </span><span class="s">&#39;django.db.backends.postgresql&#39;</span><span class="na">,</span>
<a id="__codelineno-164-5" name="__codelineno-164-5"></a><span class="w">        </span><span class="na">&#39;NAME&#39;</span><span class="o">:</span><span class="w"> </span><span class="s">&#39;myproject&#39;</span><span class="na">,</span>
<a id="__codelineno-164-6" name="__codelineno-164-6"></a><span class="w">        </span><span class="na">&#39;USER&#39;</span><span class="o">:</span><span class="w"> </span><span class="s">&#39;myuser&#39;</span><span class="na">,</span>
<a id="__codelineno-164-7" name="__codelineno-164-7"></a><span class="w">        </span><span class="na">&#39;PASSWORD&#39;</span><span class="o">:</span><span class="w"> </span><span class="s">&#39;mypassword&#39;</span><span class="na">,</span>
<a id="__codelineno-164-8" name="__codelineno-164-8"></a><span class="w">        </span><span class="na">&#39;HOST&#39;</span><span class="o">:</span><span class="w"> </span><span class="s">&#39;primary-db-host&#39;</span><span class="na">,</span>
<a id="__codelineno-164-9" name="__codelineno-164-9"></a><span class="w">        </span><span class="na">&#39;PORT&#39;</span><span class="o">:</span><span class="w"> </span><span class="s">&#39;5432&#39;</span><span class="na">,</span>
<a id="__codelineno-164-10" name="__codelineno-164-10"></a><span class="w">    </span><span class="na">},</span>
<a id="__codelineno-164-11" name="__codelineno-164-11"></a><span class="w">    </span><span class="na">&#39;replica&#39;</span><span class="o">:</span><span class="w"> </span><span class="s">{</span>
<a id="__codelineno-164-12" name="__codelineno-164-12"></a><span class="w">        </span><span class="na">&#39;ENGINE&#39;</span><span class="o">:</span><span class="w"> </span><span class="s">&#39;django.db.backends.postgresql&#39;</span><span class="na">,</span>
<a id="__codelineno-164-13" name="__codelineno-164-13"></a><span class="w">        </span><span class="na">&#39;NAME&#39;</span><span class="o">:</span><span class="w"> </span><span class="s">&#39;myproject&#39;</span><span class="na">,</span>
<a id="__codelineno-164-14" name="__codelineno-164-14"></a><span class="w">        </span><span class="na">&#39;USER&#39;</span><span class="o">:</span><span class="w"> </span><span class="s">&#39;myuser&#39;</span><span class="na">,</span>
<a id="__codelineno-164-15" name="__codelineno-164-15"></a><span class="w">        </span><span class="na">&#39;PASSWORD&#39;</span><span class="o">:</span><span class="w"> </span><span class="s">&#39;mypassword&#39;</span><span class="na">,</span>
<a id="__codelineno-164-16" name="__codelineno-164-16"></a><span class="w">        </span><span class="na">&#39;HOST&#39;</span><span class="o">:</span><span class="w"> </span><span class="s">&#39;replica-db-host&#39;</span><span class="na">,</span>
<a id="__codelineno-164-17" name="__codelineno-164-17"></a><span class="w">        </span><span class="na">&#39;PORT&#39;</span><span class="o">:</span><span class="w"> </span><span class="s">&#39;5432&#39;</span><span class="na">,</span>
<a id="__codelineno-164-18" name="__codelineno-164-18"></a><span class="w">    </span><span class="na">}</span>
<a id="__codelineno-164-19" name="__codelineno-164-19"></a><span class="na">}</span>
</code></pre></div></td></tr></table></div></p>
<ul>
<li><strong>Sharding:</strong></li>
<li>Partition the database to distribute data across multiple servers.</li>
</ul>
<h4 id="e-asynchronous-task-processing">e. Asynchronous Task Processing</h4>
<ul>
<li><strong>Use Celery:</strong></li>
<li>Offload long-running tasks to Celery workers to prevent blocking the main application.</li>
</ul>
<p><strong>Celery Configuration:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-165-1">1</a></span>
<span class="normal"><a href="#__codelineno-165-2">2</a></span>
<span class="normal"><a href="#__codelineno-165-3">3</a></span>
<span class="normal"><a href="#__codelineno-165-4">4</a></span>
<span class="normal"><a href="#__codelineno-165-5">5</a></span>
<span class="normal"><a href="#__codelineno-165-6">6</a></span>
<span class="normal"><a href="#__codelineno-165-7">7</a></span>
<span class="normal"><a href="#__codelineno-165-8">8</a></span>
<span class="normal"><a href="#__codelineno-165-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-165-1" name="__codelineno-165-1"></a><span class="c1"># myproject/celery.py</span>
<a id="__codelineno-165-2" name="__codelineno-165-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-165-3" name="__codelineno-165-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">Celery</span>
<a id="__codelineno-165-4" name="__codelineno-165-4"></a>
<a id="__codelineno-165-5" name="__codelineno-165-5"></a><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;DJANGO_SETTINGS_MODULE&#39;</span><span class="p">,</span> <span class="s1">&#39;myproject.settings&#39;</span><span class="p">)</span>
<a id="__codelineno-165-6" name="__codelineno-165-6"></a>
<a id="__codelineno-165-7" name="__codelineno-165-7"></a><span class="n">app</span> <span class="o">=</span> <span class="n">Celery</span><span class="p">(</span><span class="s1">&#39;myproject&#39;</span><span class="p">)</span>
<a id="__codelineno-165-8" name="__codelineno-165-8"></a><span class="n">app</span><span class="o">.</span><span class="n">config_from_object</span><span class="p">(</span><span class="s1">&#39;django.conf:settings&#39;</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="s1">&#39;CELERY&#39;</span><span class="p">)</span>
<a id="__codelineno-165-9" name="__codelineno-165-9"></a><span class="n">app</span><span class="o">.</span><span class="n">autodiscover_tasks</span><span class="p">()</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Define a Task:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-166-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-166-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-166-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-166-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-166-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-166-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-166-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-166-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-166-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-166-10">10</a></span>
<span class="normal"><a href="#__codelineno-166-11">11</a></span>
<span class="normal"><a href="#__codelineno-166-12">12</a></span>
<span class="normal"><a href="#__codelineno-166-13">13</a></span>
<span class="normal"><a href="#__codelineno-166-14">14</a></span>
<span class="normal"><a href="#__codelineno-166-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-166-1" name="__codelineno-166-1"></a><span class="c1"># myapp/tasks.py</span>
<a id="__codelineno-166-2" name="__codelineno-166-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">shared_task</span>
<a id="__codelineno-166-3" name="__codelineno-166-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.core.mail</span><span class="w"> </span><span class="kn">import</span> <span class="n">send_mail</span>
<a id="__codelineno-166-4" name="__codelineno-166-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.conf</span><span class="w"> </span><span class="kn">import</span> <span class="n">settings</span>
<a id="__codelineno-166-5" name="__codelineno-166-5"></a>
<a id="__codelineno-166-6" name="__codelineno-166-6"></a><span class="nd">@shared_task</span>
<a id="__codelineno-166-7" name="__codelineno-166-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">send_welcome_email</span><span class="p">(</span><span class="n">user_id</span><span class="p">):</span>
<a id="__codelineno-166-8" name="__codelineno-166-8"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">User</span>
<a id="__codelineno-166-9" name="__codelineno-166-9"></a>    <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">user_id</span><span class="p">)</span>
<a id="__codelineno-166-10" name="__codelineno-166-10"></a>    <span class="n">send_mail</span><span class="p">(</span>
<a id="__codelineno-166-11" name="__codelineno-166-11"></a>        <span class="s1">&#39;Welcome!&#39;</span><span class="p">,</span>
<a id="__codelineno-166-12" name="__codelineno-166-12"></a>        <span class="sa">f</span><span class="s1">&#39;Hi </span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="si">}</span><span class="s1">, thank you for registering.&#39;</span><span class="p">,</span>
<a id="__codelineno-166-13" name="__codelineno-166-13"></a>        <span class="n">settings</span><span class="o">.</span><span class="n">DEFAULT_FROM_EMAIL</span><span class="p">,</span>
<a id="__codelineno-166-14" name="__codelineno-166-14"></a>        <span class="p">[</span><span class="n">user</span><span class="o">.</span><span class="n">email</span><span class="p">],</span>
<a id="__codelineno-166-15" name="__codelineno-166-15"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Triggering the Task:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-167-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-167-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-167-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-167-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-167-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-167-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-167-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-167-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-167-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-167-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-167-1" name="__codelineno-167-1"></a><span class="c1"># myapp/signals.py</span>
<a id="__codelineno-167-2" name="__codelineno-167-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.db.models.signals</span><span class="w"> </span><span class="kn">import</span> <span class="n">post_save</span>
<a id="__codelineno-167-3" name="__codelineno-167-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.dispatch</span><span class="w"> </span><span class="kn">import</span> <span class="n">receiver</span>
<a id="__codelineno-167-4" name="__codelineno-167-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">User</span>
<a id="__codelineno-167-5" name="__codelineno-167-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">send_welcome_email</span>
<a id="__codelineno-167-6" name="__codelineno-167-6"></a>
<a id="__codelineno-167-7" name="__codelineno-167-7"></a><span class="nd">@receiver</span><span class="p">(</span><span class="n">post_save</span><span class="p">,</span> <span class="n">sender</span><span class="o">=</span><span class="n">User</span><span class="p">)</span>
<a id="__codelineno-167-8" name="__codelineno-167-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">send_welcome_email_signal</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">created</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-167-9" name="__codelineno-167-9"></a>    <span class="k">if</span> <span class="n">created</span><span class="p">:</span>
<a id="__codelineno-167-10" name="__codelineno-167-10"></a>        <span class="n">send_welcome_email</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="f-monitoring-and-logging">f. Monitoring and Logging</h4>
<ul>
<li><strong>Implement Monitoring Tools:</strong></li>
<li>
<p>Use tools like Prometheus, Grafana, New Relic, or Datadog to monitor application performance and server health.</p>
</li>
<li>
<p><strong>Centralized Logging:</strong></p>
</li>
<li>Aggregate logs using tools like ELK Stack (Elasticsearch, Logstash, Kibana) or Graylog for easier analysis and troubleshooting.</li>
</ul>
<h4 id="g-containerization-and-orchestration">g. Containerization and Orchestration</h4>
<ul>
<li><strong>Use Docker:</strong></li>
<li>Containerize the Django application for consistent deployments across environments.</li>
</ul>
<p><strong>Example Dockerfile:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-168-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-168-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-168-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-168-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-168-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-168-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-168-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-168-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-168-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-168-10">10</a></span>
<span class="normal"><a href="#__codelineno-168-11">11</a></span>
<span class="normal"><a href="#__codelineno-168-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-168-1" name="__codelineno-168-1"></a><span class="k">FROM</span><span class="w"> </span><span class="s">python:3.9-slim</span>
<a id="__codelineno-168-2" name="__codelineno-168-2"></a>
<a id="__codelineno-168-3" name="__codelineno-168-3"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">PYTHONUNBUFFERED</span><span class="o">=</span><span class="m">1</span>
<a id="__codelineno-168-4" name="__codelineno-168-4"></a>
<a id="__codelineno-168-5" name="__codelineno-168-5"></a><span class="k">WORKDIR</span><span class="w"> </span><span class="s">/code</span>
<a id="__codelineno-168-6" name="__codelineno-168-6"></a>
<a id="__codelineno-168-7" name="__codelineno-168-7"></a><span class="k">COPY</span><span class="w"> </span>requirements.txt<span class="w"> </span>/code/
<a id="__codelineno-168-8" name="__codelineno-168-8"></a><span class="k">RUN</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>pip<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
<a id="__codelineno-168-9" name="__codelineno-168-9"></a>
<a id="__codelineno-168-10" name="__codelineno-168-10"></a><span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>/code/
<a id="__codelineno-168-11" name="__codelineno-168-11"></a>
<a id="__codelineno-168-12" name="__codelineno-168-12"></a><span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;gunicorn&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;myproject.wsgi:application&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--bind&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;0.0.0.0:8000&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div></p>
<ul>
<li><strong>Orchestrate with Kubernetes:</strong></li>
<li>Manage containerized applications at scale, handling deployment, scaling, and management.</li>
</ul>
<p><strong>Example Kubernetes Deployment:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-169-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-169-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-169-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-169-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-169-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-169-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-169-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-169-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-169-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-169-10">10</a></span>
<span class="normal"><a href="#__codelineno-169-11">11</a></span>
<span class="normal"><a href="#__codelineno-169-12">12</a></span>
<span class="normal"><a href="#__codelineno-169-13">13</a></span>
<span class="normal"><a href="#__codelineno-169-14">14</a></span>
<span class="normal"><a href="#__codelineno-169-15">15</a></span>
<span class="normal"><a href="#__codelineno-169-16">16</a></span>
<span class="normal"><a href="#__codelineno-169-17">17</a></span>
<span class="normal"><a href="#__codelineno-169-18">18</a></span>
<span class="normal"><a href="#__codelineno-169-19">19</a></span>
<span class="normal"><a href="#__codelineno-169-20">20</a></span>
<span class="normal"><a href="#__codelineno-169-21">21</a></span>
<span class="normal"><a href="#__codelineno-169-22">22</a></span>
<span class="normal"><a href="#__codelineno-169-23">23</a></span>
<span class="normal"><a href="#__codelineno-169-24">24</a></span>
<span class="normal"><a href="#__codelineno-169-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-169-1" name="__codelineno-169-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<a id="__codelineno-169-2" name="__codelineno-169-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<a id="__codelineno-169-3" name="__codelineno-169-3"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-169-4" name="__codelineno-169-4"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">django-deployment</span>
<a id="__codelineno-169-5" name="__codelineno-169-5"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-169-6" name="__codelineno-169-6"></a><span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<a id="__codelineno-169-7" name="__codelineno-169-7"></a><span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<a id="__codelineno-169-8" name="__codelineno-169-8"></a><span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<a id="__codelineno-169-9" name="__codelineno-169-9"></a><span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">django</span>
<a id="__codelineno-169-10" name="__codelineno-169-10"></a><span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<a id="__codelineno-169-11" name="__codelineno-169-11"></a><span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-169-12" name="__codelineno-169-12"></a><span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-169-13" name="__codelineno-169-13"></a><span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">django</span>
<a id="__codelineno-169-14" name="__codelineno-169-14"></a><span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-169-15" name="__codelineno-169-15"></a><span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<a id="__codelineno-169-16" name="__codelineno-169-16"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">django</span>
<a id="__codelineno-169-17" name="__codelineno-169-17"></a><span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mydockerhub/myproject:latest</span>
<a id="__codelineno-169-18" name="__codelineno-169-18"></a><span class="w">        </span><span class="nt">ports</span><span class="p">:</span>
<a id="__codelineno-169-19" name="__codelineno-169-19"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
<a id="__codelineno-169-20" name="__codelineno-169-20"></a><span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<a id="__codelineno-169-21" name="__codelineno-169-21"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SECRET_KEY</span>
<a id="__codelineno-169-22" name="__codelineno-169-22"></a><span class="w">          </span><span class="nt">valueFrom</span><span class="p">:</span>
<a id="__codelineno-169-23" name="__codelineno-169-23"></a><span class="w">            </span><span class="nt">secretKeyRef</span><span class="p">:</span>
<a id="__codelineno-169-24" name="__codelineno-169-24"></a><span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">django-secrets</span>
<a id="__codelineno-169-25" name="__codelineno-169-25"></a><span class="w">              </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secret_key</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="h-auto-scaling">h. Auto-Scaling</h4>
<ul>
<li><strong>Implement Auto-Scaling Policies:</strong></li>
<li>Use cloud provider features (e.g., AWS Auto Scaling Groups) to automatically adjust the number of server instances based on traffic.</li>
</ul>
<p><strong>Example AWS Auto Scaling Group Configuration:</strong>
- <strong>Launch Configuration:</strong> Define the instance type, AMI, and startup script.
- <strong>Scaling Policies:</strong> Set rules based on CPU usage or request latency.
- <strong>Monitoring:</strong> Integrate with CloudWatch for metrics.</p>
<h3 id="4-best-practices_1">4. Best Practices</h3>
<ul>
<li><strong>Use Environment Variables for Configuration:</strong> Avoid hardcoding sensitive information. Use packages like <code>django-environ</code> to manage environment variables.</li>
</ul>
<p><strong>Example:</strong>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-170-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-170-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-170-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-170-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-170-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-170-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-170-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-170-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-170-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-170-10">10</a></span>
<span class="normal"><a href="#__codelineno-170-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-170-1" name="__codelineno-170-1"></a><span class="c1"># settings.py</span>
<a id="__codelineno-170-2" name="__codelineno-170-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">environ</span>
<a id="__codelineno-170-3" name="__codelineno-170-3"></a>
<a id="__codelineno-170-4" name="__codelineno-170-4"></a><span class="n">env</span> <span class="o">=</span> <span class="n">environ</span><span class="o">.</span><span class="n">Env</span><span class="p">()</span>
<a id="__codelineno-170-5" name="__codelineno-170-5"></a><span class="n">environ</span><span class="o">.</span><span class="n">Env</span><span class="o">.</span><span class="n">read_env</span><span class="p">()</span>
<a id="__codelineno-170-6" name="__codelineno-170-6"></a>
<a id="__codelineno-170-7" name="__codelineno-170-7"></a><span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="n">env</span><span class="p">(</span><span class="s1">&#39;DJANGO_SECRET_KEY&#39;</span><span class="p">)</span>
<a id="__codelineno-170-8" name="__codelineno-170-8"></a><span class="n">DEBUG</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">bool</span><span class="p">(</span><span class="s1">&#39;DEBUG&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-170-9" name="__codelineno-170-9"></a><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-170-10" name="__codelineno-170-10"></a>    <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">env</span><span class="o">.</span><span class="n">db</span><span class="p">(),</span>
<a id="__codelineno-170-11" name="__codelineno-170-11"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<ul>
<li><strong>Implement Security Best Practices:</strong> Regularly audit security settings, apply patches, and follow Django’s security recommendations.</li>
<li><strong>Automate Deployments:</strong> Use CI/CD pipelines to automate testing and deployment, reducing human error and increasing deployment speed.</li>
<li><strong>Backup Strategies:</strong> Implement regular backups for databases and critical data, ensuring recoverability in case of failures.</li>
<li><strong>Documentation and Version Control:</strong> Maintain clear documentation and use version control systems (e.g., Git) to track changes and collaborate effectively.</li>
<li><strong>Zero-Downtime Deployments:</strong> Use techniques like blue-green deployments or rolling updates to deploy new versions without downtime.</li>
</ul>
<p><strong>Example Zero-Downtime Deployment with Gunicorn and Nginx:</strong></p>
<ol>
<li>
<p><strong>Start New Gunicorn Workers:</strong>
   <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-171-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-171-1" name="__codelineno-171-1"></a>gunicorn<span class="w"> </span>myproject.wsgi:application<span class="w"> </span>--bind<span class="w"> </span><span class="m">127</span>.0.0.1:8001<span class="w"> </span><span class="p">&amp;</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Update Nginx to Proxy to New Workers:</strong>
   <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-172-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-172-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-172-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-172-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-172-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-172-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-172-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-172-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-172-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-172-10">10</a></span>
<span class="normal"><a href="#__codelineno-172-11">11</a></span>
<span class="normal"><a href="#__codelineno-172-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-172-1" name="__codelineno-172-1"></a><span class="k">upstream</span><span class="w"> </span><span class="s">django_app</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-172-2" name="__codelineno-172-2"></a><span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8000</span><span class="p">;</span>
<a id="__codelineno-172-3" name="__codelineno-172-3"></a><span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8001</span><span class="p">;</span>
<a id="__codelineno-172-4" name="__codelineno-172-4"></a><span class="p">}</span>
<a id="__codelineno-172-5" name="__codelineno-172-5"></a>
<a id="__codelineno-172-6" name="__codelineno-172-6"></a><span class="k">server</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-172-7" name="__codelineno-172-7"></a><span class="w">    </span><span class="c1"># ... existing configuration ...</span>
<a id="__codelineno-172-8" name="__codelineno-172-8"></a><span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-172-9" name="__codelineno-172-9"></a><span class="w">        </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://django_app</span><span class="p">;</span>
<a id="__codelineno-172-10" name="__codelineno-172-10"></a><span class="w">        </span><span class="c1"># ... other proxy settings ...</span>
<a id="__codelineno-172-11" name="__codelineno-172-11"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-172-12" name="__codelineno-172-12"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Reload Nginx:</strong>
   <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-173-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-173-1" name="__codelineno-173-1"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>reload<span class="w"> </span>nginx
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Gracefully Stop Old Workers:</strong>
   <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-174-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-174-1" name="__codelineno-174-1"></a>pkill<span class="w"> </span>-f<span class="w"> </span><span class="s1">&#39;gunicorn.*8000&#39;</span>
</code></pre></div></td></tr></table></div></p>
</li>
</ol>
<p><strong>Conclusion:</strong><br />
Deploying Django applications in production involves configuring WSGI/ASGI servers, reverse proxies, secure settings, and implementing robust scaling strategies. By following best practices and utilizing advanced deployment techniques, developers can ensure their Django applications are performant, secure, and scalable to handle increased traffic effectively.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  </body>
</html>